(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[69],{"857a1":function(e,t,i){"use strict";i.r(t);i("b0c0"),i("a4d3"),i("e01a");var s=function(){var e=this,t=e._self._c;return t("q-page",{staticClass:"bg-grey-3"},[t("div",{staticClass:"q-pa-sm panel-header"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-8"},[t("div",{staticClass:"q-pa-md q-gutter-sm"},[t("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[t("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),t("q-breadcrumbs-el",{attrs:{label:e.repository.name}})],1)],1)]),t("div",{staticClass:"col-xs-6 col-md-4 pull-right"},[t("div",{staticClass:"q-pa-sm q-gutter-sm"},[t("q-btn",{attrs:{color:"primary",icon:"add",label:"Nuevo"},on:{click:function(t){e.modal=!0}}})],1)])])]),t("div",{staticClass:"q-pa-md bg-grey-3"},[t("div",{staticClass:"row bg-white border-panel"},[t("div",{staticClass:"col q-pa-md"},[t("q-table",{attrs:{flat:"",bordered:"",data:e.data,columns:e.columns,"row-key":"id",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(i){return[t("q-tr",{attrs:{props:i}},[t("q-td",{key:"description",staticStyle:{"text-align":"left",width:"35%"},attrs:{props:i}},[e._v(e._s(i.row.description))]),t("q-td",{key:"name",staticStyle:{"text-align":"left",width:"25%"},attrs:{props:i}},[e._v(e._s(i.row.name))]),t("q-td",{key:"date",staticStyle:{"text-align":"center",width:"10%"},attrs:{props:i}},[e._v(e._s(i.row.date))]),t("q-td",{key:"ext",staticStyle:{"text-align":"left",width:"5%"},attrs:{props:i}},[e._v(e._s(i.row.ext))]),t("q-td",{key:"size",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:i}},[e._v(e._s(i.row.size))]),t("q-td",{key:"actions",staticStyle:{width:"20%"},attrs:{props:i}},[t("q-btn",{attrs:{color:"green",icon:"fas fa-download",flat:"",size:"10px"},nativeOn:{click:function(t){return e.getFile(i.row)}}},[t("q-tooltip",{attrs:{"content-class":"bg-green"}},[e._v("Descargar")])],1),t("q-btn",{attrs:{color:"red",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(t){return e.deleteSelectedRow(i.row.id)}}},[t("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Eliminar")])],1)],1)],1)]}}])})],1)])]),t("q-dialog",{attrs:{persistent:""},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[t("q-card",{staticStyle:{"min-width":"50%"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Agregar Archivo")])]),t("q-card-section",[t("div",{staticClass:"row q-col-gutter-xs"},[t("div",{staticClass:"col-xs-12 col-sm-4 pull-right"},[t("q-file",{attrs:{error:e.$v.info.fields.file.$error,color:"dark","bg-color":"secondary",filled:"",rules:e.fileRules,label:"Archivo"},model:{value:e.info.fields.file,callback:function(t){e.$set(e.info.fields,"file",t)},expression:"info.fields.file"}})],1),t("div",{staticClass:"col-xs-12 col-sm-8"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.info.fields.description.$error,label:"Descripción",rules:e.descriptionRules},on:{input:function(t){e.info.fields.description=t.toUpperCase()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-signature"}})]},proxy:!0}]),model:{value:e.info.fields.description,callback:function(t){e.$set(e.info.fields,"description",t)},expression:"info.fields.description"}})],1)])]),t("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"red"},nativeOn:{click:function(t){return e.closeModal()}}}),t("q-btn",{attrs:{label:"Guardar",color:"green"},nativeOn:{click:function(t){return e.factoryFn()}}})],1)],1)],1)],1)},a=[],r=(i("caad"),i("2532"),i("14d9"),i("e260"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("aabb")),o=i("b5ae"),n=o.required,l=o.maxLength,d={name:"Index",validations:{info:{fields:{description:{required:n,maxLength:l(255)},file:{required:n}}}},data:function(){return{modal:!1,info:{fields:{description:null,file:null}},pagination:{sortBy:"name",descending:!1,rowsPerPage:25},file:null,columns:[{name:"description",align:"center",label:"DESCRIPCIÓN",field:"description",style:"width: 35%",sortable:!0},{name:"name",align:"center",label:"NOMBRE",field:"name",style:"width: 25%",sortable:!0},{name:"date",align:"center",label:"FECHA",field:"date",style:"width: 10%",sortable:!0},{name:"ext",align:"center",label:"EXT",field:"ext",style:"width: 5%",sortable:!0},{name:"size",align:"center",label:"TAMAÑO (MB)",field:"size",style:"width: 5%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 20%",sortable:!1}],data:[],repository:{name:"Archivos"}}},computed:{descriptionRules:function(e){var t=this;return[function(e){return t.$v.info.fields.description.required||"El campo Descripción es requerido."},function(e){return t.$v.info.fields.description.maxLength||"El campo Descripción no debe exceder los 255 dígitos."}]},fileRules:function(e){var t=this;return[function(e){return t.$v.info.fields.file.required||"El campo Archivo es requerido."}]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(7)||this.$router.push("/")},mounted:function(){(this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7))&&this.fetchFromServer()},beforeRouteUpdate:function(e,t,i){e.path.includes("files")&&e.params.id>0&&this.fetchFromServer(e.params.id),i()},methods:{fetchFromServer:function(e){var t=this;this.$q.loading.show(),e||(e=this.$route.params.id),r["a"].get("/repositories/".concat(e)).then((function(i){var s=i.data;r["a"].get("/dirFiles/".concat(e)).then((function(e){var i=e.data;t.data=i.info})),t.repository=s.info,t.$q.loading.hide()}))},factoryFn:function(){var e=this;if(this.$v.info.fields.$reset(),this.$v.info.fields.$touch(),this.$v.info.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=new FormData;t.append("fileReg",this.info.fields.file),t.append("id",this.$route.params.id),t.append("description",this.info.fields.description),this.$q.loading.show(),r["a"].file("/dirFiles/",t).then((function(t){var i=t.data;e.fetchFromServer(),e.$showNotify(i.message.content,i.result?"positive":"negative"),e.closeModal(),e.$q.loading.hide()}))},closeModal:function(){this.$v.info.fields.$reset(),this.info.fields.file=null,this.info.fields.description=null,this.modal=!1},getFile:function(e){var t=this;this.$q.loading.show(),r["a"].fileDownload("/dirFiles/getfile/".concat(e.id)).then((function(i){var s=i.data;t.$q.loading.hide();var a=window.URL.createObjectURL(new Blob([s],{type:e.type})),r=document.createElement("a");r.href=a,r.setAttribute("download",e.name),document.body.appendChild(r),r.click()}))},deleteSelectedRow:function(e){var t=this;this.$q.loading.show(),r["a"].delete("/dirFiles/".concat(e)).then((function(e){var i=e.data;t.$showNotify(i.message.content,i.result?"positive":"negative"),t.fetchFromServer(),t.$q.loading.hide()}))}}},c=d,f=i("2877"),u=i("9989"),p=i("ead5"),h=i("079e"),g=i("9c40"),m=i("eaac"),v=i("bd08"),b=i("db86"),q=i("05c0"),w=i("24e8"),y=i("f09f"),$=i("a370"),x=i("7d53"),C=i("27f9"),k=i("0016"),S=i("4b7e"),_=i("7f67"),F=i("eebe"),Q=i.n(F),E=Object(f["a"])(c,s,a,!1,null,null,null);t["default"]=E.exports;Q()(E,"components",{QPage:u["a"],QBreadcrumbs:p["a"],QBreadcrumbsEl:h["a"],QBtn:g["a"],QTable:m["a"],QTr:v["a"],QTd:b["a"],QTooltip:q["a"],QDialog:w["a"],QCard:y["a"],QCardSection:$["a"],QFile:x["a"],QInput:C["a"],QIcon:k["a"],QCardActions:S["a"]}),Q()(E,"directives",{ClosePopup:_["a"]})}}]);