(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[81],{e113:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("q-page",[e("div",{staticClass:"q-pa-sm panel-header"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-9"},[e("div",{staticClass:"q-pa-md q-gutter-sm"},[e("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[e("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),e("q-breadcrumbs-el",{attrs:{label:"Embarque",to:t.idUrlBack}}),e("q-breadcrumbs-el",{attrs:{label:"Nuevo envio"}})],1)],1)])])]),e("div",{staticClass:"q-pa-md bg-grey-3"},[e("div",{staticClass:"row bg-white border-panel"},[e("div",{staticClass:"col q-pa-md"},[e("div",{staticClass:"row q-mb-sm"}),e("div",{staticClass:"row q-col-gutter-xs"},[e("div",{staticClass:"col-xs-12 col-sm-3"},[e("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Folio"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"fingerprint"}})]},proxy:!0}]),model:{value:t.lot.fields.folio,callback:function(e){t.$set(t.lot.fields,"folio",e)},expression:"lot.fields.folio"}})],1),e("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[e("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:t.dateRules,error:t.$v.lot.fields.date.$error,mask:"date",label:"Fecha"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:t.lot.fields.date,callback:function(e){t.$set(t.lot.fields,"date",e)},expression:"lot.fields.date"}},[e("q-popup-proxy",{ref:"date_ref",attrs:{"transition-show":"scale","transition-hide":"scale"}},[e("div",{staticClass:"col-sm-12"},[e("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return t.$refs.date_ref.hide()}},model:{value:t.lot.fields.date,callback:function(e){t.$set(t.lot.fields,"date",e)},expression:"lot.fields.date"}})],1)])],1)],1),e("div",{staticClass:"col-xs-12 col-sm-6"},[e("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.lot.fields.client.$error,label:"Cliente",rules:t.clientRules,options:t.clientOptionsFilter,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},on:{filter:t.filterClient},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"person"}})]},proxy:!0},{key:"no-option",fn:function(){return[e("q-item",[e("q-item-section",{staticClass:"groups"},[t._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:t.lot.fields.client,callback:function(e){t.$set(t.lot.fields,"client",e)},expression:"lot.fields.client"}})],1)]),e("div",{staticClass:"row q-mb-sm q-mt-md"},[e("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[e("q-btn",{attrs:{color:"positive",icon:"add",label:"Crear"},on:{click:function(e){return t.createLotTrip()}}})],1)])])])])])},o=[],l=i("ded3"),r=i.n(l),a=(i("a9e3"),i("caad"),i("2532"),i("14d9"),i("4de4"),i("d3b7"),i("aabb")),n=i("b5ae"),c=n.required,d={name:"NewShipping",validations:{lot:{fields:{date:{required:c},client:{required:c}}}},data:function(){return{lot:{fields:{folio:null,date:null,client:null,trip_id:Number(this.$route.params.id)}},idUrlBack:"/trips/"+this.$route.params.id,id:Number(this.$route.params.id),clientOptions:[],clientOptionsFilter:[]}},mounted:function(){this.getClient(),this.getFolioTrip()},computed:{dateRules:function(t){var e=this;return[function(t){return e.$v.lot.fields.date.required||"El campo Fecha es requerido."}]},clientRules:function(t){var e=this;return[function(t){return e.$v.lot.fields.client.required||"El campo Cliente es requerido."}]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(10)||this.$router.push("/")},methods:{createLotTrip:function(){var t=this;if(this.$v.lot.fields.$reset(),this.$v.lot.fields.$touch(),this.$v.lot.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var e=r()({},this.lot.fields);e.date=this.lot.fields.date.substr(6,10)+"-"+this.lot.fields.date.substr(3,2)+"-"+this.lot.fields.date.substr(0,2),a["a"].post("/shippings",e).then((function(e){var i=e.data;t.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(t.$q.loading.hide(),t.$router.push("/lotTrip/".concat(i.id))):t.$q.loading.hide()}))},getClient:function(){var t=this;a["a"].get("customers/options").then((function(e){t.clientOptions=e.data.options}))},filterClient:function(t,e,i){var s=this;e((function(){var e=t.toLowerCase();s.clientOptionsFilter=s.clientOptions.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}))},getFolioTrip:function(){var t=this;a["a"].get("shippings/folio/".concat(this.id)).then((function(e){var i=e.data.folio.folio;a["a"].get("shippings/folioShipping/".concat(t.id)).then((function(e){var s=e.data.folioShipping.number;t.lot.fields.folio=i+"-"+s}))}))}}},u=d,f=i("2877"),p=i("9989"),m=i("ead5"),h=i("079e"),b=i("27f9"),v=i("0016"),g=i("ddd8"),q=i("7cbe"),$=i("52ee"),C=i("66e5"),x=i("4074"),w=i("9c40"),y=i("eebe"),k=i.n(y),Q=Object(f["a"])(u,s,o,!1,null,null,null);e["default"]=Q.exports;k()(Q,"components",{QPage:p["a"],QBreadcrumbs:m["a"],QBreadcrumbsEl:h["a"],QInput:b["a"],QIcon:v["a"],QSelect:g["a"],QPopupProxy:q["a"],QDate:$["a"],QItem:C["a"],QItemSection:x["a"],QBtn:w["a"]})}}]);