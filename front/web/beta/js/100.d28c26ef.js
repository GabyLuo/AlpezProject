(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[100],{ed6b:function(e,t,o){"use strict";o.r(t);o("ac1f"),o("5319");var r=function(){var e=this,t=e._self._c;return t("q-page",{staticClass:"bg-grey-3"},[t("div",{staticClass:"q-pa-sm panel-header"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-9"},[t("div",{staticClass:"q-pa-md q-gutter-sm"},[t("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[t("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),t("q-breadcrumbs-el",{attrs:{label:"Ordenes de producción",to:"/production-orders"}}),t("q-breadcrumbs-el",{staticStyle:{cursor:"pointer"},attrs:{label:"Lote"},domProps:{textContent:e._s(e.lot.fields.order_number)},on:{click:function(t){return e.editSelectedRow()}}}),t("q-breadcrumbs-el",{attrs:{label:"Editar"},domProps:{textContent:e._s(e.lot.fields.lot_number)}})],1)],1)]),t("div",{staticClass:"col-xs-12 col-sm-3 pull-right"},["NUEVO"===e.lot.fields.status||"ASIGNADO"===e.lot.fields.status?t("q-btn",{staticClass:"bg-primary",staticStyle:{"margin-right":"10px"},attrs:{icon:"fas fa-bolt",label:"INICIAR"},on:{click:function(t){return e.execute()}}}):e._e(),"INICIADO"===e.lot.fields.status?t("q-btn",{staticStyle:{"margin-right":"10px"},attrs:{color:"primary",icon:"fas fa-check",label:"FINALIZAR"},on:{click:function(t){return e.finalizeLot()}}}):e._e()],1)])]),t("div",{staticClass:"q-pa-md bg-grey-3"},[t("div",{staticClass:"row bg-white border-panel"},[t("div",{staticClass:"col q-pa-md"},[t("div",{staticClass:"row q-col-gutter-xs"},[t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Número de orden"},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"code"}})]},proxy:!0}]),model:{value:e.lot.fields.order_number,callback:function(t){e.$set(e.lot.fields,"order_number",t)},expression:"lot.fields.order_number"}})],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha programada",rules:e.creationDateRules,disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.lot.fields.production_date,callback:function(t){e.$set(e.lot.fields,"production_date",t)},expression:"lot.fields.production_date"}},[t("q-popup-proxy",{ref:"orderFieldsCreationDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("div",{staticClass:"col-sm-12"},[t("q-date",{attrs:{"today-btn":""},on:{input:function(){return e.$refs.orderFieldsCreationDateRef.hide()}},model:{value:e.lot.fields.production_date,callback:function(t){e.$set(e.lot.fields,"production_date",t)},expression:"lot.fields.production_date"}})],1)])],1)],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-input",{attrs:{color:"white","bg-color":"NUEVO"===e.lot.fields.status?"primary":"INICIADO"===e.lot.fields.status?"blue":"FINALIZADO"===e.lot.fields.status?"green":"red",filled:"",dark:"",label:"Estatus",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"battery_full"}})]},proxy:!0}]),model:{value:e.lot.fields.status,callback:function(t){e.$set(e.lot.fields,"status",t)},expression:"lot.fields.status"}})],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.lot.fields.family.$error,label:"Categorías",rules:e.bomcategoryRules,options:e.options1,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":"",disable:""},on:{input:function(t){return e.getLinesByCategories()},filter:e.filterCategory},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0},{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay Resultados\n                    ")])],1)]},proxy:!0}]),model:{value:e.lot.fields.family,callback:function(t){e.$set(e.lot.fields,"family",t)},expression:"lot.fields.family"}})],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-select",{attrs:{filled:"",color:"dark","bg-color":"secondary",error:e.$v.lot.fields.product.$error,label:"Producto",options:e.options2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":"",disable:""},on:{filter:e.filterProduct},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-grip-lines-vertical"}})]},proxy:!0},{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay Resultados\n                    ")])],1)]},proxy:!0}]),model:{value:e.lot.fields.product,callback:function(t){e.$set(e.lot.fields,"product",t)},expression:"lot.fields.product"}})],1),t("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.lot.fields.qty.$error,label:"Cantidad a producir",rules:e.qtyRules,disable:!e.canModifyOrder},on:{input:function(t){e.lot.fields.qty=t.replace(/[^0-9\\.]/g,"")}},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-weight-hanging"}})]},proxy:!0}]),model:{value:e.lot.fields.qty,callback:function(t){e.$set(e.lot.fields,"qty",t)},expression:"lot.fields.qty"}})],1),t("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Cantidad producida",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-weight-hanging"}})]},proxy:!0}]),model:{value:e.lot.fields.qty_real,callback:function(t){e.$set(e.lot.fields,"qty_real",t)},expression:"lot.fields.qty_real"}})],1),t("div",{staticClass:"col-xs-12 text-center"},[t("q-linear-progress",{attrs:{stripe:"",size:"33px",value:e.shipmentsProgress,color:"positive"}},[t("q-chip",{attrs:{dense:"",square:"",color:"secondary","text-color":"white"}},[e._v("\n                  "+e._s(e.shipmentsProgressLabel)+"\n                ")])],1)],1)])])]),t("br"),t("div",{staticClass:"q-pa-xs"},[t("div",{staticClass:"q-gutter-y-md",staticStyle:{width:"100%"}},[t("q-card",[t("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t("q-tab",{attrs:{name:"bom",icon:"fas fa-cubes",label:"BOM"}}),t("q-tab",{attrs:{name:"work",icon:"fas fa-hard-hat",label:"MANO DE OBRA"}})],1),t("q-separator"),t("q-tab-panels",{attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t("q-tab-panel",{attrs:{name:"bom"}},[t("div",{staticStyle:{"background-color":"white"}},[t("div",{staticClass:"col q-pa-md"})]),t("q-table",{attrs:{flat:"",bordered:"",data:e.dataBom,columns:e.columns,"row-key":"product",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(o){return[t("q-tr",{attrs:{props:o}},[t("q-td",{key:"code_product",attrs:{props:o}},[e._v(e._s(o.row.product_code))]),t("q-td",{key:"product_name",attrs:{props:o}},[e._v(e._s(o.row.product_name))]),t("q-td",{key:"code_line",attrs:{props:o}},[e._v(e._s(o.row.product_category))]),t("q-td",{key:"name_category",attrs:{props:o}},[e._v(e._s(o.row.category_name))]),t("q-td",{key:"amount",attrs:{props:o}},[e._v(e._s(e.$formatNumberThree(o.row.amount)))]),t("q-td",{key:"lastprice",attrs:{props:o}},[e._v(e._s("".concat(e.currencyFormatter.format(o.row.lastprice))))]),t("q-td",{key:"totalprice",attrs:{props:o}},[e._v(e._s("".concat(e.currencyFormatter.format(o.row.lastprice*o.row.amount))))]),o.row.qty*o.row.amount<=o.row.existencia?t("q-td",{key:"stock",staticStyle:{"background-color":"green"},attrs:{props:o}},[e._v(e._s(e.$formatNumberThree(o.row.existencia)))]):t("q-td",{key:"stock",staticStyle:{"background-color":"red"},attrs:{props:o}},[e._v(e._s(e.$formatNumberThree(o.row.existencia)))]),t("q-td",{key:"total",attrs:{props:o}},[e._v(e._s(e.$formatNumberThree(o.row.stock)))])],1)]}}])})],1),t("q-tab-panel",{attrs:{name:"work"}},[t("div",{staticStyle:{"background-color":"white"}},[t("div",{staticClass:"col q-pa-md"},[t("div",{staticClass:"row q-col-gutter-xs"},[t("q-dialog",{attrs:{persistent:""},model:{value:e.modalWork,callback:function(t){e.modalWork=t},expression:"modalWork"}},[t("q-card",{staticStyle:{"min-width":"50%"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("MANO DE OBRA")])]),t("q-card-section"),t("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}})],1)],1)],1)])]),t("q-table",{attrs:{flat:"",bordered:"",data:e.dataWork,columns:e.columnswork,"row-key":"nombre",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(o){return[null!==o.row.handiwork_id?t("q-tr",{attrs:{props:o}},[t("q-td",{key:"name",staticClass:"pull-left",attrs:{props:o}},[e._v(e._s(o.row.name_work))]),t("q-td",{key:"price_hour",staticClass:"pull-right",attrs:{props:o}},[e._v("$"+e._s(e.currencyFormat(o.row.price_hour)))]),t("q-td",{key:"price_minute",staticClass:"pull-right",attrs:{props:o}},[e._v("$"+e._s(e.currencyFormat(o.row.price_minute)))]),t("q-td",{key:"time_job",staticClass:"pull-right",attrs:{props:o}},[e._v(e._s(o.row.time_job))]),t("q-td",{key:"price_qty",staticClass:"pull-right",attrs:{props:o}},[e._v("$"+e._s(e.currencyFormat(o.row.price_qty)))]),null!==o.row.qtyw?t("q-td",{key:"qty",staticClass:"pull-right",attrs:{props:o}},[e._v(e._s(o.row.qtyw))]):t("q-td",{key:"qty",staticClass:"pull-right",attrs:{props:o}},[e._v(e._s(o.row.qty))]),null!==o.row.amountw?t("q-td",{key:"amount",staticClass:"pull-right",attrs:{props:o}},[e._v("$"+e._s(o.row.amountw))]):t("q-td",{key:"amount",staticClass:"pull-right",attrs:{props:o}},[e._v("$"+e._s(o.row.amount))]),t("q-td",{key:"employee_name",attrs:{props:o}},[e._v(e._s(o.row.employee_name))]),t("q-td",{key:"actions",staticClass:"pull-left",attrs:{props:o}},[null===o.row.employee_id?t("q-btn",{staticClass:"action-btn",staticStyle:{"text-align":"left"},attrs:{color:null===o.row.employee_id?"red":"green",icon:"manage_accounts",flat:""},nativeOn:{click:function(t){return e.OpenModalOperador(o.row)}}},[t("q-tooltip",{attrs:{"content-class":"bg-positive"}},[e._v("AGREGAR OPERADOR")])],1):t("q-btn",{staticClass:"action-btn",staticStyle:{"text-align":"left"},attrs:{color:null===o.row.employee_id?"red":"green",icon:"manage_accounts",flat:""},nativeOn:{click:function(t){return e.OpenModalOperadorEdit(o.row)}}},[t("q-tooltip",{attrs:{"content-class":"bg-positive"}},[e._v("OPERADOR")])],1)],1)],1):e._e()]}}])},[t("q-tr",{attrs:{slot:"bottom-row"},slot:"bottom-row"},[t("q-td"),t("q-td"),t("q-td"),t("q-td"),t("q-td"),t("q-td"),t("q-td",{staticStyle:{"text-align":"right"}},[t("strong",[e._v("Total: $"+e._s(e.tot))])])],1)],1)],1)],1)],1)],1)])]),t("q-dialog",{attrs:{persistent:""},model:{value:e.modalOperador,callback:function(t){e.modalOperador=t},expression:"modalOperador"}},[t("q-card",{staticStyle:{"min-width":"50%"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Agregar Operador ")])]),t("q-card-section",[t("div",{staticClass:"row q-col-gutter-xs"},[t("div",{staticClass:"col-xs-12 col-sm-"},[t("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"OPERADOR",options:e.selectEmployees,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0},{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay Resultados\n                    ")])],1)]},proxy:!0}]),model:{value:e.employee.fields.employee_id,callback:function(t){e.$set(e.employee.fields,"employee_id",t)},expression:"employee.fields.employee_id"}})],1)])]),t("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"red"}}),t("q-btn",{attrs:{label:"Guardar",color:"green"},nativeOn:{click:function(t){return e.saveEmployee()}}})],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:e.modalOperadorEdit,callback:function(t){e.modalOperadorEdit=t},expression:"modalOperadorEdit"}},[t("q-card",{staticStyle:{"min-width":"50%"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Editar Operador ")])]),t("q-card-section",[t("div",{staticClass:"row q-col-gutter-xs"},[t("div",{staticClass:"col-xs-12 col-sm-"},[t("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"OPERADOR",options:e.selectEmployees,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0},{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay Resultados\n                    ")])],1)]},proxy:!0}]),model:{value:e.employeeEdit.fields.employee_id,callback:function(t){e.$set(e.employeeEdit.fields,"employee_id",t)},expression:"employeeEdit.fields.employee_id"}})],1)])]),t("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"red"}}),t("q-btn",{attrs:{label:"Guardar",color:"green"},nativeOn:{click:function(t){return e.updateEmployee()}}})],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:e.modalFinish,callback:function(t){e.modalFinish=t},expression:"modalFinish"}},[t("q-card",{staticStyle:{"min-width":"50%"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Capturar Devolución ")])]),t("q-card-section",[t("div",{staticClass:"row q-col-gutter-xs"},[t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Producto",rules:e.bomcategoryRules,options:e.options1,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-":"",disable:""},on:{input:function(t){return e.getLinesByCategories()},filter:e.filterCategory},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0},{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay Resultados\n                    ")])],1)]},proxy:!0}]),model:{value:e.lotFinish.fields.product,callback:function(t){e.$set(e.lotFinish.fields,"product",t)},expression:"lotFinish.fields.product"}})],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Cantidad Solicitada",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.lotFinish.fields.amount,callback:function(t){e.$set(e.lotFinish.fields,"amount",t)},expression:"lotFinish.fields.amount"}})],1),t("div",{staticClass:"col-xs-12 col-sm-4"},[t("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Producido"},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.lotFinish.fields.qty,callback:function(t){e.$set(e.lotFinish.fields,"qty",t)},expression:"lotFinish.fields.qty"}})],1)])]),t("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"red"}}),t("q-btn",{attrs:{label:"Guardar",color:"green"},nativeOn:{click:function(t){return e.finalizeLotReturnMaterial()}}})],1)],1)],1)],1)},i=[],s=o("ded3"),a=o.n(s),l=(o("a9e3"),o("b680"),o("4de4"),o("d3b7"),o("159b"),o("14d9"),o("caad"),o("2532"),o("a15b"),o("c35a"),o("aabb")),n=o("b5ae"),d=n.required,u=n.decimal,c=n.helpers,p=c.regex("num",/[0-9]+$/),f={name:"EditLot",validations:{lot:{fields:{order_number:{required:d},production_date:{required:d},product:{required:d},family:{required:d},qty:{required:d,decimal:u},status:{required:d},category_id:{},qty_real:{}}},lotFinish:{fields:{product:{},amount:{},qty:{required:d}}},bom:{fields:{category:{},product:{required:d},cantidad:{required:d}}},formula:{fields:{product:{required:d},qty:{required:d,decimal:u},quality:{required:d}}},raw_material:{fields:{product:{required:d},bag:{required:d}}},return_raw_material:{fields:{returned_qty:{required:d,decimal:u}}},measurement:{fields:{value:{required:d,decimal:u},measure:{required:d}}},scrap:{fields:{qty:{required:d,decimal:u}}},work:{fields:{work_id:{required:d},time_job:{required:d,num:p}}},finished_product:{fields:{product:{required:d},weight:{required:d,decimal:u}}},employee:{fields:{employee_id:{},lot:{}}},employeeEdit:{fields:{employee_id:{},lot:{}}}},data:function(){return{workEdit:null,tab:"bom",modalFinish:!1,modalWork:!1,modalOperador:!1,modalOperadorEdit:!1,tot:0,emple:!1,options1:this.categoryOptions,options2:this.ProductsOptionsbyLines,formatter:new Intl.NumberFormat("en-US"),currencyFormatter:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),currentTab:"formula",lot:{fields:{id:null,order_id:null,order_number:null,production_date:null,product:null,qty:null,status:null,family:1,category_id:null,movement_id:null,raw_material_movement_id:null,order_product_id:null,rawMaterialExecuted:!1,returnedRawMaterialExecuted:!1,qty_real:0}},lotFinish:{fields:{product:null,amount:null,qty:null}},bom:{fields:{idedit:null,category:null,product:null,cantidad:null}},work:{fields:{idedit:null,product_id:null,time_job:null,work_id:null}},formula:{fields:{id:null,product:null,qty:null,quality:null}},raw_material:{fields:{id:null,origin_storage:"ALMACEN RECIBO MP",consumption_storage:"ALMACEN PRODUCCION MP",product:null,bag:null,weight:0,returned_qty:0}},return_raw_material:{fields:{id:null,returned_qty:0}},measurement:{fields:{id:null,process_id:null,process:null,value:null,measure:null,zone_number:null,dryer_number:null,finished:null}},scrap:{fields:{id:null,qty:null,process_id:null,process:null,dryer_number:null,finished:null}},finished_product:{fields:{id:null,storage:"ALMACEN PT FIBRA",product:null,weight:null}},employee:{fields:{employee_id:null,lot:null}},employeeEdit:{fields:{employee_id:null,lot:null}},columns:[{name:"code_product",align:"center",label:"CÓDIGO PRODUCTO",field:"code_product",sortable:!1},{name:"product_name",align:"center",label:"NOMBRE PRODUCTO",field:"product_name",sortable:!1},{name:"name_category",align:"center",label:"CATEGORÍAS",field:"name_category",sortable:!1},{name:"amount",align:"center",label:"CANTIDAD POR PIEZA",field:"amount",sortable:!1},{name:"lastprice",align:"center",label:"COSTO ÚLTIMA COMPRA",field:"lastprice",sortable:!1},{name:"totalprice",align:"center",label:"COSTO TOTAL",field:"totalprice",sortable:!1},{name:"stock",align:"center",label:"EXISTENCIA",field:"stok",sortable:!1},{name:"total",align:"center",label:"TOTAL REQUERIDO",field:"total",sortable:!1}],columnswork:[{name:"name",align:"center",label:"NOMBRE",field:"name",sortable:!1},{name:"price_hour",align:"center",label:" COSTO POR HORA",field:"price_hour",sortable:!1},{name:"price_minute",align:"center",label:" COSTO POR MINUTO",field:"price_minute",sortable:!1},{name:"time_job",align:"center",label:"TIEMPO REQUERIDO",field:"time_job",sortable:!1},{name:"price_qty",align:"center",label:" TOTAL REQUERIDO",field:"price_qty",sortable:!1},{name:"qty",align:"center",label:"CANTIDAD A PRODUCIR",field:"qty",sortable:!1},{name:"amount",align:"center",label:"COSTO FINAL",field:"amount",sortable:!1},{name:"employee_name",align:"center",label:"OPERADOR",field:"employee_name",sortable:!1},{name:"actions",align:"center",label:"ACCIONES",field:"actions",sortable:!1}],pagination:{sortBy:"id",descending:!1,rowsPerPage:25},processesPagination:{sortBy:"code",descending:!1,page:1,rowsPerPage:0},rawMaterialsPagination:{rowsPerPage:50},processMeasurementsPagination:{rowsPerPage:50},dataBom:[],formulas:[],rawMaterials:[],returnedRawMaterials:[],measurements:[],scraps:[],processMeasurements:[],processes:[],finishedProducts:[],productOptions:[],lotProductOptions:[],lotCustomerOptions:[],rawMaterialOptions:[],qualityOptions:[{value:"A",label:"A"},{value:"B",label:"B"},{value:"C",label:"C"}],bagOptions:[],processIdToEdit:null,inputQtyReturnRawMaterialModal:!1,measurementsModal:!1,scrapModal:!1,categoryOptions:[],ProductsOptionsbyLines:[],dataWork:[],selectEmployees:[],rowwork:[]}},computed:{creationDateRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.production_date.required||"El campo Fecha de creación es requerido."}]},canModifyOrder:function(){return"NUEVO"===this.lot.fields.status||"FORMULADO"===this.lot.fields.status},bomcategoryRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.family.required||"El campo Categorías es requerido."}]},bomproductsRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.product.required||"El campo Productos es requerido."}]},qtyRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.qty.required||"El campo Cantidad es requerido."},function(e){return t.$v.lot.fields.qty.decimal||"El campo Cantidad debe ser numérico."}]},shipmentsProgress:function(){return Number("NUEVO"===this.lot.fields.status?0:"INICIADO"===this.lot.fields.status?.5:"FINALIZADO"===this.lot.fields.status?1:0)},shipmentsProgressLabel:function(){return"Avance: "+(100*this.shipmentsProgress).toFixed(2)+"%"},qualityVolumeRules:function(e){var t=this;return[function(e){return t.$v.quality.fields.volume.decimal||"El campo Volumen debe ser numérico."}]},zoneIcon:function(){return this.measurement.fields.zone_number&&2===Number(this.measurement.fields.zone_number.value)?"fas fa-dice-two":this.measurement.fields.zone_number&&3===Number(this.measurement.fields.zone_number.value)?"fas fa-dice-three":this.measurement.fields.zone_number&&4===Number(this.measurement.fields.zone_number.value)?"fas fa-dice-four":this.measurement.fields.zone_number&&5===Number(this.measurement.fields.zone_number.value)?"fas fa-dice-five":"fas fa-dice-one"},familyFilteredProductOptions:function(){var e=this;return null!=this.lot.fields.product&&null!=this.lot.fields.product.value?this.productOptions.filter((function(t){return Number(t.family)===Number(e.lot.fields.product.value)||Number(t.value)===Number(e.lot.fields.product.value)})):[]},filteredBagOptions:function(){var e=this,t=[];return this.rawMaterials.forEach((function(e){return t.push(Number(e.bag_id))})),null!=this.raw_material.fields.product&&null!=this.raw_material.fields.product.value?this.bagOptions.filter((function(o){return Number(o.product_id)===Number(e.raw_material.fields.product.value)&&!t.includes(Number(o.value))})):[]},filteredRawMaterialWithBagsOptions:function(){var e=[];return this.bagOptions.forEach((function(t){e.includes(Number(t.product_id))||e.push(Number(t.product_id))})),this.rawMaterialOptions.filter((function(t){return e.includes(Number(t.value))}))},lotProductRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.product.required||"El campo Producto es requerido."}]},lotWeightRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.weight.required||"El campo Peso es requerido."},function(e){return t.$v.lot.fields.weight.decimal||"El campo Peso debe ser numérico."}]},formulaProductRules:function(e){var t=this;return[function(e){return t.$v.formula.fields.product.required||"El campo Producto es requerido."}]},formulaQtyRules:function(e){var t=this;return[function(e){return t.$v.formula.fields.qty.required||"El campo Cantidad es requerido."},function(e){return t.$v.formula.fields.qty.decimal||"El campo Cantidad debe ser numérico."}]},qualityRules:function(e){var t=this;return[function(e){return t.$v.formula.fields.quality.required||"El campo Calidad es requerido."}]},rawMaterialProductRules:function(e){var t=this;return[function(e){return t.$v.raw_material.fields.product.required||"El campo Producto es requerido."}]},rawMaterialBagRules:function(e){var t=this;return[function(e){return t.$v.raw_material.fields.bag.required||"El campo Saco es requerido."}]},measurementValueRules:function(e){var t=this;return[function(e){return t.$v.measurement.fields.value.required||"El campo Valor es requerido."},function(e){return t.$v.measurement.fields.value.decimal||"El campo Valor debe ser numérico."}]},measurementZoneRules:function(e){var t=this;return[function(e){return t.$v.measurement.fields.zone.required||"El campo Zona es requerido."}]},measurementMeasureRules:function(e){var t=this;return[function(e){return t.$v.measurement.fields.measure.required||"El campo Medición es requerido."}]},finishedProductProductRules:function(e){var t=this;return[function(e){return t.$v.finished_product.fields.product.required||"El campo Producto es requerido."}]},finishedProductWeightRules:function(e){var t=this;return[function(e){return t.$v.finished_product.fields.weight.required||"El campo Peso es requerido."},function(e){return t.$v.finished_product.fields.weight.decimal||"El campo Peso debe ser numérico."}]},rawMaterialQtyToReturnRules:function(e){var t=this;return[function(e){return t.$v.return_raw_material.fields.returned_qty.required||"El campo Cantidad a devolver es requerido."},function(e){return t.$v.return_raw_material.fields.returned_qty.decimal||"El campo Cantidad a devolver debe ser numérico."}]},scrapQtyRules:function(e){var t=this;return[function(e){return t.$v.scrap.fields.qty.required||"El campo Peso es requerido."},function(e){return t.$v.scrap.fields.qty.decimal||"El campo Peso debe ser numérico."}]},measurementUnit:function(){return null!=this.measurement.fields.measure&&null!=this.measurement.fields.measure.value&&null!=this.measurement.fields.measure.value.split("(")[1]&&null!=this.measurement.fields.measure.value.split("(")[1].split(")")[0]?null!=this.measurement.fields.measure.value.split("(")[1]&&this.measurement.fields.measure.value.split("(")[1].split(")")[0]:null},totalFormulaQties:function(){var e=0;return this.formulas.forEach((function(t){t.qty&&(e+=Number(t.qty))})),e},totalRawMaterialWeight:function(){var e=0;return this.rawMaterials.forEach((function(t){t.weight&&(e+=Number(t.weight))})),e},totalFinishedProductWeight:function(){var e=0;return this.finishedProducts.forEach((function(t){t.weight&&(e+=Number(t.weight))})),e}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(4)||this.$store.getters["users/roles"].includes(5)||this.$store.getters["users/roles"].includes(6)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(8)||this.$store.getters["users/roles"].includes(9)||this.$store.getters["users/roles"].includes(10)||this.$router.push("/")},created:function(){this.fetchFromServer()},methods:{fetchFromServer:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;l["a"].get("/production-lots/".concat(t)).then((function(o){var r=o.data;console.log(r.bom),r.lot&&(e.lot.fields=r.lot,e.lot.fields.start_date=e.lot.fields.start_date?e.lot.fields.start_date.split("-").join("/"):null,e.lot.fields.finish_date=e.lot.fields.finish_date?e.lot.fields.finish_date.split("-").join("/"):null,e.lot.fields.product={value:r.lot.product_id,label:r.lot.product},e.lot.fields.customer={value:r.lot.customer_id,label:r.lot.customer},e.lot.fields.family={value:r.lot.category_id,label:r.lot.category_name},e.dataBom=r.bom,e.lot.fields.order_id=r.lot.order_id,e.lot.fields.order_number=r.lot.order_number,e.lot.fields.production_date=r.lot.scheduled_start_date,e.lot.fields.qty=r.lot.weight,l["a"].get("/works-lots/getby/".concat(t)).then((function(t){var o=t.data;e.$q.loading.hide(),e.dataWork=o.info,e.tot=o.tot,e.workEdit=o.info.idw})).catch((function(e){return e})))}))},fetchFromServerWorks:function(){var e=this,t=this.$route.params.id;l["a"].get("/works-lots/getby/".concat(t)).then((function(t){var o=t.data;e.dataWork=o.info,e.tot=o.tot,e.workEdit=o.info.idw})).catch((function(e){return e}))},filterCategory:function(e,t,o){var r=this;t((function(){var t=e.toLowerCase();r.options1=r.categoryOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},filterProduct:function(e,t,o){var r=this;t((function(){var t=e.toLowerCase();r.options2=r.ProductsOptionsbyLines.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},backToProductionOrder:function(){this.$router.push("/production-orders/".concat(this.lot.fields.order_id))},updateLot:function(){var e=this;if(this.$v.lot.fields.$reset(),this.$v.lot.fields.$touch(),this.$v.lot.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.lot.fields);t.product_id=t.product.value,null!=t.customer&&null!=t.customer.value&&(t.customer_id=t.customer.value),l["a"].put("/production-lots/".concat(t.id),t).then((function(t){var o=t.data;if(e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result){var r=e.$route.params.id;l["a"].get("/production-lots/".concat(r)).then((function(t){var o=t.data;e.lot.fields=o.lot,e.lot.fields.start_date=e.lot.fields.start_date?e.lot.fields.start_date.split("-").join("/"):null,e.lot.fields.finish_date=e.lot.fields.finish_date?e.lot.fields.finish_date.split("-").join("/"):null,e.$q.loading.hide()}))}else e.$q.loading.hide()}))},packingList:function(){var e="http://api.alpez.beta.wasp.mx/"+"production-lots/packing-list/pdf/".concat(this.$route.params.id);window.open(e,"_blank")},execute:function(){for(var e=this,t=0;t<this.dataWork.length;t++)if(null===this.dataWork[t].employee_id&&null!==this.dataWork[t].handiwork_id)return this.$q.dialog({title:"Error",message:"Por favor, agregue operador.",persistent:!0}),!1;this.showLoading();var o=this.$route.params.id;l["a"].get("/production-lots/".concat(o)).then((function(t){for(var o=t.data,r="si",i=0;i<o.bom.length;i++)"no"===o.bom[i].cantidades_suficientes&&(r="no");if("si"===r){var s=a()({},e.lot.fields);l["a"].post("/production-lots/executelot/".concat(s.id),s).then((function(t){var o=t.data;o&&(e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"red"}),o.result,e.fetchFromServer(),e.beforeDestroy())}))}else{e.beforeDestroy();for(var n=0;n<o.bom.length;n++)"PRI"!==o.bom[n].category_code&&"PROD. INTERMEDIO"!==o.bom[n].category_name||"no"!==o.bom[n].cantidades_suficientes||function(){var t=o.bom[n];e.$q.dialog({title:"PRODUCTO: "+o.bom[n].product_code+" (Insuficiente)",message:"¿Desea crear un Lote para la cantidad faltante del producto?",ok:{label:"Aceptar",color:"green"},cancel:{label:"Cancelar",color:"red"},persistent:!0}).onOk((function(){e.showLoading(),l["a"].post("/production-lots",t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"green"}),o.resul,e.beforeDestroy()}))})).onCancel((function(){e.beforeDestroy()}))}(),"MTP"!==o.bom[n].category_code&&"MAT. PRIMA"!==o.bom[n].category_name||"no"===o.bom[n].cantidades_suficientes&&e.$q.notify({message:"Falta de Materia Prima: "+o.bom[n].product_code,position:"top",color:"red"});e.fetchFromServer()}}))},finalizeLot:function(){var e=this;this.$q.dialog({title:"Finalización del lote",message:"¿Desea finalizar y dar por terminado el lote?",persistent:!0,ok:{label:"Aceptar",color:"green"},cancel:{label:"Cancelar",color:"red"}}).onOk((function(){e.showLoading();var t=a()({},e.lot.fields);l["a"].post("/production-lots/getfinalizelot/".concat(t.id),t).then((function(t){var o=t.data;if(o.finalizeLot)e.lotFinish.fields.product=e.lot.fields.product,e.lotFinish.fields.amount=o.finalizeLot.weight,e.modalFinish=!0,e.beforeDestroy();else{var r=a()({},e.lot.fields);l["a"].post("/production-lots/finalizeLot/".concat(r.id),r).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"red"}),o.result&&(e.fetchFromServer(),e.beforeDestroy())}))}}))})).onCancel((function(){return e.beforeDestroy(),!1}))},editSelectedRow:function(){this.$router.push("/production-orders/".concat(this.lot.fields.order_id))},finalizeLotReturnMaterial:function(){var e=this;this.showLoading();var t=a()({},this.lot.fields);t.returned_qty=this.lotFinish.fields.qty,parseInt(this.lotFinish.fields.qty)===parseInt(this.lot.fields.qty)&&(this.modalFinish=!1,l["a"].post("/production-lots/finalizeLot/".concat(t.id),t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"red"}),e.fetchFromServer(),e.modalFinish=!1,o&&e.beforeDestroy()}))),parseInt(this.lotFinish.fields.qty)<parseInt(this.lot.fields.qty)&&parseInt(this.lotFinish.fields.qty)>0&&(this.modalFinish=!1,l["a"].post("/production-lots/finalizeLotReturMaterial/".concat(t.id),t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"red"}),e.fetchFromServer(),e.modalFinish=!1,o&&e.beforeDestroy()})))},showLoading:function(){this.$q.loading.show({spinnerColor:"primary",spinnerSize:140,backgroundColor:"white",message:"Cargando..",messageColor:"black"})},beforeDestroy:function(){this.$q.loading.hide()},currencyFormat:function(e){return Number.parseFloat(e).toFixed(3).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},OpenModalOperador:function(e){var t=this;this.rowwork=e,this.modalOperador=!0,this.employee.fields.lot=e.plw_id,l["a"].get("/employees/options").then((function(e){var o=e.data;t.selectEmployees=o.options})).catch((function(e){return e}))},OpenModalOperadorEdit:function(e){var t=this;this.rowwork=e,this.modalOperadorEdit=!0,this.employee.fields.lot=e.plw_id,this.workEdit=e.idw,l["a"].get("/employees/options").then((function(o){var r=o.data;t.selectEmployees=r.options,t.employeeEdit.fields.employee_id={value:e.employee_id,label:e.employee_name}})).catch((function(e){return e}))},saveEmployee:function(){var e=this;if(this.$v.employee.fields.$reset(),this.$v.employee.fields.$touch(),this.$v.employee.fields.$error)return this.$q.notify({message:"Por favor selecione una opcion.",color:"warning",position:"top"}),!1;if(null!==this.rowwork.employee_id)return this.$q.notify({message:"Operador ya asignado.",color:"warning",position:"top"}),!1;this.modalOperador=!1,this.showLoading();var t=a()({},this.employee.fields);t.row=this.rowwork,l["a"].post("/works-lots/",t).then((function(t){var o=t.data;o.result&&(e.employee.fields.employee_id=null,e.fetchFromServerWorks()),e.$q.notify({message:o.message.content,color:o.result?"positive":"red",position:"top"}),e.beforeDestroy()}))},updateEmployee:function(){var e=this;if(this.$v.employee.fields.$reset(),this.$v.employee.fields.$touch(),this.$v.employee.fields.$error)return this.$q.notify({message:"Por favor selecione una opcion.",color:"warning",position:"top"}),!1;this.modalOperadorEdit=!1,this.showLoading();var t=a()({},this.employeeEdit.fields);l["a"].put("/works-lots/".concat(this.workEdit),t).then((function(t){var o=t.data;o.result&&(e.employee.fields.employee_id=null,e.fetchFromServerWorks()),e.$q.notify({message:o.message.content,color:o.result?"positive":"red",position:"top"}),e.beforeDestroy()}))}}},m=f,h=o("2877"),b=o("9989"),y=o("ead5"),v=o("079e"),g=o("9c40"),q=o("27f9"),_=o("0016"),w=o("ddd8"),k=o("7cbe"),C=o("52ee"),O=o("66e5"),$=o("4074"),E=o("6b1d"),x=o("b047"),R=o("f09f"),P=o("429b"),F=o("7460"),N=o("eb85"),S=o("adad"),A=o("823b"),I=o("eaac"),D=o("bd08"),M=o("db86"),L=o("24e8"),T=o("a370"),Q=o("4b7e"),z=o("05c0"),B=o("7f67"),W=o("eebe"),U=o.n(W),j=Object(h["a"])(m,r,i,!1,null,null,null);t["default"]=j.exports;U()(j,"components",{QPage:b["a"],QBreadcrumbs:y["a"],QBreadcrumbsEl:v["a"],QBtn:g["a"],QInput:q["a"],QIcon:_["a"],QSelect:w["a"],QPopupProxy:k["a"],QDate:C["a"],QItem:O["a"],QItemSection:$["a"],QLinearProgress:E["a"],QChip:x["a"],QCard:R["a"],QTabs:P["a"],QTab:F["a"],QSeparator:N["a"],QTabPanels:S["a"],QTabPanel:A["a"],QTable:I["a"],QTr:D["a"],QTd:M["a"],QDialog:L["a"],QCardSection:T["a"],QCardActions:Q["a"],QTooltip:z["a"]}),U()(j,"directives",{ClosePopup:B["a"]})}}]);