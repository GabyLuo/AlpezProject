(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[190],{a8d9:function(e,i,t){"use strict";t.r(i);var s=function(){var e=this,i=e._self._c;return i("q-page",{staticClass:"bg-grey-3"},[i("div",{staticClass:"q-pa-sm panel-header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-9"},[i("div",{staticClass:"q-pa-md q-gutter-sm"},[i("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[i("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),i("q-breadcrumbs-el",{attrs:{label:"Embarques",to:"/trips"}}),i("q-breadcrumbs-el",{attrs:{label:"Nuevo embarque"}})],1)],1)])])]),i("div",{staticClass:"q-pa-md bg-grey-3"},[i("div",{staticClass:"row bg-white border-panel"},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-mb-sm"}),i("div",{staticClass:"row q-col-gutter-xs"},[i("div",{staticClass:"col-xs-12 col-sm-2 col-md-2 col-lg-2"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.trip.fields.invoice_id.$error,label:"Remision / Factura",rules:e.invoiceRules,options:e.invoicesOptionsFilter,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.filterInvoices},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"fact_check"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:e.trip.fields.invoice_id,callback:function(i){e.$set(e.trip.fields,"invoice_id",i)},expression:"trip.fields.invoice_id"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.dateRules,error:e.$v.trip.fields.date.$error,mask:"DD/MM/YYYY HH:mm:ss",label:"Fecha"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.trip.fields.date,callback:function(i){e.$set(e.trip.fields,"date",i)},expression:"trip.fields.date"}},[i("q-popup-proxy",{ref:"date_ref",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-6"},[i("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY HH:mm:ss"},model:{value:e.trip.fields.date,callback:function(i){e.$set(e.trip.fields,"date",i)},expression:"trip.fields.date"}})],1),i("div",{staticClass:"col-sm-6"},[i("q-time",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY HH:mm:ss","now-btn":""},on:{input:function(){return e.$refs.date_ref.hide()}},model:{value:e.trip.fields.date,callback:function(i){e.$set(e.trip.fields,"date",i)},expression:"trip.fields.date"}})],1)])])],1)],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.trip.fields.vehicle_id.$error,label:"Número de unidad",rules:e.vehicle_idRules,options:e.economicNumberOptions,"emit-value":"","map-options":""},on:{input:function(i){return e.getVehicleData()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"tag"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:e.trip.fields.vehicle_id,callback:function(i){e.$set(e.trip.fields,"vehicle_id",i)},expression:"trip.fields.vehicle_id"}})],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Tipo de vehículo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_numbered"}})]},proxy:!0}]),model:{value:e.vehicle.fields.type,callback:function(i){e.$set(e.vehicle.fields,"type",i)},expression:"vehicle.fields.type"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Marca de vehículo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"book"}})]},proxy:!0}]),model:{value:e.vehicle.fields.brand,callback:function(i){e.$set(e.vehicle.fields,"brand",i)},expression:"vehicle.fields.brand"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Modelo de vehiculo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_bulleted"}})]},proxy:!0}]),model:{value:e.vehicle.fields.model,callback:function(i){e.$set(e.vehicle.fields,"model",i)},expression:"vehicle.fields.model"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Placas","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_bulleted"}})]},proxy:!0}]),model:{value:e.vehicle.fields.plate,callback:function(i){e.$set(e.vehicle.fields,"plate",i)},expression:"vehicle.fields.plate"}})],1)]),i("div",{staticClass:"row q-mb-sm q-mt-md"},[i("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[i("q-btn",{attrs:{color:"positive",icon:"save",label:"Guardar"},on:{click:function(i){return e.createTrip()}}})],1)])])])])])},o=[],r=t("ded3"),n=t.n(r),l=(t("caad"),t("2532"),t("14d9"),t("a15b"),t("a9e3"),t("4de4"),t("d3b7"),t("aabb")),a=t("b5ae"),c=a.required,d={name:"NewTrip",validations:{trip:{fields:{date:{required:c},vehicle_id:{required:c},invoice_id:{required:c}}}},data:function(){return{trip:{fields:{date:null,vehicle_id:null,invoice_id:null}},vehicle:{fields:{type:null,brand:null,model:null}},driversOptions:[],destinysOptions:[],economicNumberOptions:[],driversOptionsFilter:[],destinysOptionsFilter:[],invoicesOptions:[],invoicesOptionsFilter:[]}},mounted:function(){this.$q.loading.show(),this.getEconomicNumber(),this.getInvoices(),this.$q.loading.hide()},computed:{invoiceRules:function(e){var i=this;return[function(e){return i.$v.trip.fields.invoice_id.required||"El campo Remision / Factura es requerido."}]},driverRules:function(e){var i=this;return[function(e){return i.$v.trip.fields.driver.required||"El campo Chofer es requerido."}]},destinyRules:function(e){var i=this;return[function(e){return i.$v.trip.fields.destiny.required||"El campo Destino es requerido."}]},dateRules:function(e){var i=this;return[function(e){return i.$v.trip.fields.date.required||"El campo Fecha es requerido."}]},vehicle_idRules:function(e){var i=this;return[function(e){return i.$v.trip.fields.vehicle_id.required||"El campo Número de unidad es requerido."}]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(8)||this.$router.push("/")},methods:{createTrip:function(){var e=this;if(this.$v.trip.fields.$reset(),this.$v.trip.fields.$touch(),this.$v.trip.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var i=n()({},this.trip.fields);i.date=this.trip.fields.date.split(" ")[0].split("/").reverse().join("-")+" "+this.trip.fields.date.split(" ")[1],l["a"].post("/trips",i).then((function(i){var t=i.data;e.$q.notify({message:t.message.content,position:"top",color:t.result?"positive":"warning"}),t.result?(e.$q.loading.hide(),e.$router.push("/trips/".concat(Number(t.id)))):e.$q.loading.hide()}))},getDrivers:function(){var e=this;l["a"].get("drivers/options").then((function(i){e.driversOptions=i.data.options}))},filterDrivers:function(e,i,t){var s=this;i((function(){var i=e.toLowerCase();s.driversOptionsFilter=s.driversOptions.filter((function(e){return e.label.toLowerCase().indexOf(i)>-1}))}))},getDestinys:function(){var e=this;l["a"].get("ranges/options").then((function(i){e.destinysOptions=i.data.options}))},filterDestinys:function(e,i,t){var s=this;i((function(){var i=e.toLowerCase();s.destinysOptionsFilter=s.destinysOptions.filter((function(e){return e.label.toLowerCase().indexOf(i)>-1}))}))},getEconomicNumber:function(){var e=this;l["a"].get("vehicle/options").then((function(i){e.economicNumberOptions=i.data.options}))},getVehicleData:function(){var e=this,i=this.trip.fields.vehicle_id;l["a"].get("vehicle/vehicle-data/".concat(i)).then((function(i){console.log(i),e.vehicle.fields=i.data.vehicle}))},getInvoices:function(){var e=this;l["a"].get("invoices/invoicesTripOptions").then((function(i){e.invoicesOptions=i.data.options}))},filterInvoices:function(e,i,t){var s=this;i((function(){var i=e.toLowerCase();s.invoicesOptionsFilter=s.invoicesOptions.filter((function(e){return e.label.toLowerCase().indexOf(i)>-1}))}))}}},u=d,p=t("2877"),f=t("9989"),v=t("ead5"),m=t("079e"),h=t("ddd8"),b=t("0016"),q=t("66e5"),g=t("4074"),y=t("7cbe"),$=t("52ee"),x=t("ca78"),_=t("27f9"),k=t("9c40"),C=t("eebe"),w=t.n(C),O=Object(p["a"])(u,s,o,!1,null,null,null);i["default"]=O.exports;w()(O,"components",{QPage:f["a"],QBreadcrumbs:v["a"],QBreadcrumbsEl:m["a"],QSelect:h["a"],QIcon:b["a"],QItem:q["a"],QItemSection:g["a"],QPopupProxy:y["a"],QDate:$["a"],QTime:x["a"],QInput:_["a"],QBtn:k["a"]})}}]);