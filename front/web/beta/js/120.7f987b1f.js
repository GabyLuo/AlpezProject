(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[120],{"49a1":function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e._self._c;return r("q-page",{staticClass:"bg-grey-3"},[r("div",{staticClass:"q-pa-sm panel-header"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-8"},[r("div",{staticClass:"q-pa-md q-gutter-sm"},[r("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[r("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),r("q-breadcrumbs-el",{attrs:{label:"Recepciones",to:"/raw-material-shipments"}}),r("q-breadcrumbs-el",{attrs:{label:"Nueva Recepción"}})],1)],1)])])]),r("div",{staticClass:"q-pa-md bg-grey-3"},[r("div",{staticClass:"row bg-white border-panel"},[r("div",{staticClass:"col q-pa-md"},[r("div",{staticClass:"row q-col-gutter-xs"},[r("div",{staticClass:"col-xs-12 col-sm-4"},[r("q-select",{attrs:{color:"white","bg-color":"amber-6",filled:"",dark:"",error:e.$v.rawMaterialShipment.fields.supplier.$error,options:e.supplierOptions,label:"Proveedor",rules:e.supplierRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-building"}})]},proxy:!0}]),model:{value:e.rawMaterialShipment.fields.supplier,callback:function(r){e.$set(e.rawMaterialShipment.fields,"supplier",r)},expression:"rawMaterialShipment.fields.supplier"}})],1),r("div",{staticClass:"col-xs-12 col-sm-4"},[r("q-select",{attrs:{color:"white","bg-color":"amber-6",filled:"",dark:"",error:e.$v.rawMaterialShipment.fields.branchOffice.$error,options:e.branchOfficeOptions,label:"Sucursal",rules:e.branchOfficeRules},on:{input:e.branchOfficeChanged},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-store-alt"}})]},proxy:!0}]),model:{value:e.rawMaterialShipment.fields.branchOffice,callback:function(r){e.$set(e.rawMaterialShipment.fields,"branchOffice",r)},expression:"rawMaterialShipment.fields.branchOffice"}})],1),r("div",{staticClass:"col-xs-12 col-sm-4"},[r("q-select",{attrs:{color:"white","bg-color":"amber-6",filled:"",dark:"",error:e.$v.rawMaterialShipment.fields.storage.$error,options:e.storageOptions,label:"Almacén",rules:e.storageRules,disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-warehouse"}})]},proxy:!0}]),model:{value:e.rawMaterialShipment.fields.storage,callback:function(r){e.$set(e.rawMaterialShipment.fields,"storage",r)},expression:"rawMaterialShipment.fields.storage"}})],1)]),r("div",{staticClass:"row q-mb-sm"},[r("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[r("q-btn",{attrs:{color:"positive",icon:"save",label:"Guardar"},on:{click:function(r){return e.createShipment()}}})],1)])])])])])},i=[],s=a("ded3"),n=a.n(s),l=(a("14d9"),a("4de4"),a("d3b7"),a("a9e3"),a("aabb")),o=a("b5ae"),c=o.required,u={name:"NewRawMaterialShipment",validations:{rawMaterialShipment:{fields:{supplier:{required:c},branchOffice:{required:c},storage:{required:c}}}},data:function(){return{rawMaterialShipment:{fields:{supplier:null,branchOffice:null,storage:null}},supplierOptions:[],branchOfficeOptions:[],storageOptions:[]}},computed:{supplierRules:function(e){var r=this;return[function(e){return r.$v.rawMaterialShipment.fields.supplier.required||"El campo Proveedor es requerido."}]},branchOfficeRules:function(e){var r=this;return[function(e){return r.$v.rawMaterialShipment.fields.branchOffice.required||"El campo Sucursal es requerido."}]},storageRules:function(e){var r=this;return[function(e){return r.$v.rawMaterialShipment.fields.storage.required||"El campo Almacén es requerido."}]}},beforeRouteEnter:function(e,r,a){a((function(e){var r=e.$store.getters["users/rol"];console.log(r),1===r||3===r||7===r||2===r||20===r||4===r||27===r||22===r?a():a("/")}))},created:function(){this.fetchFromServer()},methods:{fetchFromServer:function(){var e=this;this.$q.loading.show(),l["a"].get("/suppliers/options").then((function(r){var a=r.data;e.supplierOptions=a.options,l["a"].get("/branch-offices/options").then((function(r){var a=r.data;e.branchOfficeOptions=a.options,l["a"].get("/storages/options").then((function(r){var a=r.data;e.storageOptions=a.options,e.$q.loading.hide()}))}))}))},backToGrid:function(){this.$router.push("/raw-material-shipments")},branchOfficeChanged:function(){var e=this;this.rawMaterialShipment.fields.storage=null,null!=this.rawMaterialShipment.fields.branchOffice&&null!=this.rawMaterialShipment.fields.branchOffice.value&&(this.rawMaterialShipment.fields.storage=this.storageOptions.filter((function(r){return Number(e.rawMaterialShipment.fields.branchOffice.value)===Number(r.branchOffice)&&9===Number(r.storageType)}))[0])},createShipment:function(){var e=this;if(this.$v.rawMaterialShipment.fields.$reset(),this.$v.rawMaterialShipment.fields.$touch(),this.$v.rawMaterialShipment.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var r=[];r.supplierId=Number(n()({},this.rawMaterialShipment.fields.supplier).value),r.branchOfficeId=Number(n()({},this.rawMaterialShipment.fields.branchOffice).value),l["a"].post("/raw-material-shipments",r).then((function(r){var a=r.data;e.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning"}),a.result?(e.$q.loading.hide(),e.$router.push("/raw-material-shipments/".concat(a.shipment.id))):e.$q.loading.hide()}))}}},p=u,f=a("2877"),d=a("9989"),h=a("9c40"),m=a("ead5"),b=a("079e"),v=a("ddd8"),w=a("0016"),g=a("eebe"),S=a.n(g),q=Object(f["a"])(p,t,i,!1,null,null,null);r["default"]=q.exports;S()(q,"components",{QPage:d["a"],QBtn:h["a"],QBreadcrumbs:m["a"],QBreadcrumbsEl:b["a"],QSelect:v["a"],QIcon:w["a"]})}}]);