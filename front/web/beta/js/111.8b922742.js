(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[111],{f315:function(e,t,r){"use strict";r.r(t);r("ac1f"),r("5319"),r("a9e3"),r("c35a"),r("b0c0");var o=function(){var e=this,t=this,r=t._self._c;return r("q-page",{staticClass:"bg-grey-3"},[r("div",{staticClass:"q-pa-sm panel-header"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-8 col-md-8 row"},[r("div",{staticClass:"q-pa-md q-gutter-sm"},[r("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"right"}},[r("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),r("q-breadcrumbs-el",{attrs:{label:"Ordenes de compra",to:"/purchase-orders"}}),r("q-breadcrumbs-el",{attrs:{label:this.order.fields.serial+""}})],1)],1)]),t.details.length>0?r("div",{staticClass:"q-pa-md q-gutter-sm col-xs-12 col-sm-4 pull-right"},["NUEVO"!==t.order.fields.status&&"RECIBIDO"!==t.order.fields.status&&"PEDIDO"!==t.order.fields.status||1!==t.roleId&&22!==t.roleId&&26!==t.roleId?t._e():r("q-btn",{staticStyle:{"margin-left":"8px"},attrs:{color:"blue",icon:"fas fa-file-pdf"},on:{click:function(e){return t.confirmSendPDFQuote()}}},[r("q-tooltip",{attrs:{"content-class":"bg-blue"}},[t._v("PDF cotización")])],1),"PARCIAL"===t.order.fields.status||"RECIBIDO"===t.order.fields.status||"PEDIDO"===t.order.fields.status?r("q-btn",{staticClass:"bg-red",staticStyle:{"margin-left":"10px"},attrs:{color:"white",icon:"fas fa-file-pdf"},on:{click:function(e){return t.generatePurchaseOrderPdf()}}},[r("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("Imprimir OC")])],1):t._e(),"PEDIDO"!==t.order.fields.status||1!==t.roleId&&22!==t.roleId&&26!==t.roleId?t._e():r("q-btn",{staticStyle:{"margin-left":"8px"},attrs:{color:"purple",icon:"mail"},on:{click:function(e){return t.confirmSendPDF()}}},[r("q-tooltip",{attrs:{"content-class":"bg-positive"}},[t._v("Enviar email")])],1),"NUEVO"==t.order.fields.status?r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"warning",icon:"assignment",label:"Cotizado"},on:{click:function(e){return t.changeStatus("COTIZADO")}}}):t._e(),"COTIZADO"!=t.order.fields.status||26!==t.$store.getters["users/rol"]&&1!==t.$store.getters["users/rol"]&&3!==t.$store.getters["users/rol"]&&22!==t.$store.getters["users/rol"]?t._e():r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"orange",icon:"assignment",label:"Enviar OC"},on:{click:function(e){return t.changeStatus("PEDIDO")}}}),1!==t.$store.getters["users/rol"]&&11!==t.$store.getters["users/rol"]&&22!==t.$store.getters["users/rol"]||"SOLICITADO"!=t.order.fields.status?t._e():r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"light-green",icon:"assignment_turned_in",label:"Aprobar"},on:{click:function(e){return t.approvePurchaseOrder()}}}),1!==t.$store.getters["users/rol"]&&10!==t.$store.getters["users/rol"]&&19!==t.$store.getters["users/rol"]||"APROBADO"!=t.order.fields.status?t._e():r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"done",label:"Cerrar"},on:{click:function(e){return t.closePurchaseOrder()}}}),"CANCELADO"==t.order.fields.status&&1===t.$store.getters["users/rol"]?r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"clear",label:"Restaurar"},on:{click:function(e){return t.openPurchaseOrder()}}}):t._e()],1):r("div",{staticClass:"q-pa-md q-gutter-sm col-xs-4 pull-right"},["CANCELADO"==t.order.fields.status&&1===t.$store.getters["users/rol"]?r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"clear",label:"Restaurar"},on:{click:function(e){return t.openPurchaseOrder()}}}):t._e()],1)])]),r("div",{staticClass:"q-pa-md bg-grey-3"},[r("div",{staticClass:"row bg-white border-panel"},[r("div",{staticClass:"col q-pa-md"},[r("div",{staticClass:"row q-col-gutter-xs"},[r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Folio"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"code"}})]},proxy:!0}]),model:{value:t.order.fields.serial,callback:function(e){t.$set(t.order.fields,"serial",e)},expression:"order.fields.serial"}})],1),r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:t.filteredSupplierOptions,label:"Proveedor",error:t.$v.order.fields.supplier.$error,rules:t.supplierRules,disable:"APROBADO"==t.order.fields.status||"CERRADO"==t.order.fields.status||"CANCELADO"==t.order.fields.status,"emit-value":"","map-options":""},on:{filter:t.filterSupplier},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-building"}})]},proxy:!0}]),model:{value:t.supplier_id,callback:function(e){t.supplier_id=e},expression:"supplier_id"}})],1),r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha de arribo",rules:t.requestedDateRules,disable:"APROBADO"==t.order.fields.status||"CERRADO"==t.order.fields.status||"CANCELADO"==t.order.fields.status},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:t.order.fields.requested_date,callback:function(e){t.$set(t.order.fields,"requested_date",e)},expression:"order.fields.requested_date"}},[r("q-popup-proxy",{ref:"orderFieldsRequestedDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{local:t.myLocale,mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return t.$refs.orderFieldsRequestedDateRef.hide()}},model:{value:t.order.fields.requested_date,callback:function(e){t.$set(t.order.fields,"requested_date",e)},expression:"order.fields.requested_date"}})],1)])],1)],1),r("div",{staticClass:"col-xs-12 col-md-2 text-center"},[r("q-input",{attrs:{color:"white","bg-color":t.statusColors[t.order.fields.status],filled:"",dark:"",disable:"",error:t.$v.order.fields.status.$error,label:"Estatus",rules:t.statusRules},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"dvr"}})]},proxy:!0}]),model:{value:t.order.fields.status,callback:function(e){t.$set(t.order.fields,"status",e)},expression:"order.fields.status"}})],1),t.isPedido?r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha de embarque"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}],null,!1,3703588864),model:{value:t.order.fields.embargo_date,callback:function(e){t.$set(t.order.fields,"embargo_date",e)},expression:"order.fields.embargo_date"}},[r("q-popup-proxy",{ref:"orderFieldsEmbargoDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{locale:t.myLocale,mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return t.$refs.orderFieldsEmbargoDateRef.hide()}},model:{value:t.order.fields.embargo_date,callback:function(e){t.$set(t.order.fields,"embargo_date",e)},expression:"order.fields.embargo_date"}})],1)])],1)],1):t._e(),t.isPedido?r("div",{staticClass:"col-xs-12 col-md-2 text-center"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.order.fields.shipping_price.$error,label:"Costo de envio",rules:t.shippingRules,type:"text"},on:{blur:function(e){return t.updateDateInvoices()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}],null,!1,2568092296),model:{value:t.order.fields.shipping_price,callback:function(e){t.$set(t.order.fields,"shipping_price",e)},expression:"order.fields.shipping_price"}})],1):t._e(),r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Subtotal"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}]),model:{value:t.subtotal_price,callback:function(e){t.subtotal_price=e},expression:"subtotal_price"}})],1),r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"IVA"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}]),model:{value:t.vat_price,callback:function(e){t.vat_price=e},expression:"vat_price"}})],1),r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Neto (MXN)"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}]),model:{value:t.neto_price,callback:function(e){t.neto_price=e},expression:"neto_price"}})],1),"NUEVO"!=t.order.fields.status&&"COTIZADO"!=t.order.fields.status?r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha de Pedido"},on:{input:function(){return e.$v.orer.fields.order_date.$touch()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}],null,!1,3703588864),model:{value:t.order.fields.order_date,callback:function(e){t.$set(t.order.fields,"order_date",e)},expression:"order.fields.order_date"}},[r("q-popup-proxy",{ref:"orderFieldsOrderDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{local:t.myLocale,mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return t.$refs.orderFieldsOrderDateRef.hide()}},model:{value:t.order.fields.order_date,callback:function(e){t.$set(t.order.fields,"order_date",e)},expression:"order.fields.order_date"}})],1)])],1)],1):t._e(),r("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[r("q-select",{attrs:{color:"dark",disable:"","bg-color":"secondary",filled:"",options:t.branchesList,label:"Sucursal Entrada"},on:{input:function(){return t.order.fields.storage=""}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"business"}})]},proxy:!0}]),model:{value:t.order.fields.branch_id,callback:function(e){t.$set(t.order.fields,"branch_id",e)},expression:"order.fields.branch_id"}})],1),"PEDIDO"===t.order.fields.status||"RECIBIDO"===t.order.fields.status?r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha de factura"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}],null,!1,3703588864),model:{value:t.order.fields.date_invoicee,callback:function(e){t.$set(t.order.fields,"date_invoicee",e)},expression:"order.fields.date_invoicee"}},[r("q-popup-proxy",{ref:"mydadeInvoice",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{mask:"DD/MM/YYYY","today-btn":""},on:{input:function(e){return t.updateDateInvoices()}},model:{value:t.order.fields.date_invoicee,callback:function(e){t.$set(t.order.fields,"date_invoicee",e)},expression:"order.fields.date_invoicee"}})],1)])],1)],1):t._e(),r("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[r("q-select",{attrs:{disable:"",color:"dark","bg-color":"secondary",filled:"",options:t.filteredStorageOptions,label:"Almacén Entrada"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"store"}})]},proxy:!0}]),model:{value:t.order.fields.storage,callback:function(e){t.$set(t.order.fields,"storage",e)},expression:"order.fields.storage"}})],1),r("div",{staticClass:"col-xs-12 col-md-2"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"# Referencia"},on:{blur:function(e){return t.updateDateInvoices()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-file-invoice-dollar"}})]},proxy:!0}]),model:{value:t.order.fields.reference,callback:function(e){t.$set(t.order.fields,"reference",e)},expression:"order.fields.reference"}})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-6 pull-left"},["APROBADO"!=t.order.fields.status||1!==t.$store.getters["users/rol"]&&2!==t.$store.getters["users/rol"]&&5!==t.$store.getters["users/rol"]&&10!==t.$store.getters["users/rol"]&&19!==t.$store.getters["users/rol"]?t._e():r("q-btn",{staticStyle:{margin:"5px"},attrs:{color:"positive",icon:"fas fa-file-pdf",label:"Imprimir OC"},on:{click:function(e){return t.generatePurchaseOrderPdf()}}}),"APROBADO"!=t.order.fields.status||1!==t.$store.getters["users/rol"]&&2!==t.$store.getters["users/rol"]&&5!==t.$store.getters["users/rol"]&&10!==t.$store.getters["users/rol"]&&19!==t.$store.getters["users/rol"]?t._e():r("q-btn",{staticStyle:{margin:"5px"},attrs:{loading:t.loadingSendingMailBtn,color:"primary",icon:"mail",label:"Enviar a proveedor"},on:{click:function(e){return t.sendPurchaseOrderPdfToSupplier()}},scopedSlots:t._u([{key:"loading",fn:function(){return[r("q-spinner",{staticClass:"on-left"}),t._v("\n                Enviando correo...\n              ")]},proxy:!0}],null,!1,576762722)})],1),r("div",{staticClass:"col-xs-6 pull-right"},["NUEVO"==t.order.fields.status||"PEDIDO"==t.order.fields.status||"COTIZADO"==t.order.fields.status?r("q-btn",{staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(e){return t.updateOrder()}}}):t._e()],1)])])]),r("br"),r("div",{staticClass:"bg-white border-panel"},[r("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[r("q-tab",{attrs:{name:"details",icon:"fas fa-cubes",label:"Detalles"}}),"PEDIDO"===t.order.fields.status||"RECIBIDO"===t.order.fields.status||"PARCIAL"===t.order.fields.status?r("q-tab",{attrs:{name:"shipments",icon:"fas fa-cart-plus",label:"Recepciones"}}):t._e(),"NUEVO"!=t.order.fields.status&&"SOLICITADO"!=t.order.fields.status?r("q-tab",{attrs:{name:"documents",icon:"fas fa-file",label:"Documentos"}}):t._e(),r("q-tab",{attrs:{name:"history",icon:"fas fa-edit",label:"Historial"}})],1),r("q-separator"),r("q-tab-panels",{attrs:{animated:""},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[r("q-tab-panel",{attrs:{name:"details"}},[1===!t.$store.getters["users/rol"]&5===!t.$store.getters["users/rol"]&&21===!t.$store.getters["users/rol"]&&22===!t.$store.getters["users/rol"]&&2===!t.$store.getters["users/rol"]&&26===!t.$store.getters["users/rol"]&&28===!t.$store.getters["users/rol"]?r("div",{staticStyle:{"font-weight":"normal"}},[r("div",{staticClass:"q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("q-table",{attrs:{flat:"",bordered:"",data:t.details,columns:t.detailsColumnsStore,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"product",staticStyle:{"text-align":"left",width:"50%"},attrs:{props:e}},[t._v(t._s(e.row.product))]),r("q-td",{key:"qty",staticStyle:{"text-align":"left",width:"15%"},attrs:{props:e}},[t._v(t._s(t.formatPrice(e.row.qty))+" KG.")]),r("q-td",{key:"color",staticStyle:{"text-align":"left",width:"20%"},attrs:{props:e}},[t._v(t._s(e.row.color))]),r("q-td",{key:"quality",staticStyle:{width:"15%"},attrs:{props:e}},[t._v(t._s(e.row.quality))])],1)]}}],null,!1,1710444294)})],1)]):r("div",{staticStyle:{"font-weight":"normal"}},["APROBADO"!=t.order.fields.status&&"CERRADO"!=t.order.fields.status&&"CANCELADO"!=t.order.fields.status?r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{"padding-right":"2%"}},[r("div",{staticClass:"col-sm-12 col-md-4 offset-md-8 pull-right"},[r("q-btn",{directives:[{name:"show",rawName:"v-show",value:null!=t.detailIdToEdit,expression:"detailIdToEdit != null"}],staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(e){return t.updateDetail()}}}),r("q-btn",{directives:[{name:"show",rawName:"v-show",value:null!=t.detailIdToEdit,expression:"detailIdToEdit != null"}],staticStyle:{"margin-left":"5px"},attrs:{color:"negative",icon:"cancel",label:"Cancelar"},on:{click:function(e){return t.cancelEditDetail()}}}),r("q-btn",{directives:[{name:"show",rawName:"v-show",value:null==t.detailIdToEdit&&("NUEVO"===t.order.fields.status||"COTIZADO"===t.order.fields.status||"PEDIDO"===t.order.fields.status||"PARCIAL"===t.order.fields.status),expression:"detailIdToEdit == null && (order.fields.status === 'NUEVO' || order.fields.status === 'COTIZADO' || order.fields.status === 'PEDIDO' || order.fields.status === 'PARCIAL')"}],staticStyle:{"margin-left":"5px"},attrs:{color:"positive",icon:"add",label:"Agregar"},on:{click:function(e){return t.addDetail()}}})],1)]):t._e(),"APROBADO"!=t.order.fields.status&&"CERRADO"!=t.order.fields.status&&"CANCELADO"!=t.order.fields.status?r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("div",{staticClass:"col-sm-12 col-md-6"},[r("q-select",{ref:"detailFieldsProductRef",attrs:{color:"dark","bg-color":"secondary",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:t.filteredProductsOptions,label:"Producto",rules:t.productRules},on:{filter:t.filterProduct,input:function(e){return t.getLastPrice()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"emoji_objects"}})]},proxy:!0}],null,!1,2431477873),model:{value:t.detail.fields.product,callback:function(e){t.$set(t.detail.fields,"product",e)},expression:"detail.fields.product"}})],1),r("div",{staticClass:"col-sm-12 col-md-2"},[r("q-input",{ref:"detailFieldsQtyRef",attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Ultimo precio",readonly:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}],null,!1,2568092296),model:{value:t.lastPriceProduct,callback:function(e){t.lastPriceProduct=e},expression:"lastPriceProduct"}})],1),r("div",{staticClass:"col-sm-12 col-md-2"},[r("q-input",{ref:"detailFieldsQtyRef",attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.detail.fields.qty.$error,label:"Cantidad",rules:t.qtyRules,min:"1"},on:{input:function(e){t.detail.fields.qty=e.replace(/[^0-9\\.]/g,"")}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-hashtag"}})]},proxy:!0}],null,!1,3118026066),model:{value:t.detail.fields.qty,callback:function(e){t.$set(t.detail.fields,"qty",e)},expression:"detail.fields.qty"}})],1),r("div",{staticClass:"col-sm-12 col-md-2"},[r("q-select",{attrs:{label:"IVA",color:"dark","bg-color":"secondary",filled:"",options:[{label:"0%",value:0},{label:"8%",value:8},{label:"16%",value:16}],"map-options":"","emit-value":""},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-percentage"}})]},proxy:!0}],null,!1,2294609098),model:{value:t.vat_rate,callback:function(e){t.vat_rate=e},expression:"vat_rate"}})],1),r("div",{staticClass:"col-sm-12 col-md-2"},[r("q-input",{ref:"detailFieldsQtyRef",attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.detail.fields.price.$error,label:"Precio unitario",rules:t.priceRules,type:"text"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"attach_money"}})]},proxy:!0}],null,!1,2568092296),model:{value:t.detail.fields.price,callback:function(e){t.$set(t.detail.fields,"price",e)},expression:"detail.fields.price"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 text-center"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Observaciones",type:"text"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-eye"}})]},proxy:!0}],null,!1,1414978091),model:{value:t.detail.fields.observation,callback:function(e){t.$set(t.detail.fields,"observation",e)},expression:"detail.fields.observation"}})],1)]):t._e(),r("div",{staticClass:"q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("q-table",{attrs:{flat:"",bordered:"",data:t.details,columns:t.detailsColumns,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"product",staticStyle:{"text-align":"left",width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.product))]),r("q-td",{key:"qty",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s(t.$formatNumberThree(e.row.qty)))]),r("q-td",{key:"price",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s("".concat(t.currencyFormatter.format(e.row.price))))]),r("q-td",{key:"subtotal",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s("".concat(t.currencyFormatter.format(e.row.price*e.row.qty))))]),r("q-td",{key:"vat",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s("".concat(t.currencyFormatter.format(e.row.vat))))]),r("q-td",{key:"totalPrice",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s("".concat(t.currencyFormatter.format(Number(e.row.price)*Number(e.row.qty)+Number.parseFloat(e.row.vat)))))]),r("q-td",{key:"entrada",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s(t.$formatNumberThree(e.row.entrada)))]),r("q-td",{key:"restante",staticStyle:{"text-align":"right",width:"5%"},attrs:{props:e}},[t._v(t._s(t.$formatNumberThree(e.row.restante)))]),r("q-td",{key:"observation",staticStyle:{"text-align":"left",width:"35%"},attrs:{props:e}},[t._v(t._s(e.row.observation))]),"APROBADO"!=t.order.fields.status&&"CERRADO"!=t.order.fields.status&&"CANCELADO"!=t.order.fields.status?r("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:e}},[r("q-btn",{attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(r){return t.editDetail(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Editar")])],1),t.isPedido?t._e():r("q-btn",{attrs:{color:"negative",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(r){return t.removeDetail(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("Eliminar")])],1)],1):r("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:e}},[t._v("\n                      -\n                    ")])],1)]}}])})],1)])]),"NUEVO"!=t.order.fields.status&&"SOLICITADO"!=t.order.fields.status?r("q-tab-panel",{attrs:{name:"shipments"}},[r("div",{staticStyle:{"font-weight":"normal"}},[1===t.roleId||22===t.roleId||3===t.roleId||4===t.roleId||28===t.roleId&&"CERRADO"!=t.order.fields.status&&"CANCELADO"!=t.order.fields.status&&t.canAddNewShipment&&"RECIBIDO"!=t.order.fields.status?r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{"padding-right":"2%","padding-bottom":"2%"}},[r("div",{staticClass:"col-xs-12 col-sm-12 col-md-2 offset-md-10 pull-right"},[r("q-btn",{attrs:{color:"blue",icon:"add",label:"NUEVO"},on:{click:function(e){return t.newShipment()}}})],1)]):t._e(),r("div",{staticClass:"q-col-gutter-xs",staticStyle:{"padding-right":"2%","padding-left":"2%","padding-bottom":"2%"}},[r("q-table",{attrs:{flat:"",bordered:"",data:t.shipments,columns:t.shipmentColumns,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"serial",staticStyle:{"text-align":"center",width:"10%"},attrs:{props:e}},[t._v(t._s(e.row.serial))]),r("q-td",{key:"receive_date",staticStyle:{width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.receive_date))]),r("q-td",{key:"status",staticStyle:{width:"30%"},attrs:{props:e}},[r("q-chip",{attrs:{square:"",dense:"",color:"NUEVO"==e.row.status?"secondary":"MUESTREADO"==e.row.status?"warning":"RECIBIDO"==e.row.status?"orange":"ANALIZADO"==e.row.status?"positive":"RECHAZADO"==e.row.status?"negative":"blue","text-color":"white"}},[t._v("\n                        "+t._s(e.row.status)+"\n                      ")])],1),"CERRADO"!=t.order.fields.status&&"CANCELADO"!=t.order.fields.status&&"RECIBIDO"!=e.row.status&&"RECHAZADO"!=e.row.status&&1===t.$store.getters["users/rol"]||3===t.$store.getters["users/rol"]||22===t.$store.getters["users/rol"]?r("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:e}},[r("q-btn",{attrs:{color:e.row.invoice?"positive":"negative",icon:"cloud_upload",flat:"",size:"10px"},nativeOn:{click:function(r){return t.openUploadShipmentInvoiceModal(e.row)}}},[r("q-tooltip",{attrs:{"content-class":e.row.invoice?"bg-positive":"bg-negative"}},[t._v("Subir archivo")])],1),e.row.invoice?r("q-btn",{attrs:{color:"primary",icon:"remove_red_eye",flat:"",size:"10px"},nativeOn:{click:function(r){return t.showShipmentInvoiceFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Ver factura")])],1):t._e(),e.row.invoice?r("q-btn",{attrs:{color:"primary",icon:"cloud_download",flat:"",size:"10px"},nativeOn:{click:function(r){return t.downloadShipmentInvoiceFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Descargar factura")])],1):t._e(),e.row.canExecute?r("q-btn",{attrs:{color:"positive",icon:"far fa-arrow-alt-circle-right",flat:"",size:"10px"},nativeOn:{click:function(r){return t.saveStorageEntry(e.row.id)}}}):t._e(),r("q-btn",{attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(r){return t.editShipment(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Editar")])],1),r("q-btn",{attrs:{color:"primary",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(r){return t.removeShipment(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("Eliminar")])],1)],1):r("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:e}},[r("q-btn",{attrs:{color:e.row.invoice?"positive":"negative",icon:"cloud_upload",flat:"",size:"10px"},nativeOn:{click:function(r){return t.openUploadShipmentInvoiceModal(e.row)}}},[r("q-tooltip",{attrs:{"content-class":e.row.invoice?"bg-positive":"bg-negative"}},[t._v("Subir factura")])],1),e.row.invoice?r("q-btn",{attrs:{color:"primary",icon:"remove_red_eye",flat:"",size:"10px"},nativeOn:{click:function(r){return t.showShipmentInvoiceFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Ver factura")])],1):t._e(),e.row.invoice?r("q-btn",{attrs:{color:"primary",icon:"cloud_download",flat:"",size:"10px"},nativeOn:{click:function(r){return t.downloadShipmentInvoiceFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Descargar factura")])],1):t._e(),"RECIBIDO"==e.row.status&&"APROBADO"==t.order.fields.status?r("q-btn",{attrs:{color:"primary",icon:"mail",flat:"",size:"10px"},nativeOn:{click:function(r){return t.sendShipmentPdfToSupplier(e.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Enviar ticket de entrada")])],1):t._e(),"RECIBIDO"==e.row.status?r("q-btn",{attrs:{color:"primary",icon:"fas fa-file-pdf",flat:"",size:"10px"},nativeOn:{click:function(r){return t.generateShipmentPdf(e.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Ver ticket de entrada")])],1):t._e(),1===t.$store.getters["users/rol"]||3===t.$store.getters["users/rol"]?r("q-btn",{attrs:{color:"primary",icon:"remove_red_eye",flat:"",size:"10px"},nativeOn:{click:function(r){return t.editShipment(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Ver detalles")])],1):t._e()],1)],1)]}}],null,!1,3567159559)})],1)])]):t._e(),"NUEVO"!=t.order.fields.status&&"SOLICITADO"!=t.order.fields.status?r("q-tab-panel",{attrs:{name:"documents"}},[r("div",{staticStyle:{"font-weight":"normal"}},[r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{"padding-right":"2%"}},[t.document.fields.id?r("div",{staticClass:"col-xs-12 col-md-4 offset-md-8 pull-right"},[r("q-btn",{staticStyle:{"margin-right":"5px"},attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(e){return t.updateDocument()}}}),r("q-btn",{staticStyle:{"margin-right":"5px"},attrs:{color:"negative",icon:"cancel",label:"Cancelar"},on:{click:function(e){return t.cancelDocument()}}})],1):r("div",{staticClass:"col-xs-12 col-md-2 offset-md-10 pull-right"},[r("q-btn",{attrs:{color:"positive",icon:"add",label:"Agregar"},on:{click:function(e){return t.addDocument()}}})],1)]),r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("div",{staticClass:"col-xs-12 col-md-4"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.document.fields.name.$error,label:"Nombre",rules:t.documentNameRules},on:{input:function(e){t.document.fields.name=e.toUpperCase()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-signature"}})]},proxy:!0}],null,!1,395819190),model:{value:t.document.fields.name,callback:function(e){t.$set(t.document.fields,"name",e)},expression:"document.fields.name"}})],1),r("div",{staticClass:"col-xs-12 col-md-8"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:t.$v.document.fields.observations.$error,label:"Observaciones",rules:t.documentObservationsRules},on:{input:function(e){t.document.fields.observations=e.toUpperCase()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"remove_red_eye"}})]},proxy:!0}],null,!1,746281056),model:{value:t.document.fields.observations,callback:function(e){t.$set(t.document.fields,"observations",e)},expression:"document.fields.observations"}})],1)]),r("div",{staticClass:"q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("q-table",{attrs:{flat:"",bordered:"",data:t.documents,columns:t.documentColumns,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"name",staticStyle:{"text-align":"left",width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.name))]),r("q-td",{key:"observations",staticStyle:{"text-align":"left",width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.observations))]),r("q-td",{key:"document_name",staticStyle:{"text-align":"left",width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.document_name))]),r("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:e}},[r("q-btn",{attrs:{color:e.row.document_name?"positive":"negative",icon:"cloud_upload",flat:"",size:"10px"},nativeOn:{click:function(r){return t.openUploadFileModal(e.row)}}},[r("q-tooltip",{attrs:{"content-class":e.row.document_name?"bg-positive":"bg-negative"}},[t._v("Subir archivo")])],1),e.row.document_name?r("q-btn",{attrs:{color:"primary",icon:"remove_red_eye",flat:"",size:"10px"},nativeOn:{click:function(r){return t.showDocumentFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Ver archivo")])],1):t._e(),e.row.document_name?r("q-btn",{attrs:{color:"positive",icon:"cloud_download",flat:"",size:"10px"},nativeOn:{click:function(r){return t.downloadDocumentFile(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-positive"}},[t._v("Descargar archivo")])],1):t._e(),r("q-btn",{attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(r){return t.editDocument(e.row)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Editar documento")])],1),r("q-btn",{attrs:{color:"negative",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(r){return t.removeDocument(e.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-negative"}},[t._v("Eliminar")])],1)],1)],1)]}}],null,!1,3928510960)})],1)])]):t._e(),r("q-tab-panel",{attrs:{name:"history"}},[r("div",{staticStyle:{"font-weight":"normal"}},[r("div",{staticClass:"row q-col-gutter-xs",staticStyle:{padding:"2%"}},[r("div",{staticClass:"col-xs-12 col-md-12"},[r("q-table",{attrs:{flat:"",bordered:"",data:t.history,columns:t.historyColumns,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"created",staticStyle:{"text-align":"center",width:"30%"},attrs:{props:e}},[t._v(t._s(e.row.created))]),r("q-td",{key:"status",staticStyle:{"text-align":"center",width:"30%"},attrs:{props:e}},[r("q-chip",{attrs:{square:"",dense:"",color:"NUEVO"==e.row.status?"blue":"COTIZADO"==e.row.status?"warning":"PEDIDO"==e.row.status?"orange":"RECEPCION"==e.row.status?"light-green":"RECIBIDO"==e.row.status?"green":"PARCIAL"==e.row.status?"red-4":"red-6","text-color":"white"}},[t._v("\n                            "+t._s(e.row.status)+"\n                          ")])],1)],1)]}}])})],1)])])])],1)],1)]),r("q-dialog",{attrs:{persistent:""},model:{value:t.shipmentInvoiceModal,callback:function(e){t.shipmentInvoiceModal=e},expression:"shipmentInvoiceModal"}},[r("q-card",[r("q-card-section",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-sm-10 text-h6"},[t._v("Factura: Recepción "+t._s(t.shipmentInvoice.fields.shipmentSerial))]),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col-xs-12 col-sm-2 pull-right",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),r("q-card-section",[r("q-uploader",{ref:"fileShipmentInvoiceRef",attrs:{url:t.fileShipmentInvoiceUrl,method:"POST","hide-upload-btn":""},on:{uploaded:t.afterUploadShipmentInvoiceFile}})],1),r("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[r("q-btn",{attrs:{flat:"",label:"Subir archivo"},on:{click:function(e){return t.uploadShipmentInvoiceFile()}}})],1)],1)],1),r("q-dialog",{attrs:{persistent:""},model:{value:t.documentFileModal,callback:function(e){t.documentFileModal=e},expression:"documentFileModal"}},[r("q-card",[r("q-card-section",{staticClass:"row bg-teal-7 text-white"},[r("div",{staticClass:"col-xs-12 col-sm-10 text-h6"},[t._v("Archivo: "+t._s(t.documentName))]),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col-xs-12 col-sm-2 pull-right",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),r("q-card-section",[r("q-uploader",{ref:"fileDocumentRef",attrs:{url:t.fileDocumentUrl,method:"POST","hide-upload-btn":"",headers:[{name:"Authorization",value:"Bearer "+this.JWT}]},on:{uploaded:t.afterUploadDocumentFile}})],1),r("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[r("q-btn",{attrs:{color:"positive",label:"Subir archivo"},on:{click:function(e){return t.uploadDocumentFile()}}})],1)],1)],1),r("q-dialog",{attrs:{persistent:""},model:{value:t.confirmModalPDF,callback:function(e){t.confirmModalPDF=e},expression:"confirmModalPDF"}},[r("q-card",{staticStyle:{width:"50%"}},[r("q-card-section",{staticClass:"bg-primary text-white"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-11 text-h6"},[t._v("CONFIRMACIÓN DE ENVIO")]),r("div",{staticClass:"col-sm-1 pull-right"},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"white",flat:"",round:"",dense:"",icon:"close"}})],1)])]),r("br"),r("q-card-section",{staticClass:"row items-center"},[r("label",{staticStyle:{"font-size":"23px"}},[t._v("¿Desea enviar el PDF del pedido al Proveedor?")])]),r("br"),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"negative"}}),r("q-btn",{attrs:{label:"Aceptar",color:"positive"},on:{click:function(e){return t.sendPDF()}}})],1)],1)],1)],1)},i=[],s=r("ded3"),a=r.n(s),n=r("7ec2"),l=r.n(n),d=r("c973"),c=r.n(d),u=(r("4de4"),r("d3b7"),r("159b"),r("14d9"),r("caad"),r("99af"),r("2532"),r("b680"),r("25f0"),r("a15b"),r("aabb")),p=r("b5ae"),f=p.required,m=p.requiredIf,h=p.decimal,v=p.maxLength,g={name:"EditPurchaseOrder",validations:{order:{fields:{status:{required:f,maxLength:v(10)},supplier:{required:f},producer:{maxLength:v(100)},requested_date:{required:f},shipping_price:{required:m((function(){return this.isPedido})),decimal:h},mxn_price:{decimal:h},storage:{},branche_id:{},reference:{}}},detail:{fields:{qty:{required:f,decimal:h},product:{required:f},price:{required:f,decimal:h}}},document:{fields:{name:{required:f,maxLength:v(100)},observations:{required:f,maxLength:v(100)}}},shipmentToEntry:{required:f}},data:function(){return{confirmModalPDF:!1,vat_rate:16,pageOC:1,ready:!1,history:null,statusColors:{NUEVO:"blue",COTIZADO:"warning",PEDIDO:"orange",RECEPCION:"light-green",RECIBIDO:"green",CANCELADO:"red-6",PARCIAL:"red-4"},formatter:new Intl.NumberFormat("en-US"),currencyFormatter:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),myLocale:{days:"Domingo_Lunes_Martes_Miércoles_Jueves_Viernes_Sábado".split("_"),daysShort:"Dom_Lun_Mar_Mié_Jue_Vie_Sáb".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1},current_currency:0,subtotal:0,vat_total:0,mxn_total:0,total:0,supplier_id:null,order:{fields:{id:null,serial:null,status:"NUEVO",supplier:null,producer:null,requested_date:null,order_date:null,proform:null,embargo_date:null,petition_number:null,shipping_price:null,tax_price:null,mxn_price:null,acc_currency_type_id:1,storage:null,branch_id:null,reference:null,date_invoicee:null}},detail:{fields:{id:null,qty:null,product:{value:null,label:"Seleccione el producto"},price:null,quality:{value:null,label:"Calidad"},color:{value:null,label:"Seleccione el color"},observation:null}},shipmentInvoice:{fields:{shipmentId:null,shipmentSerial:null}},document:{fields:{id:null,name:null,observations:null}},supplierOptions:[],productOptions:[],currencyOptions:[],branchesList:[],storageOptions:[],details:[],shipments:[],documents:[],detailsColumns:[{name:"product",align:"center",label:"PRODUCTO",field:"product",style:"width: 30%",sortable:!0},{name:"qty",align:"center",label:"CANT",field:"qty",style:"width: 5%",sortable:!0},{name:"price",align:"center",label:"UNITARIO",field:"price",style:"width: 5%",sortable:!0},{name:"subtotal",align:"center",label:"IMPORTE",field:"subtotal",style:"width: 5%",sortable:!0},{name:"vat",align:"center",label:"IVA",field:"vat",style:"width: 5%",sortable:!0},{name:"totalPrice",align:"center",label:"NETO",field:"totalPrice",style:"width: 5%",sortable:!0},{name:"entrada",align:"center",label:"ENTRADA",field:"entrada",style:"width: 5%",sortable:!0},{name:"restante",align:"center",label:"RESTANTES",field:"restante",style:"width: 5%",sortable:!0},{name:"observation",align:"center",label:"OBSERVACIONES",field:"observation",style:"width: 35%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],detailsColumnsStore:[{name:"product",align:"center",label:"PRODUCTO",field:"product",style:"width: 50%",sortable:!0},{name:"qty",align:"center",label:"KILOGRAMOS",field:"qty",style:"width: 15%",sortable:!0},{name:"color",align:"center",label:"COLOR",field:"color",style:"width: 20%",sortable:!0},{name:"quality",align:"center",label:"CALIDAD",field:"quality",style:"width: 15%",sortable:!0}],shipmentColumns:[{name:"serial",align:"center",label:"FOLIO",field:"serial",style:"width: 10%",sortable:!0},{name:"receive_date",align:"center",label:"FECHA DE RECEPCION",field:"receive_date",style:"width: 30%",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",style:"width: 30%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],documentColumns:[{name:"name",align:"center",label:"NOMBRE",field:"name",style:"width: 30%",sortable:!0},{name:"observations",align:"center",label:"OBSERVACIONES",field:"observations",style:"width: 30%",sortable:!0},{name:"document_name",align:"center",label:"NOMBRE DE ARCHIVO",field:"document_name",style:"width: 30%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],historyColumns:[{name:"created",align:"center",label:"FECHA Y HORA",field:"created",style:"width: 30%",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",style:"width: 30%",sortable:!0}],pagination:{rowsPerPage:50},detailIdToEdit:null,shipmentToEntry:null,qualityOptions:[{value:"A",label:"A"},{value:"B",label:"B"},{value:"C",label:"C"}],colorOptions:[{value:"BLANCO",label:"BLANCO"},{value:"MULTICOLOR",label:"MULTICOLOR"},{value:"VERDE",label:"VERDE"}],loadingSendingMailBtn:!1,documentFileModal:!1,shipmentInvoiceModal:!1,documentName:null,documentId:null,serverUrl:"http://api.alpez.beta.wasp.mx/",currentTab:"details",filteredSupplierOptions:[],filteredProductsOptions:[],lastPriceProduct:null}},computed:{roleId:function(){var e=this.$store.getters["users/rol"];return console.log("super roles"),console.log(e),parseInt(e)},JWT:function(){return localStorage.getItem("JWT")},isCotizado:function(){return"NUEVO"!==this.order.fields.status},isPedido:function(){return this.isCotizado&&"COTIZADO"!==this.order.fields.status},statusRules:function(e){var t=this;return[function(e){return t.$v.order.fields.status.required||"El campo Estatus es requerido."},function(e){return t.$v.order.fields.status.maxLength||"El campo Estatus no debe exceder los 10 dígitos."}]},supplierRules:function(e){var t=this;return[function(e){return t.$v.order.fields.supplier.required||"El campo Proveedor es requerido."}]},producerRules:function(e){var t=this;return[function(e){return t.$v.order.fields.producer.maxLength||"El campo Fabricante no debe exceder los 100 dígitos."}]},requestedDateRules:function(e){var t=this;return[function(e){return t.$v.order.fields.requested_date.required||"El campo Fecha de arribo es requerido."}]},proformRules:function(e){var t=this;return[function(e){return t.$v.order.fields.proform.required||"El campo Proforma es requerido."},function(e){return t.$v.order.fields.proform.integer||"El campo Proforma debe ser numérico."}]},petitionRules:function(e){var t=this;return[function(e){return t.$v.order.fields.petition_number.required||"El campo Pedimento es requerido."},function(e){return t.$v.order.fields.petition_number.integer||"El campo Pedimento debe ser numérico."}]},shippingRules:function(e){var t=this;return[function(e){return t.$v.order.fields.shipping_price.required||"El campo Costo de envio es requerido."},function(e){return t.$v.order.fields.shipping_price.decimal||"El campo Costo de envio debe ser numérico."}]},taxRules:function(e){var t=this;return[function(e){return t.$v.order.fields.tax_price.required||"El campo Impuestos es requerido."},function(e){return t.$v.order.fields.tax_price.decimal||"El campo Impuestos debe ser numérico."}]},mxnRules:function(e){var t=this;return[function(e){return t.$v.order.fields.mxn_price.required||"El campo Costo MXN es requerido."},function(e){return t.$v.order.fields.mxn_price.decimal||"El campo Costo MXN debe ser numérico."}]},productRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.product.required||"El campo Producto es requerido."}]},qtyRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.qty.required||"El campo Cantidad es requerido."},function(e){return t.$v.detail.fields.qty.decimal||"El campo Cantidad debe ser numérico."}]},priceRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.price.required||"El campo Precio unitario es requerido."},function(e){return t.$v.detail.fields.price.decimal||"El campo Precio unitario debe ser numérico."}]},qualityRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.quality.required||"El campo Calidad es requerido."}]},colorRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.color.required||"El campo Color es requerido."}]},documentNameRules:function(e){var t=this;return[function(e){return t.$v.document.fields.name.required||"El campo Nombre es requerido."},function(e){return t.$v.document.fields.name.maxLength||"El campo Nombre no debe exceder los 100 dígitos."}]},documentObservationsRules:function(e){var t=this;return[function(e){return t.$v.document.fields.observations.required||"El campo Observaciones es requerido."},function(e){return t.$v.document.fields.observations.maxLength||"El campo Observaciones no debe exceder los 100 dígitos."}]},filteredStorageOptions:function(){var e=this;return null!=this.order.fields.branch&&null!=this.order.fields.branch.value?this.storageList.filter((function(t){return t.branchOffice===e.order.fields.branch.value})):[]},filteredOriginStorageOptions:function(){var e=this;return null==this.order.fields.originBranchOffice||isNaN(this.order.fields.originBranchOffice)?[]:this.storageOptions.filter((function(t){return Number(t.branchOffice)===Number(e.order.fields.originBranchOffice)}))},filteredProductOptions:function(){var e=[],t=[];return this.details.forEach((function(e){t.push(e.product_id)})),this.productOptions.forEach((function(r){t.includes(r.value)||e.push(r)})),e},canAddNewShipment:function(){console.log("mis shippements"),console.log(this.shipments);var e=this.shipments.filter((function(e){return"NUEVO"===e.status||"ANALIZADO"===e.status}));return!(e.length>0)},fileDocumentUrl:function(){return"".concat("http://api.alpez.beta.wasp.mx/","purchase-order-documents/file/").concat(this.documentId)},fileShipmentInvoiceUrl:function(){return"".concat("http://api.alpez.beta.wasp.mx/","shipments/invoice-file/").concat(this.shipmentInvoice.fields.shipmentId)},subtotal_price:function(){return this.currencyFormatter.format(this.subtotal)},vat_price:function(){return this.currencyFormatter.format(this.vat_total)},neto_price:function(){return this.currencyFormatter.format(this.mxn_total)}},beforeRouteEnter:function(e,t,r){r((function(e){var t=e.$store.getters["users/rol"];console.log(t),1===t||3===t||7===t||2===t||20===t||4===t||27===t||20===t||22===t|28===t?r():r("/")}))},created:function(){this.$store.getters["users/roles"].includes(2)||(this.fetchFromServer(),this.getBranchesList(),this.getStoragesList())},watch:{order:function(e){console.log(e)}},methods:{updateDateInvoices:function(){var e=this;return c()(l()().mark((function t(){var r;return l()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={},r.date_invoicee=null!==e.order.fields.date_invoicee?e.$formatDate(e.order.fields.date_invoicee):null,r.shipping_price=e.order.fields.shipping_price,r.reference=e.order.fields.reference,e.$q.loading.show(),t.next=7,u["a"].put("/purchase-orders/updateDateInvoices/".concat(e.$route.params.id),r).then((function(t){var r=t.data;e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result&&e.fetchFromServer()}));case 7:e.$q.loading.hide();case 8:case"end":return t.stop()}}),t)})))()},confirmSendPDFQuote:function(){var e="http://api.alpez.beta.wasp.mx/"+"purchase-order-details/getPdfquotationNote/".concat(this.$route.params.id);window.open(e,"_blank")},getLastPrice:function(){var e=this,t=this.supplier_id.value,r=this.detail.fields.product.value;u["a"].get("/purchase-order-details/getLastPrice/".concat(t,"/").concat(r)).then((function(t){var r=t.data;r.result&&(e.lastPriceProduct=r.lastprice)}))},sendPDF:function(){var e=this;this.$q.loading.show();var t=Number(this.$route.params.id);u["a"].post("/purchase-orders/sendEmail/".concat(t)).then((function(t){var r=t.data;r.result,e.$q.loading.hide(),e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),e.confirmModalPDF=!1}))},confirmSendPDF:function(){this.confirmModalPDF=!0},generatePDF:function(){var e="http://api.alpez.beta.wasp.mx/purchase-orders/getPdf";window.open(e,"_blank")},formatPrice:function(e){var t=(e/1).toFixed(1).replace(".",",");return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},fetchFromServer:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;u["a"].get("/suppliers/options").then((function(r){var o=r.data;e.supplierOptions=o.options,u["a"].get("/purchase-orders/".concat(t)).then((function(r){var o=r.data;console.log("data"),console.log(o),o.order?(e.order.fields=o.order,e.order.fields.branch_id={value:o.order.id_branch,label:o.order.name_branch},e.order.fields.storage={value:o.order.storage,label:o.order.name_storage},e.history=o.history,e.ready=o.ready,e.supplier_id={value:o.order.supplier_id,label:o.order.po},e.order.fields.acc_currency_type_id=1,e.order.fields.supplier=e.supplierOptions.filter((function(t){return t.value===e.order.fields.supplier_id}))[0],u["a"].get("/products/options/category/0").then((function(r){var o=r.data;e.productOptions=o.options,u["a"].get("/purchase-order-details/order/".concat(t)).then((function(r){var o=r.data;console.log(o),e.details=o.orderDetails,e.subtotal=o.total_order,e.vat_total=o.total_vat,e.mxn_total=o.total_neto,u["a"].get("/purchase-order-documents/purchase-order/".concat(t)).then((function(r){var o=r.data;e.documents=o.documents,u["a"].get("/shipments/order/".concat(t)).then((function(t){var r=t.data;e.shipments=r.shipments,console.log("can ejecutar"),console.log(e.shipments),u["a"].get("/currencies/options").then((function(t){var r=t.data;e.currencyOptions=r.options,e.getExchange(),e.$q.loading.hide()}))}))}))}))}))):e.$router.push("/purchase-orders")}))}))},backToGrid:function(){this.$router.push("/purchase-orders")},generatePurchaseOrderPdf:function(){var e="http://api.alpez.beta.wasp.mx/"+"purchase-orders/pdf/".concat(this.order.fields.id);window.open(e,"_blank")},sendPurchaseOrderPdfToSupplier:function(){var e=this;this.loadingSendingMailBtn=!0,u["a"].get("/purchase-orders/".concat(this.order.fields.id,"/send-mail")).then((function(t){var r=t.data;e.$q.notify({message:r.message,position:"top",color:r.result?"positive":"warning"}),e.loadingSendingMailBtn=!1}))},requestPurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/request/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},approvePurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/approve/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},closePurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/close/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},reOpenPurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/re-open/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},cancelPurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/cancel/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},openPurchaseOrder:function(){var e=this;this.$q.loading.show();var t=[];t.id=this.order.fields.id,u["a"].put("/purchase-orders/open/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.history=r.history,e.ready=r.ready,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},invertDate:function(e){if(null!==e)var t=e.split("/").reverse().join("-");return t},updateOrder:function(){var e=this;if(this.$v.order.fields.$reset(),this.$v.order.fields.$touch(),this.$v.order.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.order.fields);t.supplier_id=Number(this.supplier_id),t.embargo_date=this.invertDate(this.order.fields.embargo_date),t.requested_date=this.invertDate(this.order.fields.requested_date),t.order_date=this.invertDate(this.order.fields.order_date),t.date_invoicee=this.$formatDate(this.order.fields.date_invoicee),console.log(t),u["a"].put("/purchase-orders/".concat(t.id),t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=e.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(t){var r=t.data;e.order.fields=r.order,e.order.fields.branch_id={value:r.order.id_branch,label:r.order.name_branch},e.order.fields.storage={value:r.order.storage,label:r.order.name_storage},e.history=r.history,e.order.fields.supplier=e.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],e.$q.loading.hide()}))}else e.$q.loading.hide()}))},updateDetail:function(){var e=this;if(this.$v.detail.fields.$reset(),this.$v.detail.fields.$touch(),this.$v.detail.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.detail.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione un producto.",persistent:!0}),!1;if(this.detail.fields.qty<=0)return this.$q.dialog({title:"Error",message:"Por favor, ingrese una cantidad válida.",persistent:!0}),!1;if(null==this.detail.fields.price||null==this.detail.fields.price)return this.$q.dialog({title:"Error",message:"Por favor, ingrese un precio válido.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.detail.fields);t.product_id=Number(t.product.value),t.vat_rate=Number(this.vat_rate),u["a"].put("/purchase-order-details/".concat(this.detailIdToEdit),t).then((function(t){var r=t.data;if(e.$v.detail.fields.$reset(),e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){e.cancelEditDetail();var o=e.$route.params.id;u["a"].get("/purchase-order-details/order/".concat(o)).then((function(t){var r=t.data;e.details=r.orderDetails,e.subtotal=r.total_order,e.vat_total=r.total_vat,e.mxn_total=r.total_neto,e.$q.loading.hide()}))}else e.$q.loading.hide()}))},cancelEditDetail:function(){this.detailIdToEdit=null,this.detail.fields.product=null,this.detail.fields.qty=null,this.detail.fields.price=null,this.detail.fields.quality=null,this.detail.fields.color=null,this.detail.fields.observation=null,this.lastPriceProduct=null},addDetail:function(){var e=this;if(this.$v.detail.fields.$reset(),this.$v.detail.fields.$touch(),this.$v.detail.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.detail.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione un producto.",persistent:!0}),!1;if(this.detail.fields.qty<=0)return this.$q.dialog({title:"Error",message:"Por favor, ingrese una cantidad válida.",persistent:!0}),!1;if(null==this.detail.fields.price||null==this.detail.fields.price)return this.$q.dialog({title:"Error",message:"Por favor, ingrese un precio válido.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.detail.fields);t.po_id=Number(this.order.fields.id),t.product_id=Number(t.product.value),t.vat_rate=Number(this.vat_rate),t.last_price=this.lastPriceProduct,console.log("params"),console.log(t),u["a"].post("/purchase-order-details",t).then((function(t){var r=t.data;if(e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){e.cancelEditDetail(),e.$v.detail.fields.$reset();var o=e.$route.params.id;u["a"].get("/purchase-order-details/order/".concat(o)).then((function(t){var r=t.data;e.details=r.orderDetails,e.subtotal=r.total_order,e.vat_total=r.total_vat,e.mxn_total=r.total_neto,e.$q.loading.hide()}))}else e.$q.loading.hide()}))},editDetail:function(e){console.log(e),this.vat_rate=e.vat_rate,this.detailIdToEdit=e.id,this.detail.fields.product={value:e.product_id,label:e.product},this.detail.fields.qty=e.qty,this.detail.fields.price=e.price,this.detail.fields.quality={value:e.quality,label:e.quality},this.detail.fields.color={value:e.color,label:e.color},this.detail.fields.observation=e.observation,this.lastPriceProduct=e.last_price},removeDetail:function(e){var t=this;this.$q.loading.show(),u["a"].delete("/purchase-order-details/".concat(e.id)).then((function(e){var r=e.data;if(t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=t.$route.params.id;u["a"].get("/purchase-order-details/order/".concat(o)).then((function(e){var r=e.data;console.log(r),t.$v.detail.fields.$reset(),t.details=r.orderDetails,t.subtotal=r.total_order,t.vat_total=r.total_vat,t.mxn_total=r.total_neto,t.detailIdToEdit=null,t.$q.loading.hide()}))}else t.$q.loading.hide()}))},newShipment:function(){this.$router.push("/shipments/purcharse-order/".concat(this.order.fields.id,"/",1))},editShipment:function(e){this.$router.push("/shipments/".concat(e.id,"/",1))},removeShipment:function(e){var t=this;this.$q.loading.show(),u["a"].delete("/shipments/".concat(e.id)).then((function(e){var r=e.data;if(t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result){var o=t.$route.params.id;u["a"].get("/shipments/order/".concat(o)).then((function(e){var r=e.data;t.shipments=r.shipments,t.$q.loading.hide()}))}else t.$q.loading.hide()}))},sendShipmentPdfToSupplier:function(e){var t=this;this.$q.loading.show(),u["a"].get("/shipments/".concat(e,"/send-mail")).then((function(e){var r=e.data;t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),t.$q.loading.hide()}))},generateShipmentPdf:function(e){var t="http://api.alpez.beta.wasp.mx/"+"shipments/pdf/".concat(e);window.open(t,"_blank")},saveStorageEntry:function(e){var t=this;this.$q.loading.show(),u["a"].put("/shipments/".concat(e,"/entry"),[]).then((function(e){var r=e.data;t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result?u["a"].get("/shipments/order/".concat(t.$route.params.id)).then((function(e){var r=e.data;t.shipments=r.shipments,t.$q.loading.hide()})):t.$q.loading.hide()}))},updateDocument:function(){var e=this;if(this.$v.document.fields.$reset(),this.$v.document.fields.$touch(),this.$v.document.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.document.fields);this.document.fields.id=null,this.document.fields.name=null,this.document.fields.observations=null,u["a"].put("/purchase-order-documents/".concat(t.id),t).then((function(t){var r=t.data;e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result?u["a"].get("/purchase-order-documents/purchase-order/".concat(e.$route.params.id)).then((function(t){var r=t.data;e.documents=r.documents,e.$q.loading.hide()})):e.$q.loading.hide()}))},cancelDocument:function(){this.document.fields.id=null,this.document.fields.name=null,this.document.fields.observations=null},addDocument:function(){var e=this;if(this.$v.document.fields.$reset(),this.$v.document.fields.$touch(),this.$v.document.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=a()({},this.document.fields);t.order_id=Number(this.$route.params.id),this.document.fields.name=null,this.document.fields.observations=null,u["a"].post("/purchase-order-documents",t).then((function(t){var r=t.data;e.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result?u["a"].get("/purchase-order-documents/purchase-order/".concat(e.$route.params.id)).then((function(t){var r=t.data;e.documents=r.documents,e.$q.loading.hide()})):e.$q.loading.hide()}))},openUploadFileModal:function(e){this.documentId=e.id,this.documentName=e.name,this.documentFileModal=!0},openUploadShipmentInvoiceModal:function(e){this.shipmentInvoice.fields.shipmentId=e.id,this.shipmentInvoice.fields.shipmentSerial=e.serial,this.shipmentInvoiceModal=!0},afterUploadDocumentFile:function(e){var t=JSON.parse(e.xhr.response);this.$q.notify({message:t.message.content,position:"top",color:t.result?"positive":"warning"}),t.result&&(this.fetchFromServer(),this.documentFileModal=!1)},afterUploadShipmentInvoiceFile:function(e){console.log(e);var t=JSON.parse(e.xhr.response);this.$q.notify({message:t.message.content,position:"top",color:t.result?"positive":"warning"}),t.result&&(this.fetchFromServer(),this.shipmentInvoiceModal=!1)},uploadDocumentFile:function(){this.$refs.fileDocumentRef.upload()},uploadShipmentInvoiceFile:function(){this.$refs.fileShipmentInvoiceRef.upload()},showDocumentFile:function(e){if(e.document_name){console.log(e);var t=e.document_name.split(".");console.log(e.order_id+e.id+"."+t[1]),window.open("".concat(this.serverUrl,"assets/purchase-orders/documents/").concat(e.order_id+""+e.id+"."+t[1]),"_blank")}else this.$q.notify({message:"El documento no cuenta con un archivo subido",position:"top",color:"warning"})},showShipmentInvoiceFile:function(e){e.invoice?window.open("".concat(this.serverUrl,"assets/shipments/").concat(e.invoice),"_blank"):this.$q.notify({message:"La recepción no cuenta con una factura subida",position:"top",color:"warning"})},downloadDocumentFile:function(e){e.document_name?window.open("".concat("http://api.alpez.beta.wasp.mx/","purchase-order-documents/file/").concat(e.id,"/download"),"_blank"):this.$q.notify({message:"El documento no cuenta con un archivo subido",position:"top",color:"warning"})},downloadShipmentInvoiceFile:function(e){e.invoice?window.open("".concat("http://api.alpez.beta.wasp.mx/","shipments/invoice-file/download/").concat(e.id),"_blank"):this.$q.notify({message:"La recepción no cuenta con una factura subida",position:"top",color:"warning"})},editDocument:function(e){this.document.fields.id=e.id,this.document.fields.name=e.name,this.document.fields.observations=e.observations},removeDocument:function(e){var t=this;this.$q.loading.show(),u["a"].delete("/purchase-order-documents/".concat(e)).then((function(e){var r=e.data;t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),console.log(r),r.result?u["a"].get("/purchase-order-documents/purchase-order/".concat(t.$route.params.id)).then((function(e){var r=e.data;t.documents=r.documents,t.$q.loading.hide()})):t.$q.loading.hide()}))},changeStatus:function(e){var t=this;this.$q.loading.show();var r={status:e,order_id:this.$route.params.id};u["a"].put("/purchase-orders/changeStatus",r).then((function(e){var r=e.data;if(console.log(r),t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.message_email&&t.$q.notify({message:r.message_email.content,position:"top",color:r.result?"positive":"warning"}),1===!t.$store.getters["users/rol"]&&21===!t.$store.getters["users/rol"])t.$router.push("/purchase-orders");else if(21===t.$store.getters["users/rol"])t.$router.push("/purchase-orders");else if(r.result){var o=t.$route.params.id;u["a"].get("/purchase-orders/".concat(o)).then((function(e){var r=e.data;console.log(r.history),t.order.fields=r.order,t.order.fields.branch_id={value:r.order.id_branch,label:r.order.name_branch},t.order.fields.storage={value:r.order.storage,label:r.order.name_storage},t.history=r.history,t.ready=r.ready,t.order.fields.supplier=t.supplierOptions.filter((function(e){return e.value===r.order.supplier_id}))[0],t.order.fields.acc_currency_type_id=1,t.getExchange(),t.$q.loading.hide()}))}else t.$q.loading.hide()}))},getExchange:function(){},filterSupplier:function(e,t,r){var o=this;t((function(){var t=e.toLowerCase();o.filteredSupplierOptions=o.supplierOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},filterProduct:function(e,t,r){var o=this;t((function(){var t=e.toLowerCase();o.filteredProductsOptions=o.filteredProductOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},getBranchesList:function(){var e=this;u["a"].get("branch-offices/options").then((function(t){var r=t.data;e.branchesList=r.options,e.branchOfficeOptions=r.options,e.branchOfficeOptions2=r.options}))},getStoragesList:function(){var e=this;u["a"].get("storages/options").then((function(t){var r=t.data;e.storageList=r.options,e.storageOptions=r.options,e.storageOptions2=r.options}))}}},b=g,q=r("2877"),_=r("9989"),y=r("ead5"),w=r("079e"),$=r("9c40"),O=r("05c0"),x=r("27f9"),C=r("0016"),S=r("ddd8"),D=r("7cbe"),E=r("52ee"),k=r("0d59"),I=r("429b"),P=r("7460"),A=r("eb85"),R=r("adad"),N=r("823b"),F=r("eaac"),T=r("bd08"),L=r("db86"),M=r("b047"),U=r("24e8"),B=r("f09f"),z=r("a370"),V=r("ee89"),Q=r("4b7e"),Y=r("7f67"),J=r("eebe"),Z=r.n(J),H=Object(q["a"])(b,o,i,!1,null,null,null);t["default"]=H.exports;Z()(H,"components",{QPage:_["a"],QBreadcrumbs:y["a"],QBreadcrumbsEl:w["a"],QBtn:$["a"],QTooltip:O["a"],QInput:x["a"],QIcon:C["a"],QSelect:S["a"],QPopupProxy:D["a"],QDate:E["a"],QSpinner:k["a"],QTabs:I["a"],QTab:P["a"],QSeparator:A["a"],QTabPanels:R["a"],QTabPanel:N["a"],QTable:F["a"],QTr:T["a"],QTd:L["a"],QChip:M["a"],QDialog:U["a"],QCard:B["a"],QCardSection:z["a"],QUploader:V["a"],QCardActions:Q["a"]}),Z()(H,"directives",{ClosePopup:Y["a"]})}}]);