(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[183],{"699f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"bg-grey-3"},[a("div",{staticClass:"q-pa-sm panel-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[a("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),a("q-breadcrumbs-el",{attrs:{label:"Proveedores"}})],1)],1)]),a("div",{staticClass:"col-xs-12 col-md-6 pull-right"},[a("div",{staticClass:"q-pa-sm q-gutter-sm"},[20!==t.roleId?a("q-btn",{attrs:{color:"negative",icon:"fas fa-file-pdf"},on:{click:function(e){return t.generatePdf()}}},[a("q-tooltip",{attrs:{"content-class":"bg-negative"}},[t._v("Descargar PDF")])],1):t._e(),20!==t.roleId?a("q-btn",{attrs:{color:"positive",icon:"fas fa-file-csv"},on:{click:function(e){return t.generateCsv()}}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("Descargar CSV")])],1):t._e(),20!==t.roleId?a("q-btn",{staticClass:"bg-primary",staticStyle:{color:"white"},attrs:{icon:"add",label:"Nuevo"},nativeOn:{click:function(e){return t.$router.push("/suppliers/new")}}}):t._e()],1)])])]),a("div",{staticClass:"q-pa-md bg-grey-3"},[a("div",{staticClass:"row bg-white border-panel"},[a("div",{staticClass:"col q-pa-md"},[a("q-table",{attrs:{flat:"",bordered:"",data:t.filteredSuppliers,columns:t.columns,"row-key":"serial",pagination:t.pagination,filter:t.filter},on:{"update:pagination":function(e){t.pagination=e},request:t.qTableRequest},scopedSlots:t._u([{key:"top",fn:function(){return[a("div",{staticStyle:{width:"100%"}},[a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},on:{input:function(e){t.filter=e.toUpperCase()}},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)]},proxy:!0},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"serial",staticClass:"text-primary cursor-pointer",staticStyle:{"text-align":"center","text-decoration":"underline"},attrs:{flat:"",props:e},nativeOn:{click:function(a){return t.editSelectedRow(e.row.id)}}},[t._v(t._s(e.row.serial))]),a("q-td",{key:"name",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.name))]),a("q-td",{key:"rfc",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.rfc))]),a("q-td",{key:"email",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.email))]),a("q-td",{key:"contact_phone",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.contact_phone))]),a("q-td",{key:"contact_phone_two",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.contact_phone_two))]),a("q-td",{key:"street",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.street))]),a("q-td",{key:"outdoor_number",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.outdoor_number))]),a("q-td",{key:"state",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.state))]),a("q-td",{key:"zip_code",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.zip_code))]),a("q-td",{key:"credit_days",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.credit_days))]),a("q-td",{key:"currency",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.currency))]),a("q-td",{key:"country",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.country))]),a("q-td",{key:"active",attrs:{props:e}},[a("q-chip",{attrs:{square:"",dense:"",color:e.row.active?"positive":"negative","text-color":"white"}},[t._v("\n                  "+t._s(e.row.active?"ACTIVO":"INACTIVO")+"\n                ")])],1),20!==t.roleId?a("q-td",{key:"actions",attrs:{props:e}},[a("q-btn",{attrs:{color:"primary",icon:"photo",flat:"",size:"10px"},nativeOn:{click:function(a){return t.editPhoto(e.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Fotografía")])],1),a("q-btn",{attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(a){return t.editSelectedRow(e.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Editar")])],1),a("q-btn",{attrs:{color:"red",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(a){return t.deleteSelectedRow(e.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("Eliminar")])],1)],1):t._e()],1)]}}])})],1)])]),a("q-dialog",{attrs:{persistent:""},model:{value:t.photoModal,callback:function(e){t.photoModal=e},expression:"photoModal"}},[a("q-card",[a("q-card-section",{staticClass:"row"},[a("div",{staticClass:"col-xs-12 col-sm-10 text-h6"},[t._v("Foto: "+t._s(t.photoCode))]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col-xs-12 col-sm-2 pull-right",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-card-section",[a("q-uploader",{ref:"photoRef",attrs:{accept:".jpg, image/*",method:"POST","hide-upload-btn":"",factory:t.factoryFn}})],1),a("q-card-section",[a("q-img",{attrs:{src:t.photoUrl,"spinner-color":"white"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Subir foto"},on:{click:function(e){return t.uploadPhoto()}}})],1)],1)],1)],1)},n=[],o=a("7ec2"),i=a.n(o),s=a("c973"),l=a.n(s),c=(a("4de4"),a("d3b7"),a("a9e3"),a("aabb")),p={name:"IndexSuppliers",data:function(){return{pagination:{sortBy:"serial",descending:!0,page:1,rowsNumber:0,rowsPerPage:25},columns:[{name:"serial",align:"center",label:"CÓDIGO",field:"serial",sortable:!0},{name:"name",align:"center",label:"RAZÓN SOCIAL",field:"name",sortable:!0},{name:"rfc",align:"center",label:"RFC",field:"rfc",sortable:!0},{name:"email",align:"center",label:"EMAIL",field:"email",sortable:!0},{name:"contact_phone",align:"center",label:"TEL. OFICINA",field:"contact_phone",sortable:!0},{name:"contact_phone_two",align:"center",label:"TEL. CELULAR",field:"contact_phone_two",sortable:!0},{name:"street",align:"center",label:"CALLE",field:"street",sortable:!0},{name:"outdoor_number",align:"center",label:"NUMERO EXT",field:"outdoor_number",sortable:!0},{name:"state",align:"center",label:"ESTADO",field:"state",sortable:!0},{name:"zip_code",align:"center",label:"CP",field:"zip_code",sortable:!0},{name:"credit_days",align:"center",label:"DÍAS DE CREDITO",field:"credit_days",sortable:!0},{name:"currency",align:"center",label:"MONEDA",field:"currency",sortable:!0},{name:"country",align:"center",label:"PAÍS",field:"country",sortable:!0},{name:"active",align:"center",label:"ESTATUS",field:"active",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",sortable:!1}],data:[],filter:"",branchOffice:{value:null,label:"TODOS"},branchOfficeOptions:[],serverUrl:"https://api_alpez.wasp.mx/",customerId:null,photoModal:!1,photoUrl:null,photoCode:null}},beforeRouteEnter:function(t,e,a){a((function(t){var e=t.$store.getters["users/rol"];console.log(e),1===e||3===e||7===e||2===e||20===e||4===e||27===e||22===e||17===e||28===e?a():a("/")}))},mounted:function(){this.fetchFromServer(),this.getBranchOffices()},computed:{roleId:function(){var t=this.$store.getters["users/rol"];return parseInt(t)},filteredSuppliers:function(){var t=this,e=this.data.filter((function(t){return!0===t.active}));return null!=this.branchOffice&&null!=this.branchOffice.value?e.filter((function(e){return Number(e.branch_id)===Number(t.branchOffice.value)})):e}},methods:{generateCsv:function(){var t=null;this.branchOffice&&(t=this.branchOffice.value);var e="https://api_alpez.wasp.mx/"+"suppliers/csv/".concat(t);window.open(e,"_blank")},generatePdf:function(){var t="https://api_alpez.wasp.mx/suppliers/pdf/";window.open(t,"_blank")},fetchFromServer:function(){this.$q.loading.show(),this.qTableRequest({pagination:this.pagination,filter:this.filter})},qTableRequest:function(t){var e=this;return l()(i()().mark((function a(){var r;return i()().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.pagination=t.pagination,e.filter=t.filter,r=[],r.branch=e.branchOffice.value,r.pagination=e.pagination,r.filter=e.filter,a.next=8,c["a"].post("/suppliers/pag",r).then((function(t){var a=t.data;e.$q.loading.hide(),e.data=a.suppliers,e.pagination.rowsNumber=a.suppliersCount})).catch((function(t){return t}));case 8:case"end":return a.stop()}}),a)})))()},getBranchOffices:function(){var t=this;c["a"].get("branch-offices/options").then((function(e){var a=e.data;t.branchOfficeOptions=a.options,t.branchOfficeOptions.unshift({value:null,label:"TODOS"})}))},editSelectedRow:function(t){this.$router.push("/suppliers/".concat(t))},deleteSelectedRow:function(t){var e=this;this.$q.dialog({title:"Confirmación",message:"¿Desea eliminar este Proveedor?",persistent:!0,ok:{label:"Aceptar",color:"green"},cancel:{label:"Cancelar",color:"red"}}).onOk((function(){c["a"].delete("/suppliers/".concat(t)).then((function(t){var a=t.data;e.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning",icon:a.result?"thumb_up":"close"}),a.result&&e.fetchFromServer()}))})).onCancel((function(){}))},factoryFn:function(t){var e=this;this.$q.loading.show();var a=new FormData;a.append("fileReg",t[0]),a.append("id",this.supplierId),c["a"].file("/suppliers/photo/",a).then((function(t){var a=t.data;e.fetchFromServer(),e.$showNotify(a.message.content,a.result?"positive":"negative"),e.photoModal=!1,e.$q.loading.hide()}))},editPhoto:function(t){var e=this.data.filter((function(e){return Number(e.id)===Number(t)}))[0];this.photoUrl=null!=e.photo?this.serverUrl+"assets/images/suppliers/"+e.photo:null,this.supplierId=e.id,this.photoCode=e.serial,this.photoModal=!0},uploadPhoto:function(){this.$refs.photoRef.upload()}}},d=p,u=a("2877"),f=a("9989"),h=a("ead5"),b=a("079e"),g=a("9c40"),m=a("05c0"),v=a("eaac"),_=a("27f9"),q=a("0016"),y=a("bd08"),w=a("db86"),C=a("b047"),S=a("24e8"),O=a("f09f"),k=a("a370"),x=a("ee89"),I=a("068f"),T=a("4b7e"),E=a("7f67"),Q=a("eebe"),R=a.n(Q),A=Object(u["a"])(d,r,n,!1,null,null,null);e["default"]=A.exports;R()(A,"components",{QPage:f["a"],QBreadcrumbs:h["a"],QBreadcrumbsEl:b["a"],QBtn:g["a"],QTooltip:m["a"],QTable:v["a"],QInput:_["a"],QIcon:q["a"],QTr:y["a"],QTd:w["a"],QChip:C["a"],QDialog:S["a"],QCard:O["a"],QCardSection:k["a"],QUploader:x["a"],QImg:I["a"],QCardActions:T["a"]}),R()(A,"directives",{ClosePopup:E["a"]})}}]);