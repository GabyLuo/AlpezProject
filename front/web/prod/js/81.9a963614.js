(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[81],{e113:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("div",{staticClass:"q-pa-sm panel-header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-9"},[i("div",{staticClass:"q-pa-md q-gutter-sm"},[i("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[i("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),i("q-breadcrumbs-el",{attrs:{label:"Embarque",to:e.idUrlBack}}),i("q-breadcrumbs-el",{attrs:{label:"Nuevo envio"}})],1)],1)])])]),i("div",{staticClass:"q-pa-md bg-grey-3"},[i("div",{staticClass:"row bg-white border-panel"},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-mb-sm"}),i("div",{staticClass:"row q-col-gutter-xs"},[i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Folio"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"fingerprint"}})]},proxy:!0}]),model:{value:e.lot.fields.folio,callback:function(t){e.$set(e.lot.fields,"folio",t)},expression:"lot.fields.folio"}})],1),i("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.dateRules,error:e.$v.lot.fields.date.$error,mask:"date",label:"Fecha"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.lot.fields.date,callback:function(t){e.$set(e.lot.fields,"date",t)},expression:"lot.fields.date"}},[i("q-popup-proxy",{ref:"date_ref",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("div",{staticClass:"col-sm-12"},[i("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return e.$refs.date_ref.hide()}},model:{value:e.lot.fields.date,callback:function(t){e.$set(e.lot.fields,"date",t)},expression:"lot.fields.date"}})],1)])],1)],1),i("div",{staticClass:"col-xs-12 col-sm-6"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.lot.fields.client.$error,label:"Cliente",rules:e.clientRules,options:e.clientOptionsFilter,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},on:{filter:e.filterClient},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"person"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"groups"},[e._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:e.lot.fields.client,callback:function(t){e.$set(e.lot.fields,"client",t)},expression:"lot.fields.client"}})],1)]),i("div",{staticClass:"row q-mb-sm q-mt-md"},[i("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[i("q-btn",{attrs:{color:"positive",icon:"add",label:"Crear"},on:{click:function(t){return e.createLotTrip()}}})],1)])])])])])},o=[],l=i("ded3"),r=i.n(l),a=(i("a9e3"),i("caad"),i("2532"),i("4de4"),i("d3b7"),i("aabb")),n=i("b5ae"),c=n.required,d={name:"NewShipping",validations:{lot:{fields:{date:{required:c},client:{required:c}}}},data:function(){return{lot:{fields:{folio:null,date:null,client:null,trip_id:Number(this.$route.params.id)}},idUrlBack:"/trips/"+this.$route.params.id,id:Number(this.$route.params.id),clientOptions:[],clientOptionsFilter:[]}},mounted:function(){this.getClient(),this.getFolioTrip()},computed:{dateRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.date.required||"El campo Fecha es requerido."}]},clientRules:function(e){var t=this;return[function(e){return t.$v.lot.fields.client.required||"El campo Cliente es requerido."}]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(10)||this.$router.push("/")},methods:{createLotTrip:function(){var e=this;if(this.$v.lot.fields.$reset(),this.$v.lot.fields.$touch(),this.$v.lot.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=r()({},this.lot.fields);t.date=this.lot.fields.date.substr(6,10)+"-"+this.lot.fields.date.substr(3,2)+"-"+this.lot.fields.date.substr(0,2),a["a"].post("/shippings",t).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.$q.loading.hide(),e.$router.push("/lotTrip/".concat(i.id))):e.$q.loading.hide()}))},getClient:function(){var e=this;a["a"].get("customers/options").then((function(t){e.clientOptions=t.data.options}))},filterClient:function(e,t,i){var s=this;t((function(){var t=e.toLowerCase();s.clientOptionsFilter=s.clientOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},getFolioTrip:function(){var e=this;a["a"].get("shippings/folio/".concat(this.id)).then((function(t){var i=t.data.folio.folio;a["a"].get("shippings/folioShipping/".concat(e.id)).then((function(t){var s=t.data.folioShipping.number;e.lot.fields.folio=i+"-"+s}))}))}}},u=d,f=i("2877"),p=i("9989"),m=i("ead5"),h=i("079e"),b=i("27f9"),v=i("0016"),g=i("ddd8"),q=i("7cbe"),$=i("52ee"),C=i("66e5"),x=i("4074"),w=i("9c40"),y=i("eebe"),k=i.n(y),Q=Object(f["a"])(u,s,o,!1,null,null,null);t["default"]=Q.exports;k()(Q,"components",{QPage:p["a"],QBreadcrumbs:m["a"],QBreadcrumbsEl:h["a"],QInput:b["a"],QIcon:v["a"],QSelect:g["a"],QPopupProxy:q["a"],QDate:$["a"],QItem:C["a"],QItemSection:x["a"],QBtn:w["a"]})}}]);