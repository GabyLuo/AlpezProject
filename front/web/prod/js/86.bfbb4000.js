(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[86],{"80be":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"bg-grey-3"},[a("div",{staticClass:"q-pa-sm panel-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{staticStyle:{"font-size":"20px"}},[a("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),a("q-breadcrumbs-el",{attrs:{label:"Movimientos"}})],1)],1)]),a("div",{staticClass:"col-sm-8 pull-right"},[a("div",{staticClass:"q-pa-sm q-gutter-sm"},[a("q-btn",{attrs:{color:"positive",icon:"add",label:"Entrada"},nativeOn:{click:function(t){return e.$router.push("/movements/new/1")}}}),a("q-btn",{attrs:{color:"negative",icon:"remove",label:"Salida"},nativeOn:{click:function(t){return e.$router.push("/movements/new/2")}}}),a("q-btn",{attrs:{color:"warning",icon:"compare_arrows",label:"Traspaso"},nativeOn:{click:function(t){return e.$router.push("/movements/newTransfer/4")}}}),a("q-btn",{attrs:{color:"light-blue",icon:"restore",label:"Inventario Físico"},nativeOn:{click:function(t){return e.$router.push("/movements/new/3")}}})],1)])])]),a("div",{staticClass:"q-pa-md bg-grey-3"},[a("div",{staticClass:"row bg-white border-panel"},[a("div",{staticClass:"col-md-4 col-xs-4 q-pl-md q-pt-md"},[a("q-select",{attrs:{label:"Tipo de Movimiento",color:"dark",filled:"","bg-color":"secondary",options:[{label:"TODOS",value:0},{label:"ENTRADA",value:1},{label:"SALIDA",value:2},{label:"INVENTARIO FÍSICO",value:3},{label:"TRASPASO (ENTRADA)",value:4},{label:"TRASPASO (SALIDA)",value:5},{label:"MERMA",value:6}],"map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0}]),model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}})],1),a("div",{staticClass:"col-md-4 col-xs-4 q-pl-md q-pt-md"},[a("q-select",{attrs:{label:"Almacén",color:"dark",filled:"","bg-color":"secondary",options:e.storageOptions,"map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fas fa-cubes"}})]},proxy:!0}]),model:{value:e.storage,callback:function(t){e.storage=t},expression:"storage"}})],1),a("div",{staticClass:"col-md-12 col-xs-12 q-pa-md"},[a("div",{staticClass:"row q-mb-sm"}),a("q-table",{attrs:{flat:"",bordered:"",data:e.filterTM,"row-key":"folio",pagination:e.pagination,columns:e.columns,filter:e.filter},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticStyle:{width:"100%"}},[a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"folio",staticStyle:{"text-align":"center"},attrs:{props:t}},[e._v(e._s(t.row.folio))]),a("q-td",{key:"created",attrs:{props:t}},[e._v(e._s(t.row.date))]),a("q-td",{key:"type_id",attrs:{bg:"",props:t}},[a("q-chip",{attrs:{"text-color":"white",square:"",dense:"",color:t.row.color}},[e._v("\n                            "+e._s(t.row.type_id)+"\n                          ")])],1),a("q-td",{key:"branch_name",attrs:{props:t}},[e._v(e._s(t.row.branch_name))]),a("q-td",{key:"storage_name",attrs:{props:t}},[e._v(e._s(t.row.storage_name))]),a("q-td",{key:"status",attrs:{props:t}},[a("q-chip",{attrs:{dense:"",icon:"add",color:"NUEVO"==t.row.status?"blue":"EJECUTADO"===t.row.status?"positive":"CANCELADO"===t.row.status?"negative":e.negative,"text-color":"white"}},[e._v("\n                            "+e._s(t.row.status)+"\n                          ")])],1),a("q-td",{key:"actions",attrs:{props:t}},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"fas fa-edit",size:"10px"},nativeOn:{click:function(a){return e.editSelectedRow(t.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Editar")])],1),a("q-btn",{attrs:{color:"negative",flat:"",icon:"fas fa-trash-alt",size:"10px"},nativeOn:{click:function(a){return e.deleteSelectedRow(t.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Eliminar")])],1),"EJECUTADO"==t.row.status&&e.haspermissionv1?a("q-btn",{attrs:{color:"negative",icon:"fas fa-ban",flat:"",size:"10px"},nativeOn:{click:function(a){return e.cancelSelectedRow(t.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Cancelar")])],1):e._e()],1)],1)]}}])})],1)])])])},n=[],i=(a("4de4"),a("d3b7"),a("caad"),a("2532"),a("a15b"),a("ac1f"),a("1276"),a("aabb")),s={name:"IndexMovements",data:function(){return{storage:{label:"TODOS",value:0},storageOptions:[],filter:"",pagination:{sortBy:"code",descending:!1,rowsPerPage:25},columns:[{name:"folio",align:"center",label:"FOLIO",field:"folio",style:"width: 10%",sortable:!0},{name:"created",align:"center",label:"FECHA",field:"created",style:"width: 15%",sortable:!0},{name:"type_id",align:"center",label:"MOVIMIENTOS",field:"type_id",style:"width: 10%",sortable:!0},{name:"branch_name",align:"center",label:"ESTACIÓN",field:"branch_name",style:"width: 10%",sortable:!0},{name:"storage_name",align:"center",label:"ALMACÉN",field:"storage_name",style:"width: 10%",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],filterType:{label:"TODOS",value:0},data:[],dataTemp:[]}},mounted:function(){this.fetchFromServer()},computed:{filterTM:function(){var e=this,t=this.data;return console.log(t),null!==this.storage&&"TODOS"!==this.storage.label&&null!==this.filterType&&"TODOS"!==this.filterType.label?t=this.data.filter((function(t){return t.storage_id===e.storage.value&&t.type_id===e.filterType.label})):null!==this.filterType&&"TODOS"!==this.filterType.label?t=this.data.filter((function(t){return t.type_id===e.filterType.label})):null!==this.storage&&"TODOS"!==this.storage.label&&(t=this.data.filter((function(t){return t.storage_id===e.storage.value}))),t},haspermissionv1:function(){return this.$store.getters["users/roles"].includes(1)}},beforeRouteEnter:function(e,t,a){a((function(e){var t=e.$store.getters["users/rol"];console.log(t),1===t||3===t||7===t||2===t||20===t||4===t||27===t||22===t||26===t?a():a("/")}))},methods:{invertDate:function(e){if(null!==e)var t=e.split("/").reverse().join("-");return t},deleteSelectedRow:function(e){var t=this;this.$q.dialog({title:"Confirmación",message:"¿Desea eliminar este Movimiento?",persistent:!0,ok:{label:"Aceptar",color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk((function(){t.$q.loading.show(),i["a"].delete("/movements/".concat(e)).then((function(e){var a=e.data;t.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning",icon:a.result?"thumb_up":"close"}),a.result?(t.$q.loading.hide(),t.fetchFromServer()):t.$q.loading.hide()}))})).onCancel((function(){}))},editSelectedRow:function(e){this.$router.push("/movements/".concat(e))},fetchFromServer:function(){var e=this;this.$q.loading.show(),i["a"].get("/movements/").then((function(t){var a=t.data;e.data=a.movements;for(var o=0;o<e.data.length;o++)1===e.data[o].type_id?(e.data[o].type_id="ENTRADA",e.data[o].color="positive"):2===e.data[o].type_id?(e.data[o].type_id="SALIDA",e.data[o].color="negative"):3===e.data[o].type_id?(e.data[o].type_id="INVENTARIO FÍSICO",e.data[o].color="light-blue"):4===e.data[o].type_id?(e.data[o].type_id="TRASPASO (ENTRADA)",e.data[o].color="positive"):5===e.data[o].type_id?(e.data[o].type_id="TRASPASO (SALIDA)",e.data[o].color="negative"):6===e.data[o].type_id&&(e.data[o].type_id="MERMA",e.data[o].color="purple")})),i["a"].get("/storages/options").then((function(t){var a=t.data;e.storageOptions=a.options,e.storageOptions.push({label:"TODOS",value:0})})),this.$q.loading.hide()},cancelSelectedRow:function(e){var t=this;this.$q.dialog({title:"Confirmación",message:"¿Desea cancelar este Movimiento?",persistent:!0,ok:{label:"Aceptar",color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk((function(){t.$q.loading.show(),i["a"].put("/movements/cancel/".concat(e)).then((function(e){var a=e.data;t.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning"}),a.result?(t.$q.loading.hide(),t.fetchFromServer()):t.$q.loading.hide()}))})).onCancel((function(){}))}}},r=s,l=a("2877"),c=a("9989"),d=a("ead5"),p=a("079e"),u=a("9c40"),f=a("ddd8"),m=a("0016"),b=a("eaac"),v=a("27f9"),g=a("bd08"),h=a("db86"),y=a("b047"),q=a("05c0"),w=a("eebe"),_=a.n(w),O=Object(l["a"])(r,o,n,!1,null,null,null);t["default"]=O.exports;_()(O,"components",{QPage:c["a"],QBreadcrumbs:d["a"],QBreadcrumbsEl:p["a"],QBtn:u["a"],QSelect:f["a"],QIcon:m["a"],QTable:b["a"],QInput:v["a"],QTr:g["a"],QTd:h["a"],QChip:y["a"],QTooltip:q["a"]})}}]);