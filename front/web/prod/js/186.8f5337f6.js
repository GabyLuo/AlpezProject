(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[186],{"016e":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"bg-grey-3"},[a("div",{staticClass:"q-pa-sm panel-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-8"},[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[a("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),a("q-breadcrumbs-el",{attrs:{label:"Movimientos"}})],1)],1)]),a("div",{staticClass:"col-xs-6 col-md-4 pull-right"},[a("div",{staticClass:"q-pa-sm q-gutter-sm"},[a("q-btn",{staticClass:"bg-primary",staticStyle:{color:"white"},attrs:{icon:"add",label:"Nuevo"},nativeOn:{click:function(e){return t.$router.push("/trade-movements/new")}}})],1)])])]),a("div",{staticClass:"q-pa-md bg-grey-3"},[a("div",{staticClass:"row bg-white border-panel"},[a("div",{staticClass:"col q-pa-md"},[a("div",{staticClass:"row q-mb-sm"},[a("div",{staticClass:"col-xs-12 col-sm-2",staticStyle:{"padding-left":"20px"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Año",options:t.selectYears,"emit-value":"","map-options":""},on:{input:function(e){t.fetchFromServer()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fa fa-calendar"}})]},proxy:!0}]),model:{value:t.search.fields.year,callback:function(e){t.$set(t.search.fields,"year",e)},expression:"search.fields.year"}})],1),a("div",{staticClass:"col-xs-12 col-sm-2",staticStyle:{"padding-left":"20px"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Mes",options:t.selectMonths,"emit-value":"","map-options":""},on:{input:function(e){t.changeMonth()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fa fa-calendar"}})]},proxy:!0}]),model:{value:t.search.fields.month,callback:function(e){t.$set(t.search.fields,"month",e)},expression:"search.fields.month"}})],1),a("div",{staticClass:"col-xs-12 col-sm-3",staticStyle:{"padding-left":"20px"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Cuenta",options:t.accountOptions,"emit-value":"","map-options":""},on:{input:function(e){t.fetchFromServer()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fa fa-building"}})]},proxy:!0}]),model:{value:t.search.fields.account,callback:function(e){t.$set(t.search.fields,"account",e)},expression:"search.fields.account"}})],1),a("div",{staticClass:"col-xs-12 col-sm-3",staticStyle:{"padding-left":"20px"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Rubro",options:t.outputOptions,"emit-value":"","map-options":""},on:{input:function(e){t.fetchFromServer()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fa fa-building"}})]},proxy:!0}]),model:{value:t.search.fields.output_type,callback:function(e){t.$set(t.search.fields,"output_type",e)},expression:"search.fields.output_type"}})],1),a("div",{staticClass:"col-xs-12 col-sm-2",staticStyle:{"padding-left":"20px"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Movimiento",options:t.movementOptions,"emit-value":"","map-options":""},on:{input:function(e){t.fetchFromServer()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fa fa-building"}})]},proxy:!0}]),model:{value:t.search.fields.movement_type,callback:function(e){t.$set(t.search.fields,"movement_type",e)},expression:"search.fields.movement_type"}})],1),a("div",{staticClass:"col-xs-12 col-md-12 pull-right",staticStyle:{padding:"3px"}},[a("q-btn",{staticClass:"full-height",staticStyle:{"margin-left":"6px"},attrs:{icon:"fas fa-eraser",color:"primary"},on:{click:function(e){return t.cleanFilters()}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Limpiar filtros")])],1)],1)]),a("q-table",{attrs:{flat:"",bordered:"",data:t.data,columns:t.columns,"row-key":"code",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e},request:t.onRequest},scopedSlots:t._u([{key:"top",fn:function(){},proxy:!0},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"actions",staticClass:"pull-left",staticStyle:{width:"18%"},attrs:{props:e}},[a("q-btn",{directives:[{name:"show",rawName:"v-show",value:""!=e.row.date,expression:"props.row.date != ''"}],attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(a){return t.editSelectedRow(e.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("Editar")])],1),a("q-btn",{directives:[{name:"show",rawName:"v-show",value:""!=e.row.date,expression:"props.row.date != ''"}],attrs:{color:"red",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(a){return t.deleteSelectedRow(e.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("Eliminar")])],1)],1),a("q-td",{key:"date",staticStyle:{"text-align":"center"},attrs:{props:e}},[t._v(t._s(e.row.date))]),a("q-td",{key:"movement_type",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.movement))]),a("q-td",{key:"account_type",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.account))]),a("q-td",{key:"output_type",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.output))]),a("q-td",{key:"description",class:""==e.row.movement?"text-bold":"",staticStyle:{"text-align":"left"},attrs:{props:e}},[t._v(t._s(e.row.description))]),a("q-td",{key:"amount",staticClass:"bg-red",class:""==e.row.movement?"text-bold":"",staticStyle:{"text-align":"right",color:"white"},attrs:{props:e}},[t._v(t._s(t.formatPrice(Number(e.row.amount))))]),a("q-td",{key:"amount_abono",staticClass:"bg-positive",class:""==e.row.movement?"text-bold":"",staticStyle:{"text-align":"right",color:"white"},attrs:{props:e}},[t._v(t._s(t.formatPrice(Number(e.row.amount_abono))))])],1)]}},{key:"bottom-row",fn:function(){return[a("q-tr",[a("q-td"),a("q-td"),a("q-td"),a("q-td"),a("q-td"),a("q-td",{staticClass:"text-weight-bold text-right"},[t._v("TOTAL")]),a("q-td"),a("q-td",{staticStyle:{"text-align":"center",color:"white"},style:t.total>=0?"background-color: green !important;":"background-color: red !important;"},[t._v("\n                "+t._s(t.formatPrice(Number.parseFloat(t.total.toFixed(2))))+"\n              ")])],1)]},proxy:!0}])})],1)])])])},s=[],n=(a("caad"),a("2532"),a("ac1f"),a("841c"),a("4de4"),a("d3b7"),a("cca6"),a("c35a"),a("a9e3"),a("aabb")),i={name:"Index",data:function(){return{pagination:{sortBy:"id",descending:!0,rowsPerPage:25,page:1,rowsNumber:0},columns:[{name:"actions",align:"center",label:"",field:"actions",style:"width: 10%",sortable:!1},{name:"date",align:"center",label:"FECHA",field:"date",sortable:!0},{name:"movement_type",align:"center",label:"MOVIMIENTO",field:"movement_type",sortable:!0},{name:"account_type",align:"center",label:"CUENTA",field:"account_type",sortable:!0},{name:"output_type",align:"center",label:"RUBRO",field:"output_type",sortable:!0},{name:"description",align:"center",label:"DESCRIPCIÓN",field:"description",sortable:!0},{name:"amount",align:"center",label:"CARGOS",field:"amount",sortable:!0},{name:"amount_abono",align:"center",label:"ABONOS",style:"width: 8%",field:"amount_abono",sortable:!0}],data:[],filter:"",total:0,totalCargo:0,totalAbono:0,search:{fields:{output_type:0,year:0,month:0,account:0,movement_type:"all"}},selectYears:[],selectMonths:[],outputOptions:[],movementOptions:[{value:"all",label:"TODOS"},{value:"CARGO",label:"CARGO"},{value:"ABONO",label:"ABONO"}],accountOptions:[]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(2)||this.$store.getters["users/roles"].includes(24)||this.$router.push("/")},mounted:function(){this.$q.loading.show(),this.search.fields.month=this.$q.localStorage.getItem("month"),this.search.fields.month||(this.search.fields.month=0),this.fetchFromServer(),this.$q.loading.hide(),this.getOutputs(),this.getMonths(),this.getAccounts(),this.getYears()},methods:{onRequest:function(t){this.pagination=t.pagination,this.filter=t.filter,this.fetchFromServer()},formatPrice:function(t){var e={style:"currency",currency:"USD",maximumFractionDigits:13},a=new Intl.NumberFormat("en-US",e);return a.format(t)},changeMonth:function(){this.$q.localStorage.set("month",this.search.fields.month),this.fetchFromServer()},fetchFromServer:function(){var t=this;this.$q.loading.show();var e=Object.assign(this.pagination,this.search.fields,this.filter);console.log(e),n["a"].post("movement-trade/getMovements",e).then((function(e){var a=e.data;t.data=a.movements,t.pagination.rowsNumber=a.count,t.totalCargo=a.total_cargo?a.total_cargo:0,t.totalAbono=a.total_abono?a.total_abono:0,t.total=Number.parseFloat(t.totalAbono)+Number.parseFloat(t.totalCargo),t.$q.loading.hide()}))},editSelectedRow:function(t){this.$router.push("/trade-movements/".concat(t))},deleteSelectedRow:function(t){var e=this;this.$q.dialog({title:"Confirmación",message:"¿Desea eliminar esta Movimiento?",persistent:!0,ok:{label:"Aceptar",color:"green"},cancel:{label:"Cancelar",color:"red"}}).onOk((function(){n["a"].delete("/movement-trade/".concat(t)).then((function(t){var a=t.data;e.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning",icon:a.result?"thumb_up":"close"}),a.result&&e.fetchFromServer()}))})).onCancel((function(){}))},getOutputs:function(){var t=this;this.$q.loading.show(),n["a"].get("/output_type/options").then((function(e){var a=e.data;t.outputOptions=a.options,t.outputOptions.unshift({label:"TODOS",value:0}),t.$q.loading.hide()}))},getAccounts:function(){var t=this;this.$q.loading.show(),n["a"].get("/account-trade/options").then((function(e){var a=e.data;t.accountOptions=a.options,t.accountOptions.unshift({label:"TODOS",value:0}),t.$q.loading.hide()}))},getYears:function(){var t=this;this.$q.loading.show(),n["a"].get("/movement-trade/optionsYears").then((function(e){var a=e.data;t.selectYears=a.options,t.selectYears.unshift({label:"TODOS",value:0}),t.$q.loading.hide()}))},getMonths:function(){this.selectMonths=[];var t=["TODOS","ENERO","FEBRERO","MARZO","ABRIR","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"];for(var e in t)this.selectMonths.push({label:t[e],value:parseInt(e)})},cleanFilters:function(){this.search.fields.year=0,this.search.fields.month=0,this.search.fields.account=0,this.search.fields.output_type=0,this.search.fields.movement_type="all",this.$q.localStorage.set("month",0),this.fetchFromServer()}}},r=i,l=a("2877"),c=a("9989"),d=a("ead5"),u=a("079e"),p=a("9c40"),m=a("ddd8"),f=a("0016"),h=a("05c0"),g=a("eaac"),b=a("bd08"),v=a("db86"),y=a("eebe"),q=a.n(y),w=Object(l["a"])(r,o,s,!1,null,null,null);e["default"]=w.exports;q()(w,"components",{QPage:c["a"],QBreadcrumbs:d["a"],QBreadcrumbsEl:u["a"],QBtn:p["a"],QSelect:m["a"],QIcon:f["a"],QTooltip:h["a"],QTable:g["a"],QTr:b["a"],QTd:v["a"]})}}]);