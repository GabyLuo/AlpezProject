(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[88],{2655:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"bg-grey-3"},[n("div",{staticClass:"q-pa-sm panel-header"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-sm-8"},[n("div",{staticClass:"q-pa-md q-gutter-sm"},[n("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[n("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),n("q-breadcrumbs-el",{attrs:{label:"Movimientos",to:"/movements"}}),n("q-breadcrumbs-el",{attrs:{label:"Nuevo Movimiento"}})],1)],1)])])]),n("div",{staticClass:"q-pa-md bg-grey-3"},[n("div",{staticClass:"row bg-white border-panel"},[n("div",{staticClass:"col q-pa-md"},[n("div",{staticClass:"row q-col-gutter-xs"},[n("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[n("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.dateRules,mask:"date",label:"Fecha"},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.movement.fields.date,callback:function(t){e.$set(e.movement.fields,"date",t)},expression:"movement.fields.date"}},[n("q-popup-proxy",{ref:"date",attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("div",{staticClass:"col-sm-12"},[n("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return e.$refs.date.hide()}},model:{value:e.movement.fields.date,callback:function(t){e.$set(e.movement.fields,"date",t)},expression:"movement.fields.date"}})],1)])],1)],1),n("div",{staticClass:"col-sm-12 col-md-2"},[n("q-input",{attrs:{color:"white",dark:"","bg-color":"blue",filled:"",label:"Estatus",readonly:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"battery_full"}})]},proxy:!0}]),model:{value:e.movement.fields.statusStr,callback:function(t){e.$set(e.movement.fields,"statusStr",t)},expression:"movement.fields.statusStr"}})],1)]),n("div",{staticClass:"row q-col-gutter-xs"},[n("div",{staticClass:"col-xs-12 col-sm-4 text-center"},[n("q-select",{attrs:{color:"white",dark:"","bg-color":"negative",filled:"",readonly:"",filter:"",label:"Tipo de Movimiento"},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"swap_horiz"}})]},proxy:!0}]),model:{value:e.movement.fields.type_movement_1,callback:function(t){e.$set(e.movement.fields,"type_movement_1",t)},expression:"movement.fields.type_movement_1"}})],1),n("div",{staticClass:"col-sm-12 col-md-4"},[n("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.branchOfficeOptions,label:"Estación origen","emit-value":"","map-options":"",rules:e.originBranchOfficeRules},on:{input:function(){return e.movement.fields.originStorage=""}},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"fas fa-store-alt"}})]},proxy:!0}]),model:{value:e.movement.fields.originBranchOffice,callback:function(t){e.$set(e.movement.fields,"originBranchOffice",t)},expression:"movement.fields.originBranchOffice"}})],1),n("div",{staticClass:"col-sm-12 col-md-4"},[n("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.filteredOriginStorageOptions,label:"Almacén origen",rules:e.originStorageRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"fas fa-warehouse"}})]},proxy:!0}]),model:{value:e.movement.fields.originStorage,callback:function(t){e.$set(e.movement.fields,"originStorage",t)},expression:"movement.fields.originStorage"}})],1),n("div",{staticClass:"col-xs-12 col-sm-4 text-center"},[n("q-select",{attrs:{color:"dark",dark:"","bg-color":"positive",filled:"",readonly:"",filter:"",label:"Tipo de Movimiento"},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"swap_horiz"}})]},proxy:!0}]),model:{value:e.movement.fields.type_movement_2,callback:function(t){e.$set(e.movement.fields,"type_movement_2",t)},expression:"movement.fields.type_movement_2"}})],1),n("div",{staticClass:"col-sm-12 col-md-4"},[n("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.branchOfficeOptions2,label:"Estación destino",rules:e.destinationBranchOfficeRules},on:{input:function(){return e.movement.fields.destinationStorage=""}},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"fas fa-store-alt"}})]},proxy:!0}]),model:{value:e.movement.fields.destinationBranchOffice,callback:function(t){e.$set(e.movement.fields,"destinationBranchOffice",t)},expression:"movement.fields.destinationBranchOffice"}})],1),n("div",{staticClass:"col-sm-12 col-md-4"},[n("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.filteredDestinationStorage,label:"Almacén destino",rules:e.destinationStorageRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"fas fa-warehouse"}})]},proxy:!0}]),model:{value:e.movement.fields.destinationStorage,callback:function(t){e.$set(e.movement.fields,"destinationStorage",t)},expression:"movement.fields.destinationStorage"}})],1),n("div",{staticClass:"col-sm-12 col-md-12 pull-right"},[n("q-btn",{attrs:{color:"positive",icon:"save",label:"Guardar"},on:{click:function(t){return e.createBranchOfficeTransfer()}}})],1)])])])])])},i=[],r=n("ded3"),s=n.n(r),a=(n("4de4"),n("d3b7"),n("a9e3"),n("a15b"),n("ac1f"),n("1276"),n("aabb")),l=n("b5ae"),c=l.required,d={name:"NewBranchTransfer",validations:{movement:{fields:{originBranchOffice:{required:c},originStorage:{required:c},destinationBranchOffice:{required:c},destinationStorage:{required:c},date:{required:c}}}},data:function(){return{movement:{fields:{id:null,date:null,originBranchOffice:null,originStorage:null,destinationBranchOffice:null,destinationStorage:null,statusStr:"NUEVO",transactionId:null,folio_1:null,folio_2:null,type_movement_1:"TRASPASO (SALIDA)",type_movement_2:"TRASPASO (ENTRADA)"}},branchOfficeOptions:[],branchOfficeOptions2:[],storageOptions:[],storageOptions2:[]}},computed:{dateRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.date.required||"El campo Fecha es requerido."}]},originBranchOfficeRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.originBranchOffice.required||"El campo Sucursal origen es requerido."}]},originStorageRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.originStorage.required||"El campo Almacén origen es requerido."}]},destinationBranchOfficeRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.destinationBranchOffice.required||"El campo Sucursal destino es requerido."}]},destinationStorageRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.destinationStorage.required||"El campo Almacén destino es requerido."}]},filteredOriginStorageOptions:function(){var e=this;return null==this.movement.fields.originBranchOffice||isNaN(this.movement.fields.originBranchOffice)?[]:this.storageOptions.filter((function(t){return Number(t.branchOffice)===Number(e.movement.fields.originBranchOffice)}))},filteredDestinationStorage:function(){var e=this;return null==this.movement.fields.destinationBranchOffice||isNaN(this.movement.fields.destinationBranchOffice.value)?[]:this.storageOptions2.filter((function(t){return Number(t.branchOffice)===Number(e.movement.fields.destinationBranchOffice.value)&&Number(e.movement.fields.originStorage.value)!==Number(t.value)}))}},beforeRouteEnter:function(e,t,n){n((function(e){var t=e.$store.getters["users/rol"];console.log(t),1===t||3===t||7===t||2===t||20===t||4===t||27===t||22===t?n():n("/")}))},created:function(){this.fetchFromServer()},methods:{fetchFromServer:function(){var e=this;this.$q.loading.show(),a["a"].get("/branch-offices/options").then((function(t){var n=t.data;e.branchOfficeOptions=n.options,e.branchOfficeOptions2=n.options,a["a"].get("/storages/options").then((function(t){var n=t.data;e.storageOptions=n.options,e.storageOptions2=n.options,e.$q.loading.hide()}))}))},invertDate:function(e){if(null!==e)var t=e.split("/").reverse().join("-");return t},createBranchOfficeTransfer:function(){var e=this;if(this.$v.movement.fields.$reset(),this.$v.movement.fields.$touch(),this.$v.movement.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=[];t.date=this.invertDate(this.movement.fields.date),t.originStorage=Number(s()({},this.movement.fields).originStorage.value),t.destinationStorage=Number(s()({},this.movement.fields).destinationStorage.value),t.status=s()({},this.movement.fields).statusStr,console.log(t),a["a"].post("/branch-transfers",t).then((function(t){var n=t.data;console.log(n),e.$q.notify({message:n.message.content,position:"top",color:n.result?"positive":"warning"}),n.result?(e.$q.loading.hide(),e.$router.push("/movements/".concat(n.branchTransfer.id))):e.$q.loading.hide()}))}}},f=d,m=n("2877"),u=n("9989"),v=n("ead5"),p=n("079e"),g=n("ddd8"),h=n("0016"),b=n("7cbe"),q=n("52ee"),O=n("27f9"),S=n("9c40"),y=n("eebe"),k=n.n(y),$=Object(m["a"])(f,o,i,!1,null,null,null);t["default"]=$.exports;k()($,"components",{QPage:u["a"],QBreadcrumbs:v["a"],QBreadcrumbsEl:p["a"],QSelect:g["a"],QIcon:h["a"],QPopupProxy:b["a"],QDate:q["a"],QInput:O["a"],QBtn:S["a"]})}}]);