(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[157],{"898d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"bg-grey-3"},[a("div",{staticClass:"q-pa-sm panel-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-8"},[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[a("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),a("q-breadcrumbs-el",{attrs:{label:"Solicitud de vacaciones"}})],1)],1)]),a("div",{staticClass:"col-sm-4 pull-right"})])]),a("div",{staticClass:"q-pa-md bg-grey-3"},[a("div",{staticClass:"row bg-white border-panel"},[a("div",{staticClass:"col q-pa-md"},[a("div",{staticClass:"row q-mb-sm"},[a("div",{staticClass:"col-xs-12 col-md-3",staticStyle:{"padding-bottom":"1%"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:[{value:!0,label:"APROBADOS"},{value:!1,label:"NO APROBADOS"}],label:"Estado"},on:{input:function(t){return e.getRequestStatus()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"battery_full"}})]},proxy:!0}]),model:{value:e.status,callback:function(t){e.status=t},expression:"status"}})],1),a("div",{staticClass:"col-xs-12 col-md-5",staticStyle:{"padding-bottom":"1%","padding-left":"1%"}},[a("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"","use-input":"","input-debounce":"0",options:e.filterEmployeesOptions,label:"Empleados"},on:{filter:e.filterEmployees,input:function(t){return e.getSelectEmployees(e.employeeOption.value)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"battery_full"}})]},proxy:!0}]),model:{value:e.employeeOption,callback:function(t){e.employeeOption=t},expression:"employeeOption"}})],1)]),a("q-table",{attrs:{flat:"",bordered:"",data:e.data,columns:e.status.value?e.columnsTrue:e.columnsFalse,"row-key":"code",pagination:e.pagination,filter:e.filter},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"employee",staticStyle:{"text-align":"left"},attrs:{props:t}},[e._v(e._s(t.row.name))]),a("q-td",{key:"date",staticStyle:{"text-align":"center"},attrs:{props:t}},[e._v(e._s(t.row.date_requested.substr(8,9)+"/"+t.row.date_requested.substr(5,2)+"/"+t.row.date_requested.substr(0,4)))]),a("q-td",{key:"status",attrs:{props:t}},[a("q-chip",{staticStyle:{"text-align":"center"},attrs:{square:"",dense:"",color:!0===t.row.status?"positive":"negative","text-color":"white"}},[e._v("\n                  "+e._s(t.row.status?"APROBADO":"NO APROBADO")+"\n                ")])],1),t.row.status?e._e():a("q-td",{key:"actions",staticStyle:{"text-align":"center"},attrs:{props:t}},[a("q-btn",{attrs:{color:"positive",icon:"check_circle_outline",flat:"",size:"10px"},nativeOn:{click:function(a){return e.approveRequestRow(t.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Aprobar")])],1),a("q-btn",{attrs:{color:"negative",icon:"do_not_disturb_on",flat:"",size:"10px"},nativeOn:{click:function(a){return e.deniedRequestRow(t.row.id)}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Denegar")])],1)],1)],1)]}}])})],1)])])])},o=[],n=(a("caad"),a("2532"),a("4de4"),a("d3b7"),a("aabb")),i={name:"IndexVacation",data:function(){return{pagination:{sortBy:"code",descending:!1,rowsPerPage:25},columnsTrue:[{name:"employee",align:"center",label:"EMPLEADO",field:"employee",sortable:!0},{name:"date",align:"center",label:"FECHA SOLICITADA",field:"date",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",sortable:!0}],columnsFalse:[{name:"employee",align:"center",label:"EMPLEADO",field:"employee",sortable:!0},{name:"date",align:"center",label:"FECHA SOLICITADA",field:"date",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],data:[],filter:"",status:{value:!1,label:"NO APROBADOS"},employees:[],employeeOption:null,filterEmployeesOptions:[]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(4)||this.$store.getters["users/roles"].includes(5)||this.$router.push("/")},mounted:function(){this.fetchFromServer()},methods:{filterEmployees:function(e,t){var a=this;t((function(){var t=e.toLowerCase();a.filterEmployeesOptions=a.employees.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1})),console.log(a.filterEmployeesOptions)}))},fetchFromServer:function(){var e=this;this.$q.loading.show(),n["a"].get("/vacations/vacationRequest").then((function(t){var a=t.data;e.data=a.vacationsRequest,e.getEmployeesFilter(),e.$q.loading.hide()}))},approveRequestRow:function(e){var t=this;n["a"].put("/vacations/approve-request/".concat(e)).then((function(e){var a=e.data;t.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning"}),t.fetchFromServer()}))},getRequestStatus:function(){var e=this;this.employeeOption=null,this.status.value?(this.$q.loading.show(),n["a"].get("/vacations/vacationRequestTrue").then((function(t){var a=t.data;e.data=a.vacationsRequest,e.getEmployeesFilter(),e.$q.loading.hide()}))):(this.$q.loading.show(),n["a"].get("/vacations/vacationRequest").then((function(t){var a=t.data;e.data=a.vacationsRequest,e.getEmployeesFilter(),e.$q.loading.hide()})))},getEmployeesFilter:function(){var e=this;n["a"].get("/employees/options").then((function(t){var a=t.data;e.employees=a.options}))},deniedRequestRow:function(e){var t=this;this.$q.dialog({title:"Confirmación",message:"¿Desea denegar esta solicitud?",persistent:!0,ok:{label:"Aceptar",color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk((function(){n["a"].delete("/vacations/deniedRequest/".concat(e)).then((function(e){var a=e.data;t.$q.notify({message:a.message.content,position:"top",color:a.result?"positive":"warning",icon:a.result?"thumb_up":"close"}),a.result&&t.fetchFromServer()}))})).onCancel((function(){}))},getSelectEmployees:function(e){var t=this;this.status.value?(this.$q.loading.show(),n["a"].get("/vacations/vacationRequestFilterTrue/".concat(e)).then((function(e){var a=e.data;t.data=a.vacationsRequestFilter,t.$q.loading.hide()}))):(this.$q.loading.show(),n["a"].get("/vacations/vacationRequestFilter/".concat(e)).then((function(e){var a=e.data;t.data=a.vacationsRequestFilter,t.$q.loading.hide()})))}}},l=i,r=a("2877"),c=a("9989"),u=a("ead5"),d=a("079e"),p=a("ddd8"),m=a("0016"),g=a("eaac"),v=a("bd08"),f=a("db86"),b=a("b047"),q=a("9c40"),h=a("05c0"),y=a("eebe"),w=a.n(y),O=Object(r["a"])(l,s,o,!1,null,null,null);t["default"]=O.exports;w()(O,"components",{QPage:c["a"],QBreadcrumbs:u["a"],QBreadcrumbsEl:d["a"],QSelect:p["a"],QIcon:m["a"],QTable:g["a"],QTr:v["a"],QTd:f["a"],QChip:b["a"],QBtn:q["a"],QTooltip:h["a"]})}}]);