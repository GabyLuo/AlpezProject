(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[190],{a8d9:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"bg-grey-3"},[i("div",{staticClass:"q-pa-sm panel-header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-9"},[i("div",{staticClass:"q-pa-md q-gutter-sm"},[i("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[i("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),i("q-breadcrumbs-el",{attrs:{label:"Embarques",to:"/trips"}}),i("q-breadcrumbs-el",{attrs:{label:"Nuevo embarque"}})],1)],1)])])]),i("div",{staticClass:"q-pa-md bg-grey-3"},[i("div",{staticClass:"row bg-white border-panel"},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-mb-sm"}),i("div",{staticClass:"row q-col-gutter-xs"},[i("div",{staticClass:"col-xs-12 col-sm-2 col-md-2 col-lg-2"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.trip.fields.invoice_id.$error,label:"Remision / Factura",rules:e.invoiceRules,options:e.invoicesOptionsFilter,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.filterInvoices},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"fact_check"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:e.trip.fields.invoice_id,callback:function(t){e.$set(e.trip.fields,"invoice_id",t)},expression:"trip.fields.invoice_id"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.dateRules,error:e.$v.trip.fields.date.$error,mask:"DD/MM/YYYY HH:mm:ss",label:"Fecha"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.trip.fields.date,callback:function(t){e.$set(e.trip.fields,"date",t)},expression:"trip.fields.date"}},[i("q-popup-proxy",{ref:"date_ref",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-6"},[i("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY HH:mm:ss"},model:{value:e.trip.fields.date,callback:function(t){e.$set(e.trip.fields,"date",t)},expression:"trip.fields.date"}})],1),i("div",{staticClass:"col-sm-6"},[i("q-time",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY HH:mm:ss","now-btn":""},on:{input:function(){return e.$refs.date_ref.hide()}},model:{value:e.trip.fields.date,callback:function(t){e.$set(e.trip.fields,"date",t)},expression:"trip.fields.date"}})],1)])])],1)],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.trip.fields.vehicle_id.$error,label:"Número de unidad",rules:e.vehicle_idRules,options:e.economicNumberOptions,"emit-value":"","map-options":""},on:{input:function(t){return e.getVehicleData()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"tag"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No hay Resultados\n                  ")])],1)]},proxy:!0}]),model:{value:e.trip.fields.vehicle_id,callback:function(t){e.$set(e.trip.fields,"vehicle_id",t)},expression:"trip.fields.vehicle_id"}})],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Tipo de vehículo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_numbered"}})]},proxy:!0}]),model:{value:e.vehicle.fields.type,callback:function(t){e.$set(e.vehicle.fields,"type",t)},expression:"vehicle.fields.type"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Marca de vehículo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"book"}})]},proxy:!0}]),model:{value:e.vehicle.fields.brand,callback:function(t){e.$set(e.vehicle.fields,"brand",t)},expression:"vehicle.fields.brand"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Modelo de vehiculo","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_bulleted"}})]},proxy:!0}]),model:{value:e.vehicle.fields.model,callback:function(t){e.$set(e.vehicle.fields,"model",t)},expression:"vehicle.fields.model"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",disable:"",label:"Placas","emit-value":"","map-options":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"format_list_bulleted"}})]},proxy:!0}]),model:{value:e.vehicle.fields.plate,callback:function(t){e.$set(e.vehicle.fields,"plate",t)},expression:"vehicle.fields.plate"}})],1)]),i("div",{staticClass:"row q-mb-sm q-mt-md"},[i("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[i("q-btn",{attrs:{color:"positive",icon:"save",label:"Guardar"},on:{click:function(t){return e.createTrip()}}})],1)])])])])])},o=[],r=i("ded3"),n=i.n(r),l=(i("caad"),i("2532"),i("a15b"),i("ac1f"),i("1276"),i("a9e3"),i("4de4"),i("d3b7"),i("aabb")),a=i("b5ae"),c=a.required,d={name:"NewTrip",validations:{trip:{fields:{date:{required:c},vehicle_id:{required:c},invoice_id:{required:c}}}},data:function(){return{trip:{fields:{date:null,vehicle_id:null,invoice_id:null}},vehicle:{fields:{type:null,brand:null,model:null}},driversOptions:[],destinysOptions:[],economicNumberOptions:[],driversOptionsFilter:[],destinysOptionsFilter:[],invoicesOptions:[],invoicesOptionsFilter:[]}},mounted:function(){this.$q.loading.show(),this.getEconomicNumber(),this.getInvoices(),this.$q.loading.hide()},computed:{invoiceRules:function(e){var t=this;return[function(e){return t.$v.trip.fields.invoice_id.required||"El campo Remision / Factura es requerido."}]},driverRules:function(e){var t=this;return[function(e){return t.$v.trip.fields.driver.required||"El campo Chofer es requerido."}]},destinyRules:function(e){var t=this;return[function(e){return t.$v.trip.fields.destiny.required||"El campo Destino es requerido."}]},dateRules:function(e){var t=this;return[function(e){return t.$v.trip.fields.date.required||"El campo Fecha es requerido."}]},vehicle_idRules:function(e){var t=this;return[function(e){return t.$v.trip.fields.vehicle_id.required||"El campo Número de unidad es requerido."}]}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(8)||this.$router.push("/")},methods:{createTrip:function(){var e=this;if(this.$v.trip.fields.$reset(),this.$v.trip.fields.$touch(),this.$v.trip.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=n()({},this.trip.fields);t.date=this.trip.fields.date.split(" ")[0].split("/").reverse().join("-")+" "+this.trip.fields.date.split(" ")[1],l["a"].post("/trips",t).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.$q.loading.hide(),e.$router.push("/trips/".concat(Number(i.id)))):e.$q.loading.hide()}))},getDrivers:function(){var e=this;l["a"].get("drivers/options").then((function(t){e.driversOptions=t.data.options}))},filterDrivers:function(e,t,i){var s=this;t((function(){var t=e.toLowerCase();s.driversOptionsFilter=s.driversOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},getDestinys:function(){var e=this;l["a"].get("ranges/options").then((function(t){e.destinysOptions=t.data.options}))},filterDestinys:function(e,t,i){var s=this;t((function(){var t=e.toLowerCase();s.destinysOptionsFilter=s.destinysOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},getEconomicNumber:function(){var e=this;l["a"].get("vehicle/options").then((function(t){e.economicNumberOptions=t.data.options}))},getVehicleData:function(){var e=this,t=this.trip.fields.vehicle_id;l["a"].get("vehicle/vehicle-data/".concat(t)).then((function(t){console.log(t),e.vehicle.fields=t.data.vehicle}))},getInvoices:function(){var e=this;l["a"].get("invoices/invoicesTripOptions").then((function(t){e.invoicesOptions=t.data.options}))},filterInvoices:function(e,t,i){var s=this;t((function(){var t=e.toLowerCase();s.invoicesOptionsFilter=s.invoicesOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))}}},u=d,p=i("2877"),f=i("9989"),v=i("ead5"),m=i("079e"),h=i("ddd8"),b=i("0016"),q=i("66e5"),g=i("4074"),y=i("7cbe"),$=i("52ee"),x=i("ca78"),_=i("27f9"),k=i("9c40"),C=i("eebe"),w=i.n(C),O=Object(p["a"])(u,s,o,!1,null,null,null);t["default"]=O.exports;w()(O,"components",{QPage:f["a"],QBreadcrumbs:v["a"],QBreadcrumbsEl:m["a"],QSelect:h["a"],QIcon:b["a"],QItem:q["a"],QItemSection:g["a"],QPopupProxy:y["a"],QDate:$["a"],QTime:x["a"],QInput:_["a"],QBtn:k["a"]})}}]);