(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[122],{ecfd:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"bg-grey-3"},[s("div",{staticClass:"q-pa-sm panel-header"},[s("div",{staticClass:"row q-col-gutter-xs q-col-gutter-md"},[s("div",{staticClass:"col-sm-4",staticStyle:{"font-size":"20px"}},[s("div",{staticClass:"q-pa-md q-gutter-sm"},[s("q-breadcrumbs",[s("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),s("q-breadcrumbs-el",{attrs:{label:"Reporte de Ventas"}})],1)],1)]),s("div",{staticClass:"col-sm-8"},[s("div",{staticClass:"col-xs-12 col-md-4 offset-md-10 pull-right"},[s("div",[1===e.roleId||3===e.roleId||7===e.roleId||2===e.roleId||17===e.roleId||20===e.roleId?s("q-btn",{staticStyle:{"margin-left":"10px"},attrs:{color:"green",label:"Generar CSV",icon:"fas fa-file-excel"},on:{click:function(t){return e.generateCSV()}}}):e._e(),1===e.roleId||3===e.roleId||7===e.roleId||2===e.roleId||17===e.roleId||20===e.roleId?s("q-btn",{staticStyle:{"margin-left":"10px"},attrs:{color:"red",label:"Generar PDF",icon:"fas fa-file-pdf"},on:{click:function(t){return e.generatePDF()}}}):e._e()],1)])])])]),s("div",{staticClass:"q-pa-md bg-grey-3"},[s("div",{staticClass:"row bg-white border-panel"},[s("div",{staticClass:"col q-pa-md"},[s("div",{staticClass:"row q-col-gutter-xs q-col-gutter-md"},[s("div",{staticClass:"col-sm-2"}),s("div",{staticClass:"col-md-2"},[s("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Desde"},model:{value:e.saleDatev1,callback:function(t){e.saleDatev1=t},expression:"saleDatev1"}},[s("q-popup-proxy",{ref:"date",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("div",{staticClass:"col-sm-12"},[s("q-date",{attrs:{"today-btn":""},on:{input:function(t){return e.filterGrid()}},model:{value:e.saleDatev1,callback:function(t){e.saleDatev1=t},expression:"saleDatev1"}})],1)])],1)],1),s("div",{staticClass:"col-md-2"},[s("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Hasta"},model:{value:e.saleDatev2,callback:function(t){e.saleDatev2=t},expression:"saleDatev2"}},[s("q-popup-proxy",{ref:"date",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("div",{staticClass:"col-sm-12"},[s("q-date",{attrs:{"today-btn":""},on:{input:function(t){return e.filterGrid()}},model:{value:e.saleDatev2,callback:function(t){e.saleDatev2=t},expression:"saleDatev2"}})],1)])],1)],1),s("div",{staticClass:"col-sm-2"},[s("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.branchOptionsG,"emit-value":"","map-options":"",label:"Sucursal"},on:{input:function(t){return e.filterGrid()}},model:{value:e.branchG,callback:function(t){e.branchG=t},expression:"branchG"}})],1),s("div",{staticClass:"col-sm-2"},[s("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.filteredCustomerOptions2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Cliente","emit-value":"","map-options":""},on:{filter:e.filtrarClientes2,input:function(t){return e.filterGrid()}},model:{value:e.customerG,callback:function(t){e.customerG=t},expression:"customerG"}})],1),s("div",{staticClass:"col-sm-2"},[s("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.sellerOptionsG,"emit-value":"","map-options":"",label:"Vendedor"},on:{input:function(t){return e.filterGrid()}},model:{value:e.sellerG,callback:function(t){e.sellerG=t},expression:"sellerG"}})],1)]),s("div",{staticStyle:{"padding-top":"20px"}},[s("q-table",{attrs:{flat:"",bordered:"",data:e.data,columns:e.columns,"row-key":"code",pagination:e.pagination,filter:e.filter},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[s("div",{staticStyle:{width:"100%"}},[s("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},on:{input:function(t){e.filter=t.toUpperCase()}},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[s("q-tr",{attrs:{props:t}},[s("q-td",{key:"date",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.date))]),s("q-td",{key:"invoice",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.invoice))]),s("q-td",{key:"branchofficeorigin",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.branchofficeorigin))]),s("q-td",{key:"customer",staticStyle:{width:"20%"},attrs:{props:t}},[e._v(e._s(t.row.customer_name))]),s("q-td",{key:"product",staticStyle:{width:"20%"},attrs:{props:t}},[e._v(e._s(t.row.product))]),s("q-td",{key:"user_name",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.user_name))]),s("q-td",{key:"total",staticStyle:{width:"10%","text-align":"right"},attrs:{props:t}},[e._v(e._s(""+e.currencyFormatter.format(Number(t.row.total))))])],1)]}}])})],1)])])])])},l=[],r=(s("caad"),s("2532"),s("4de4"),s("d3b7"),s("ac1f"),s("5319"),s("99af"),s("aabb")),o=s("b5ae"),i=o.required,n={name:"IndexShoppingCarts",validations:{customer:{required:i},branch:{required:i},seller:{required:i},clientofficeDestiny:{required:i}},data:function(){return{currencyFormatter:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),formatter:new Intl.NumberFormat("en-US"),role:null,modalPedido:!1,modalClient:!1,customer:null,saleDatev1:null,saleDatev2:null,clientofficeDestiny:null,customerG:null,seller:null,sellerG:"TODOS",branch:null,branchG:"TODOS",status:"TODOS",customerOptions:[],customerOptionsG:[],officeClientsOptions:[],sellerOptions:[],sellerOptionsG:[],branchOffices:[],branchOptions:[],branchOptionsG:[],filteredCustomerOptions:[],filteredCustomerOptions2:[],dataClient:{fields:{id:null,client:null,address:null,phone:null,term:null}},pagination:{sortBy:"id",descending:!0,rowsPerPage:25},columns:[{name:"date",align:"center",label:"FECHA",field:"date",style:"width: 10%",sortable:!0},{name:"invoice",align:"center",label:"N. REMISIÃ“N",field:"invoice",style:"width: 10%",sortable:!0},{name:"branchofficeorigin",align:"center",label:"SUCURSAL DE VENTA",field:"branchofficeorigin",style:"width: 10%",sortable:!0},{name:"customer",align:"left",label:"CLIENTE",field:"customer",style:"width: 20%",sortable:!0},{name:"product",align:"left",label:"PRODUCTO",field:"product",style:"width: 20%",sortable:!0},{name:"user_name",align:"left",label:"VENDEDOR",field:"user_name",style:"width: 10%",sortable:!0},{name:"total",align:"center",label:"MONTO (NETO)",field:"total",style:"width: 10%",sortable:!0}],data:[],filter:""}},computed:{roleId:function(){var e=this.$store.getters["users/rol"];return parseInt(e)},haspermissionv1:function(){var e=!1;return(this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(12)||this.$store.getters["users/roles"].includes(17))&&(e=!0),e},haspermissionv2:function(){var e=!1;return(this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(20)||this.$store.getters["users/roles"].includes(12))&&(e=!0),e}},beforeRouteEnter:function(e,t,s){s((function(e){var t=e.$store.getters["users/rol"];console.log(t),1===t||2===t||12===t||17===t||3===t||20===t||3===t?s():s("/")}))},mounted:function(){this.getClients(),this.getSellers(),this.fetchFromServer(),this.getBranches()},methods:{getClients:function(){var e=this;r["a"].get("/customers/options").then((function(t){var s=t.data;e.customerOptions=s.options,e.customerOptionsG=s.options,e.customerOptionsG.push({label:"TODOS",value:"TODOS"})}))},getSellers:function(){var e=this;r["a"].get("/users/getSeller").then((function(t){var s=t.data;e.sellerOptionsG=s.options,e.sellerOptionsG.push({label:"TODOS",value:"TODOS"}),e.$q.loading.hide()}))},getBranches:function(){var e=this;r["a"].get("/branch-offices/options").then((function(t){var s=t.data;e.branchOptionsG=s.options,e.branchOptionsG.push({label:"TODOS",value:"TODOS"}),e.$q.loading.hide()}))},fetchFromServer:function(){var e=this;this.role=this.$store.getters["users/roles"][0],console.log(this.$store.getters),this.$q.loading.show(),this.data=[];var t=[];t.customer=this.customerG,t.branch=this.branchG,t.seller=this.sellerG,t.sellerId=this.$store.getters["users/id"],t.saleDatev1=this.saleDatev1,t.saleDatev2=this.saleDatev2,t.sellerId=this.$store.getters["users/id"],console.log(t),r["a"].post("/sales-reports/getGridReport",t).then((function(t){var s=t.data;e.data=s.shoppingCarts,e.$q.loading.hide()}))},filtrarClientes2:function(e,t,s){var a=this;t((function(){var t=e.toLowerCase();a.filteredCustomerOptions2=a.customerOptionsG.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},filterGrid:function(){var e=this;this.data=[];var t=[];t.customer=this.customerG,t.branch=this.branchG,t.seller=this.sellerG,t.sellerId=this.$store.getters["users/id"],t.saleDatev1=this.saleDatev1,t.saleDatev2=this.saleDatev2,console.log(t),r["a"].post("/sales-reports/getGridReport",t).then((function(t){var s=t.data;s.result&&(e.data=s.shoppingCarts)}))},generatePDF:function(){var e=[];if(e.customer=this.customerG,e.branch=this.branchG,e.seller=this.sellerG,this.saleDatev1){e.saleDatev1=this.saleDatev1;while(e.saleDatev1.includes("/"))e.saleDatev1=e.saleDatev1.replace("/","-")}else e.saleDatev1=null;if(this.saleDatev2){e.saleDatev2=this.saleDatev2;while(e.saleDatev2.includes("/"))e.saleDatev2=e.saleDatev2.replace("/","-")}else e.saleDatev2=null;var t="https://api_alpez.wasp.mx/"+"sales-reports/getPdfFromShoppingCarts/".concat(e.customer,"/").concat(e.branch,"/").concat(e.seller,"/").concat(e.saleDatev1,"/").concat(e.saleDatev2);window.open(t,"_blank")},generateCSV:function(){var e=[];if(e.customer=this.customerG,e.status=this.status,e.seller=this.sellerG,this.saleDatev1){e.saleDatev1=this.saleDatev1;while(e.saleDatev1.includes("/"))e.saleDatev1=e.saleDatev1.replace("/","-")}else e.saleDatev1=null;if(this.saleDatev2){e.saleDatev2=this.saleDatev2;while(e.saleDatev2.includes("/"))e.saleDatev2=e.saleDatev2.replace("/","-")}else e.saleDatev2=null;var t="https://api_alpez.wasp.mx/"+"sales-reports/getCSVFromShoppingCarts/".concat(e.customer,"/").concat(e.status,"/").concat(e.seller,"/").concat(e.saleDatev1,"/").concat(e.saleDatev2);window.open(t,"_blank")}}},c=n,d=s("2877"),u=s("9989"),p=s("ead5"),h=s("079e"),f=s("9c40"),v=s("05c0"),m=s("ddd8"),b=s("7cbe"),g=s("52ee"),D=s("eaac"),y=s("27f9"),w=s("0016"),O=s("bd08"),C=s("db86"),G=s("eebe"),q=s.n(G),S=Object(d["a"])(c,a,l,!1,null,null,null);t["default"]=S.exports;q()(S,"components",{QPage:u["a"],QBreadcrumbs:p["a"],QBreadcrumbsEl:h["a"],QBtn:f["a"],QTooltip:v["a"],QSelect:m["a"],QPopupProxy:b["a"],QDate:g["a"],QTable:D["a"],QInput:y["a"],QIcon:w["a"],QTr:O["a"],QTd:C["a"]})}}]);