(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[85],{"0f75":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"bg-grey-3"},[o("div",{staticClass:"q-pa-sm panel-header"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-sm-8"},[o("div",{staticClass:"q-pa-md q-gutter-sm"},[o("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"left"}},[o("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),o("q-breadcrumbs-el",{attrs:{label:"Movimientos",to:"/movements"}}),5!==e.movement.fields.type_id&&4!==e.movement.fields.type_id?o("q-breadcrumbs-el",{attrs:{label:"Editar Movimiento"},domProps:{textContent:e._s(e.movement.fields.folio)}}):e._e(),5===e.movement.fields.type_id||4===e.movement.fields.type_id?o("q-breadcrumbs-el",{attrs:{label:"Editar Movimiento"},domProps:{textContent:e._s(e.movement_transfer.fields.folio_1)}}):e._e()],1)],1)]),e.execute?o("div",{staticClass:"col-sm-4 pull-right"},[o("div",{staticClass:"q-pa-sm q-gutter-sm"},[o("q-btn",{staticClass:"q-mr-sm",attrs:{color:"red",icon:"fas fa-file-pdf"},on:{click:function(t){return e.generatePDF()}}},[o("q-tooltip",{attrs:{"content-class":"bg-positive"}},[e._v("Generar Reporte")])],1)],1)]):e._e(),e.execute?e._e():o("div",{staticClass:"col-sm-4 pull-right"},[o("div",{staticClass:"q-pa-sm q-gutter-sm"},[0===e.dataMD.length||e.canModify?e._e():o("q-btn",{attrs:{color:"positive",icon:"offline_bolt",label:"Ejecutar"},on:{click:function(t){return e.executeMovement()}}})],1)])])]),o("div",{staticClass:"q-pa-md bg-grey-3"},[o("div",{staticClass:"row bg-white border-panel"},[o("div",{staticClass:"col q-pa-md"},[5!==e.movement.fields.type_id&&4!==e.movement.fields.type_id?o("div",{staticClass:"row q-col-gutter-xs"},[o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"white","bg-color":e.color,filled:"",dark:"",readonly:"",filter:"",label:"Tipo de Movimiento"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"swap_horiz"}})]},proxy:!0}],null,!1,3738321024),model:{value:e.movement.fields.type_movement,callback:function(t){e.$set(e.movement.fields,"type_movement",t)},expression:"movement.fields.type_movement"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:e.execute,mask:"date",rules:e.dateRules,label:"Fecha",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"event"}})]},proxy:!0}],null,!1,3703588864),model:{value:e.movement.fields.date,callback:function(t){e.$set(e.movement.fields,"date",t)},expression:"movement.fields.date"}},[o("q-popup-proxy",{ref:"date_ref",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("div",{staticClass:"col-sm-12"},[o("q-date",{attrs:{readonly:e.execute,color:"secondary","text-color":"white",locale:e.myLocale,disable:e.canModify,mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return e.$refs.date_ref.hide()}},model:{value:e.movement.fields.date,callback:function(t){e.$set(e.movement.fields,"date",t)},expression:"movement.fields.date"}})],1)])],1)],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:"",label:"Folio",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement.fields.folio,callback:function(t){e.$set(e.movement.fields,"folio",t)},expression:"movement.fields.folio"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:e.execute,options:e.branchesList,rules:e.branchOfficeRules,error:e.$v.movement.fields.branch.$error,label:"Estación",disable:e.canModify},on:{input:function(){return e.movement.fields.storage=""}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"business"}})]},proxy:!0}],null,!1,3736652810),model:{value:e.movement.fields.branch,callback:function(t){e.$set(e.movement.fields,"branch",t)},expression:"movement.fields.branch"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:e.execute,options:e.filteredStorageOptions,rules:e.storageRules,error:e.$v.movement.fields.storage.$error,label:"Almacén",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"store"}})]},proxy:!0}],null,!1,2983772019),model:{value:e.movement.fields.storage,callback:function(t){e.$set(e.movement.fields,"storage",t)},expression:"movement.fields.storage"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-input",{attrs:{color:"dark",dark:"","bg-color":"NUEVO"===e.movement.fields.status?"blue":"EJECUTADO"===e.movement.fields.status?"positive":(e.movement.fields.status,"negative"),filled:"",readonly:"","emit-value":"",label:"Estatus"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-info"}})]},proxy:!0}],null,!1,3840796732),model:{value:e.movement.fields.status,callback:function(t){e.$set(e.movement.fields,"status",t)},expression:"movement.fields.status"}})],1),o("div",{staticClass:"col-xs-12 col-sm-12 pull-right"},[o("div",{staticClass:"q-pa-sm q-gutter-sm"},[e.canModify?e._e():o("q-btn",{attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(t){return e.updateMovement()}}})],1)])]):e._e(),o("div",{staticClass:"row q-col-gutter-xs"}),5===e.movement.fields.type_id||4===e.movement.fields.type_id?o("div",{staticClass:"row q-col-gutter-xs"},[o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.dateRulesTransfer,mask:"date",label:"Fecha"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"event"}})]},proxy:!0}],null,!1,3703588864),model:{value:e.movement_transfer.fields.date,callback:function(t){e.$set(e.movement_transfer.fields,"date",t)},expression:"movement_transfer.fields.date"}},[o("q-popup-proxy",{ref:"date",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("div",{staticClass:"col-sm-12"},[o("q-date",{attrs:{color:"secondary","text-color":"white",mask:"DD/MM/YYYY","today-btn":""},model:{value:e.movement_transfer.fields.date,callback:function(t){e.$set(e.movement_transfer.fields,"date",t)},expression:"movement_transfer.fields.date"}})],1)])],1)],1),o("div",{staticClass:"col-sm-12 col-md-2"},[o("q-input",{attrs:{color:"dark",dark:"","bg-color":"NUEVO"===e.movement_transfer.fields.statusStr?"blue":"EJECUTADO"===e.movement_transfer.fields.statusStr?"positive":(e.movement_transfer.fields.statusStr,"negative"),filled:"",label:"Estatus",readonly:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"battery_full"}})]},proxy:!0}],null,!1,131294317),model:{value:e.movement_transfer.fields.statusStr,callback:function(t){e.$set(e.movement_transfer.fields,"statusStr",t)},expression:"movement_transfer.fields.statusStr"}})],1)]):e._e(),5===e.movement.fields.type_id||4===e.movement.fields.type_id?o("div",{staticClass:"row q-col-gutter-xs"},[o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"white","bg-color":"negative",filled:"",dark:"",readonly:"",filter:"",label:"Tipo de Movimiento"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"swap_horiz"}})]},proxy:!0}],null,!1,3738321024),model:{value:e.movement_transfer.fields.type_movement_1,callback:function(t){e.$set(e.movement_transfer.fields,"type_movement_1",t)},expression:"movement_transfer.fields.type_movement_1"}})],1),o("div",{staticClass:"col-sm-12 col-md-4"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.branchOfficeOptions,label:"Estación origen","emit-value":"","map-options":"",rules:e.originBranchOfficeRules},on:{input:function(){return e.movement_transfer.fields.originStorage=""}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-store-alt"}})]},proxy:!0}],null,!1,3573032505),model:{value:e.movement_transfer.fields.originBranchOffice,callback:function(t){e.$set(e.movement_transfer.fields,"originBranchOffice",t)},expression:"movement_transfer.fields.originBranchOffice"}})],1),o("div",{staticClass:"col-sm-12 col-md-4"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.filteredOriginStorageOptions,label:"Almacén origen",rules:e.originStorageRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-warehouse"}})]},proxy:!0}],null,!1,3703881239),model:{value:e.movement_transfer.fields.originStorage,callback:function(t){e.$set(e.movement_transfer.fields,"originStorage",t)},expression:"movement_transfer.fields.originStorage"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:"",label:"Folio"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement_transfer.fields.folio_1,callback:function(t){e.$set(e.movement_transfer.fields,"folio_1",t)},expression:"movement_transfer.fields.folio_1"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-select",{attrs:{color:"white","bg-color":"positive",filled:"",dark:"",readonly:"",filter:"",label:"Tipo de Movimiento"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"swap_horiz"}})]},proxy:!0}],null,!1,3738321024),model:{value:e.movement_transfer.fields.type_movement_2,callback:function(t){e.$set(e.movement_transfer.fields,"type_movement_2",t)},expression:"movement_transfer.fields.type_movement_2"}})],1),o("div",{staticClass:"col-sm-12 col-md-4"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.branchOfficeOptions2,label:"Estación destino",rules:e.destinationBranchOfficeRules},on:{input:function(){return e.movement_transfer.fields.destinationStorage=""}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-store-alt"}})]},proxy:!0}],null,!1,3573032505),model:{value:e.movement_transfer.fields.destinationBranchOffice,callback:function(t){e.$set(e.movement_transfer.fields,"destinationBranchOffice",t)},expression:"movement_transfer.fields.destinationBranchOffice"}})],1),o("div",{staticClass:"col-sm-12 col-md-4"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",options:e.filteredDestinationStorage,label:"Almacén destino",rules:e.destinationStorageRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-warehouse"}})]},proxy:!0}],null,!1,3703881239),model:{value:e.movement_transfer.fields.destinationStorage,callback:function(t){e.$set(e.movement_transfer.fields,"destinationStorage",t)},expression:"movement_transfer.fields.destinationStorage"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:"",label:"Folio"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement_transfer.fields.folio_1,callback:function(t){e.$set(e.movement_transfer.fields,"folio_1",t)},expression:"movement_transfer.fields.folio_1"}})],1),o("div",{staticClass:"col-xs-12 col-sm-12 pull-right"},[o("div",{staticClass:"q-pa-sm q-gutter-sm"},[o("q-btn",{attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(t){return e.updateMovement()}}})],1)])]):e._e()])]),o("div",{staticClass:"bg-grey-3",staticStyle:{"padding-top":"17px"}},[o("div",{staticClass:"q-gutter-y-md",staticStyle:{width:"100%"}},[o("q-card",[o("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[o("q-tab",{attrs:{name:"details",icon:"info",label:"DETALLES DE MOVIMIENTO"}}),o("q-tab",{attrs:{name:"notes",icon:"speaker_notes",label:"COMENTARIOS"}})],1),o("q-tab-panels",{attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[o("q-tab-panel",{attrs:{name:"details"}},[o("div",{staticClass:"row bg-white border-panel",staticStyle:{"margin-top":"16px"}},[o("div",{staticClass:"col q-pa-md"},[o("div",{staticClass:"row q-col-gutter-xs"},[o("div",{staticClass:"col-xs-12 col-sm-8",staticStyle:{"font-size":"20px","margin-top":"8px"}},[o("span",[e._v("Detalles del movimiento")])]),"INVENTARIO FÍSICO"===this.movement.fields.type_movement?o("div",{staticClass:"col-xs-12 col-sm-12 pull-right",staticStyle:{"font-size":"20px","margin-bottom":"8px"}},[o("q-btn",{staticStyle:{margin:"2px"},attrs:{color:"positive",icon:"fas fa-file-excel",label:"LAYOUT"},on:{click:function(t){return e.getLayoutCsv()}}}),o("q-btn",{staticStyle:{margin:"2px"},attrs:{color:"positive",icon:"cloud_upload",label:"CARGA MASIVA"},on:{click:function(t){return e.openUploadFileModal()}}})],1):e._e()]),e.execute?e._e():o("div",{staticClass:"row q-col-gutter-xs"},[1===e.movement.fields.type_id||3===e.movement.fields.type_id?o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-select",{attrs:{filled:"",color:"dark","bg-color":"secondary",error:e.$v.movement_details.fields.product.$error,label:"Producto",options:e.options2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0","map-options":"",disable:e.canModify},on:{input:function(t){return e.getUnit()},filter:e.filterProduct},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-grip-lines-vertical"}})]},proxy:!0},{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-grey"},[e._v("\n                        No hay Resultados\n                      ")])],1)]},proxy:!0}],null,!1,1376321069),model:{value:e.movement_details.fields.product,callback:function(t){e.$set(e.movement_details.fields,"product",t)},expression:"movement_details.fields.product"}})],1):e._e(),2===e.movement.fields.type_id||4===e.movement.fields.type_id||5===e.movement.fields.type_id||6===e.movement.fields.type_id?o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"","map-options":"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:e.options2,error:e.$v.movement_details.fields.product.$error,label:"Producto",disable:e.canModify},on:{filter:e.filterProduct,input:function(t){return e.getQtyProducts(e.movement_details.fields.product)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-box"}})]},proxy:!0}],null,!1,2436932391),model:{value:e.movement_details.fields.product,callback:function(t){e.$set(e.movement_details.fields,"product",t)},expression:"movement_details.fields.product"}})],1):e._e(),o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"","emit-value":"","map-options":"",readonly:"",rules:e.unitsRules,error:e.$v.movement_details.fields.unit.$error,label:"Unidad",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-box"}})]},proxy:!0}],null,!1,2436932391),model:{value:e.movement_details.fields.unit,callback:function(t){e.$set(e.movement_details.fields,"unit",t)},expression:"movement_details.fields.unit"}})],1),2===e.movement.fields.type_id||4===e.movement.fields.type_id||5===e.movement.fields.type_id?o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.amountRules,suffix:"/"+e.suffixQty,label:"Cantidad",disable:e.canModify},on:{input:function(t){return e.validateQty(e.movement_details.fields.qty)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement_details.fields.qty,callback:function(t){e.$set(e.movement_details.fields,"qty",t)},expression:"movement_details.fields.qty"}})],1):e._e(),6===e.movement.fields.type_id?o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.amountRules,label:"Cantidad",disable:e.canModify},on:{input:function(t){return e.validateQty(e.movement_details.fields.qty)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement_details.fields.qty,callback:function(t){e.$set(e.movement_details.fields,"qty",t)},expression:"movement_details.fields.qty"}})],1):e._e(),1===e.movement.fields.type_id||3===e.movement.fields.type_id?o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",rules:e.amountRules,label:"Cantidad",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"style"}})]},proxy:!0}],null,!1,2153227579),model:{value:e.movement_details.fields.qty,callback:function(t){e.$set(e.movement_details.fields,"qty",t)},expression:"movement_details.fields.qty"}})],1):e._e(),o("div",{staticClass:"col-xs-12 col-sm-3 text-center"},[1===e.movement.fields.type_id||3===e.movement.fields.type_id?o("q-input",{attrs:{required:e.show,color:"dark","bg-color":"secondary",filled:"",label:"Costo Unitario",disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-dollar-sign"}})]},proxy:!0}],null,!1,1498120564),model:{value:e.movement_details.fields.cost,callback:function(t){e.$set(e.movement_details.fields,"cost",t)},expression:"movement_details.fields.cost"}}):e._e()],1),e.execute?e._e():o("div",{staticClass:"col-sm-12 pull-right"},[e.updateFlag?e._e():o("div",{staticClass:"q-pa-sm q-gutter-sm",staticStyle:{"padding-bottom":"10px"}},[e.canModify?e._e():o("q-btn",{staticClass:"bg-primary",attrs:{color:"positive",icon:"add",label:"Agregar"},on:{click:function(t){return e.addProduct()}}})],1),e.updateFlag?o("div",{staticClass:"q-pa-sm q-gutter-sm",staticStyle:{"padding-bottom":"10px"}},[o("q-btn",{attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(t){return e.updateDetail()}}})],1):e._e()])]),o("div",{staticClass:"row q-mb-sm q-mt-md"},[o("div",{staticClass:"col-sm-12 "},[o("div",{staticClass:"q-pa-sm q-gutter-sm"},[o("q-table",{attrs:{flat:"",bordered:"",data:e.dataMD,pagination:e.pagination,columns:1==e.movement.fields.type_id||2==e.movement.fields.type_id?1==e.movement.fields.type_id?e.columns:e.columnsExit:3==e.movement.fields.type_id||e.columnsTrans||6==e.movement.fields.type_id?e.columnsFisic:e.columnsMerma,filter:e.filter,"row-key":"product_name"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[o("div",{staticStyle:{width:"100%"}},[o("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[o("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[o("q-tr",{attrs:{props:t}},[o("q-td",{key:"code",staticStyle:{"text-align":"center"},attrs:{props:t}},[e._v(e._s(t.row.code))]),o("q-td",{key:"product_name",staticStyle:{width:"20%","text-align":"left"},attrs:{props:t}},[e._v(e._s(t.row.product_name))]),o("q-td",{key:"quantity",staticStyle:{"text-align":"right"},attrs:{props:t}},[e._v(e._s(e.$formatNumberThree(Number(t.row.qty))||0))]),o("q-td",{key:"cost",staticStyle:{"text-align":"right"},attrs:{props:t}},[e._v(e._s("$ "+e.$formatNumberPrice(t.row.cost)))]),o("q-td",{key:"qty",staticStyle:{"text-align":"right"},attrs:{props:t}},[e._v(e._s("$ "+e.$formatNumberPrice(t.row.qty*t.row.cost)))]),3!==e.movement.fields.type_id?o("q-td",{key:"balance",class:t.row.balance<0?"bg-red text-white":"bg-white text-black",attrs:{props:t}},[e._v(e._s(t.row.balance?e.$formatNumberThree(Number(t.row.balance)):e.$formatNumberThree(Number(t.row.qty))))]):e._e(),o("q-td",{key:"actions",staticStyle:{"text-align":"center"},attrs:{props:t}},[e.execute||e.canModify?e._e():o("q-btn",{attrs:{color:"red",flat:"",icon:"fas fa-trash-alt",size:"10px"},nativeOn:{click:function(o){return e.deleteSelectedRow(t.row.id)}}},[o("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Eliminar")])],1),e.execute&&!e.canModify?o("q-icon",{attrs:{name:"check",size:"30px",color:"positive"}},[o("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Ejecutado")])],1):e._e()],1)],1)]}}])})],1)])])])])]),o("q-tab-panel",{attrs:{name:"notes"}},[o("div",{staticClass:"row bg-white border-panel",staticStyle:{"margin-top":"16px"}},[o("div",{staticClass:"col q-pa-md"},[o("div",{staticClass:"row q-col-gutter-xs"},[o("div",{staticClass:"col-xs-12 col-sm-12",staticStyle:{"font-size":"20px","margin-top":"8px"}},[o("span",[e._v("Comentarios")])]),o("div",{staticClass:"col-sm-12 col-md-10"},[o("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Comentarios",rules:e.noteRules,error:e.$v.note.fields.note.$error,disable:e.canModify},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"note"}})]},proxy:!0}]),model:{value:e.note.fields.note,callback:function(t){e.$set(e.note.fields,"note",t)},expression:"note.fields.note"}})],1),o("div",{staticClass:"col-xs-12 col-sm-2 pull-right",staticStyle:{"padding-top":"19px"}},[e.canModify?e._e():o("q-btn",{staticClass:"bg-primary",attrs:{color:"positive",icon:"add",label:"Agregar"},on:{click:function(t){return e.createNote()}}})],1)]),o("div",{staticClass:"row q-mb-sm q-mt-md"},[o("div",{staticClass:"col-sm-12 "},[o("div",{staticClass:"q-gutter-sm"},[o("q-table",{attrs:{flat:"",bordered:"",data:e.dataNotes,pagination:e.pagination,columns:e.columnsNotes,filter:e.filter,"row-key":"product_name"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(t){return[o("q-tr",{attrs:{props:t}},[o("q-td",{key:"note",staticStyle:{"text-align":"left"},attrs:{props:t}},[e._v(e._s(t.row.note))]),o("q-td",{key:"note_date",staticStyle:{"text-align":"center"},attrs:{props:t}},[e._v(e._s(t.row.note_date.substr(8,8)+t.row.note_date.substr(4,4)+t.row.note_date.substr(0,4)))]),o("q-td",{key:"actions",staticStyle:{"text-align":"center"},attrs:{props:t}},[o("q-btn",{attrs:{color:"red",flat:"",icon:"fas fa-trash-alt",size:"10px"},nativeOn:{click:function(o){return e.deleteSelectedNote(t.row.id)}}},[o("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Eliminar")])],1)],1)],1)]}}])})],1)])])])])])],1)],1)],1)])]),o("q-dialog",{attrs:{persistent:""},model:{value:e.documentFileModal,callback:function(t){e.documentFileModal=t},expression:"documentFileModal"}},[o("q-card",[o("q-card-section",{staticClass:"row"},[o("div",{staticClass:"col-xs-12 col-sm-10 text-h6"},[e._v("Archivo: "+e._s(e.documentName))]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col-xs-12 col-sm-2 pull-right",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),o("q-card-section",[o("q-uploader",{ref:"fileDocumentRef",attrs:{url:e.fileDocumentUrl,headers:[{name:"Authorization",value:e.token}],method:"POST","hide-upload-btn":""},on:{uploaded:e.afterUploadDocumentFile}})],1),o("q-card-actions",{staticClass:"text-secondary",attrs:{align:"right"}},[o("q-btn",{attrs:{flat:"",label:"Subir archivo"},on:{click:function(t){return e.uploadDocumentFile()}}})],1)],1)],1)],1)},a=[],i=o("ded3"),s=o.n(i),r=(o("ac1f"),o("1276"),o("4de4"),o("d3b7"),o("a9e3"),o("5319"),o("b680"),o("25f0"),o("a15b"),o("b0c0"),o("159b"),o("99af"),o("4d90"),o("466d"),o("aabb")),l=o("b5ae"),d=l.required,c=l.maxLength,m={name:"entry",validations:{movement_transfer:{fields:{originBranchOffice:{required:d},originStorage:{required:d},destinationBranchOffice:{required:d},destinationStorage:{required:d},date:{required:d}}},movement:{fields:{branch:{required:d},storage:{required:d},date:{required:d},po:{required:d}}},movement_details:{fields:{unit:{required:d},qty:{required:d},product:{required:d}}},note:{fields:{note:{required:d,maxLength:c(250)}}}},data:function(){return{suffixQty:0,tab:"details",myLocale:{days:"Domingo_Lunes_Martes_Miércoles_Jueves_Viernes_Sábado".split("_"),daysShort:"Dom_Lun_Mar_Mié_Jue_Vie_Sáb".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1},filter:"",pagination:{sortBy:"code",descending:!1,rowsPerPage:25},columns:[{name:"product_name",align:"center",label:"Producto".toUpperCase(),field:"product_name",style:"width: 20%",sortable:!0},{name:"quantity",align:"center",label:"Cantidad".toUpperCase(),field:"quantity",style:"width: 10%",sortable:!0},{name:"cost",align:"center",label:"Costo".toUpperCase(),field:"cost",style:"width: 10%",sortable:!0},{name:"qty",align:"center",label:"Monto".toUpperCase(),field:"qty",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones".toUpperCase(),field:"actions",style:"width: 10%",sortable:!1}],columnsExit:[{name:"product_name",align:"center",label:"Producto".toUpperCase(),field:"product_name",style:"width: 20%",sortable:!0},{name:"quantity",align:"center",label:"Cantidad".toUpperCase(),field:"quantity",style:"width: 10%",sortable:!0},{name:"cost",align:"center",label:"Costo".toUpperCase(),field:"cost",style:"width: 10%",sortable:!0},{name:"qty",align:"center",label:"Monto".toUpperCase(),field:"qty",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones".toUpperCase(),field:"actions",style:"width: 10%",sortable:!1}],columnsTrans:[{name:"product_name",align:"center",label:"Producto".toUpperCase(),field:"product_name",style:"width: 20%",sortable:!0},{name:"quantity",align:"center",label:"Cantidad".toUpperCase(),field:"quantity",style:"width: 10%",sortable:!0},{name:"balance",align:"center",label:"Saldo".toUpperCase(),field:"balance",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones".toUpperCase(),field:"actions",style:"width: 10%",sortable:!1}],columnsMerma:[{name:"product_name",align:"center",label:"Producto".toUpperCase(),field:"product_name",style:"width: 20%",sortable:!0},{name:"quantity",align:"center",label:"Cantidad".toUpperCase(),field:"quantity",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones".toUpperCase(),field:"actions",style:"width: 10%",sortable:!1}],columnsFisic:[{name:"code",align:"center",label:"Código".toUpperCase(),field:"code",style:"width: 20%",sortable:!0},{name:"product_name",align:"center",label:"Producto".toUpperCase(),field:"product_name",style:"width: 20%",sortable:!0},{name:"quantity",align:"center",label:"Cantidad".toUpperCase(),field:"quantity",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones".toUpperCase(),field:"actions",style:"width: 10%",sortable:!1}],columnsNotes:[{name:"note",align:"center",label:"Nota".toUpperCase(),field:"note",style:"width: 20%",sortable:!0},{name:"note_date",align:"center",label:"Fecha".toUpperCase(),field:"note_date",style:"width: 20%",sortable:!0}],movement_transfer:{fields:{entry_id:null,exit_id:null,date:null,originBranchOffice:null,originStorage:null,destinationBranchOffice:null,destinationStorage:null,statusStr:null,transactionId:null,folio_1:null,folio_2:null,type_movement_1:"TRASPASO (SALIDA)",type_movement_2:"TRASPASO (ENTRADA)"}},movement:{fields:{type_movement:null,status:null,folio:null,branch:null,storage:null,type_id:null,date:null}},movement_details:{fields:{id:null,unit:null,qty:null,cost:null,movement_id:null,product:null}},note:{fields:{note:null,movement_id:this.$route.params.id,date:null,time:null}},execute:!1,balanceValidation:!1,productInvalid:null,show:!0,updateFlag:!1,branchesList:[],storageList:[],productsList:[],unitsList:[],data:[],dataMD:[],dataNotes:[],branchOfficeOptions:[],branchOfficeOptions2:[],storageOptions:[],storageOptions2:[],rawMaterialProductOptions:[],rawMaterialProducts:[],rawMaterials:[],options1:this.categoryOptions,options2:this.ProductsOptionsbyLines,categoryOptions:[],ProductsOptionsbyLines:[],color:"positive",documentFileModal:!1,documentName:null,filteredProductOptions:[]}},created:function(){this.fetchFromServer(),this.getAllProducts(),this.getBranchesList(),this.getStoragesList(),this.getCategories(),this.getNotes(),console.log("que soy "+this.movement.fields.type_id)},mounted:function(){},computed:{token:function(){var e="Bearer "+localStorage.getItem("JWT");return e},amountRules:function(e){var t=this;return[function(e){return t.$v.movement_details.fields.qty.required||"El campo Cantidad es requerido."}]},canModify:function(){return"CANCELADO"===this.movement.fields.status},dateRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.date.required||"El campo Fecha es requerido."}]},dateRulesTransfer:function(e){var t=this;return[function(e){return t.$v.movement_transfer.fields.date.required||"El campo Fecha es requerido."}]},productsRules:function(e){var t=this;return[function(e){return t.$v.movement_details.fields.product.required||"El campo Producto es requerido."}]},unitsRules:function(e){var t=this;return[function(e){return t.$v.movement_details.fields.unit.required||"El campo Unidad es requerido."}]},noteRules:function(e){var t=this;return[function(e){return t.$v.note.fields.note.required||"El campo Notas es requerido."},function(e){return t.$v.note.fields.note.maxLength||"El campo Notas no debe exceder los 250 caracteres."}]},branchOfficeRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.branch.required||"El campo estación es requerido."}]},storageRules:function(e){var t=this;return[function(e){return t.$v.movement.fields.storage.required||"El campo Almacén es requerido."}]},filteredStorageOptions:function(){var e=this;return null!=this.movement.fields.branch&&null!=this.movement.fields.branch.value?this.storageList.filter((function(t){return t.branchOffice===e.movement.fields.branch.value})):[]},filteredOriginStorageOptions:function(){var e=this;return null==this.movement_transfer.fields.originBranchOffice||isNaN(this.movement_transfer.fields.originBranchOffice)?[]:this.storageOptions.filter((function(t){return Number(t.branchOffice)===Number(e.movement_transfer.fields.originBranchOffice)}))},filteredDestinationStorage:function(){var e=this;return null==this.movement_transfer.fields.destinationBranchOffice||isNaN(this.movement_transfer.fields.destinationBranchOffice.value)?[]:this.storageOptions2.filter((function(t){return Number(t.branchOffice)===Number(e.movement_transfer.fields.destinationBranchOffice.value)&&Number(e.movement_transfer.fields.originStorage.value)!==Number(t.value)}))},originBranchOfficeRules:function(e){var t=this;return[function(e){return t.$v.movement_transfer.fields.originBranchOffice.required||"El campo estación origen es requerido."}]},originStorageRules:function(e){var t=this;return[function(e){return t.$v.movement_transfer.fields.originStorage.required||"El campo Almacén origen es requerido."}]},destinationBranchOfficeRules:function(e){var t=this;return[function(e){return t.$v.movement_transfer.fields.destinationBranchOffice.required||"El campo estación destino es requerido."}]},destinationStorageRules:function(e){var t=this;return[function(e){return t.$v.movement_transfer.fields.destinationStorage.required||"El campo Almacén destino es requerido."}]},bomcategoryRules:function(e){var t=this;return[function(e){return t.$v.movement_details.fields.family||"El campo Categorías es requerido."}]},bomproductsRules:function(e){var t=this;return[function(e){return t.$v.movement_details.fields.product.required||"El campo Productos es requerido."}]},rawMaterialAvailableQty:function(){var e=this,t=0;return null===this.movement_details.fields.product||isNaN(this.movement_details.fields.product.value)?null===this.movement_details.fields.product||isNaN(this.movement_details.fields.product)||(t=this.rawMaterialProducts.filter((function(t){return Number(t.product_id)===Number(e.movement_details.fields.product)}))[0].stock):t=this.rawMaterialProducts.filter((function(t){return Number(t.product_id)===Number(e.movement_details.fields.product.value)}))[0].stock,t}},beforeRouteEnter:function(e,t,o){o((function(e){var t=e.$store.getters["users/rol"];console.log(t),1===t||3===t||7===t||2===t||20===t||4===t||27===t||22===t||26===t?o():o("/")}))},methods:{validateQty:function(e){Number(this.suffixQty)<Number(e)&&(this.$q.notify({message:"Stock insuficiente para dar salida: ",position:"top",color:"warning",icon:"close"}),this.movement_details.fields.qty=null)},formatPrice:function(e){var t=(e/1).toFixed(1).replace(",",".");return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+0},generatePDF:function(){var e=this.$route.params.id,t="https://api_alpez.wasp.mx/"+"movements/movementPdf/".concat(e);window.open(t,"_blank")},generatePDFSI:function(){var e=this.$route.params.id,t="https://api_alpez.wasp.mx/"+"movements/movementPdfsi/".concat(e);window.open(t,"_blank")},filterProducts:function(e,t,o){var n=this;t((function(){var t=e.toLowerCase();n.filteredProductOptions=n.rawMaterialProductOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},executeMovement:function(){var e=this,t=this.$route.params.id;this.balanceValidation?this.$q.notify({message:"Stock insuficiente para el producto: "+this.productInvalid,position:"top",color:"warning",icon:"close"}):this.$q.dialog({title:"Confirmación",message:"¿Desea ejecutar el movimiento?",persistent:!0,ok:{label:"Aceptar",color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk((function(){r["a"].put("movements/execute/".concat(t)).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result&&(e.$q.loading.hide(),e.$router.push("/movements/"))}))})).onCancel((function(){}))},updateDetail:function(){var e=this;if(this.$v.movement_details.fields.$reset(),this.$v.movement_details.fields.$touch(),this.$v.movement_details.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones",persisten:!0}),!1;this.$q.loading.show();var t=s()({},this.movement_details.fields);r["a"].put("movement-details/".concat(t.id),t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result&&(e.$q.loading.hide(),e.fetchFromServer(),e.clearInputs(),e.updateFlag=!e.updateFlag)}))},invertDate:function(e){if(null!==e)var t=e.split("/").reverse().join("-");return t},updateMovement:function(){var e=this,t=[];if(4!==this.movement.fields.type_id&&5!==this.movement.fields.type_id)this.$v.movement.fields.$reset(),this.$v.movement.fields.$touch(),this.$q.loading.show(),t.id=Number(this.movement.fields.id),t.date=this.invertDate(this.movement.fields.date),t.storage_id=Number(this.movement.fields.storage.value),r["a"].put("movements/".concat(t.id),t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result&&(e.$q.loading.hide(),e.fetchFromServer(),e.clearInputs())}));else{if(this.$q.loading.show(),this.$v.movement_transfer.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones",persisten:!0}),!1;t.id=Number(this.movement_transfer.fields.exit_id),t.id_entry=Number(this.movement_transfer.fields.entry_id),t.date=this.invertDate(this.movement_transfer.fields.date),t.storage_entry_id=Number(this.movement_transfer.fields.destinationStorage.value),t.storage_exit_id=Number(this.movement_transfer.fields.originStorage.value),r["a"].put("branch-transfers/".concat(t.id),t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result&&(e.$q.loading.hide(),e.fetchFromServer(),e.clearInputs())}))}},clearInputs:function(){this.movement_details.fields.category=null,this.movement_details.fields.product=null,this.movement_details.fields.qty=null,this.movement_details.fields.cost=null,this.movement_details.fields.unit=null,this.suffixQty=0},deleteSelectedRow:function(e){var t=this;this.$q.loading.show(),r["a"].delete("/movement-details/".concat(e)).then((function(e){var o=e.data;t.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result?(t.$q.loading.hide(),t.balanceValidation=!1,t.fetchFromServer()):t.$q.loading.hide()}))},editSelectedRow:function(e){var t=this;this.$q.loading.show(),r["a"].get("/movement-details/".concat(e)).then((function(e){var o=e.data;t.movement_details.fields=o.movement_detail,t.movement_details.fields.product={value:o.movement_detail.product,label:o.movement_detail.product},t.movement_details.fields.unit={value:o.movement_detail.unit_id,label:o.movement_detail.unit},t.updateFlag=!0})),this.$q.loading.hide()},addProduct:function(){var e=this;if(this.$v.movement_details.fields.$reset(),this.$v.movement_details.fields.$touch(),this.$v.movement_details.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones",persisten:!0}),!1;this.$q.loading.show();var t=[];t.product_id=Number(s()({},this.movement_details.fields).product.value),t.qty=Number(s()({},this.movement_details.fields).qty),t.unit_price=Number(s()({},this.movement_details.fields).cost),4===this.movement.fields.type_id?t.movement_id=Number(s()({},this.movement_transfer.fields).entry_id):5===this.movement.fields.type_id?t.movement_id=Number(s()({},this.movement_transfer.fields).exit_id):t.movement_id=Number(s()({},this.movement.fields).movement_id),r["a"].post("movement-details/",t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result?(e.$q.loading.hide(),e.fetchFromServer(),e.clearInputs()):e.$q.loading.hide()}))},searchPO:function(e,t){var o=this;if(e.length<3)return!1;t((function(){r["a"].get("purchase-orders/searchClave/".concat(e)).then((function(e){var t=e.data;o.poList=t.claves}))}))},searchProducts:function(e,t){var o=this;if(e.length<3)return!1;t((function(){r["a"].get("products/searchProducts/".concat(e)).then((function(e){var t=e.data;o.productsList=t.claves}))}))},getQtyProducts:function(e){var t=this,o={};o.product_id=e.value;var n=this.movement.fields.storage.value;r["a"].post("/storages/".concat(n,"/raw-materials-data-to-out"),o).then((function(o){var n=o.data;t.suffixQty=n.stock,r["a"].get("/storages/getUnitProduct/".concat(e.value)).then((function(e){var o=e.data;t.movement_details.fields.unit=o.unit[0].name}))}))},getUnit:function(){var e=this;this.movement_details.fields.qty=null;var t=this.movement_details.fields.product;console.log(t),r["a"].get("products/".concat(t.value)).then((function(t){var o=t.data;e.movement_details.fields.unit={value:o.product.unit_id,label:o.product.unit}}))},fetchFromServer:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;r["a"].get("movements/out/".concat(t)).then((function(o){var n=o.data;"EJECUTADO"===n.movement.status&&(e.execute=!0),n.movement?1===n.movement.type_id?r["a"].get("movements/entry/".concat(t)).then((function(t){var o=t.data;e.movement.fields=o.movement,e.movement.fields.type_movement="ENTRADA",e.movement.fields.movement_id=o.movement.id,e.movement.fields.branch={value:o.movement.branch_id,label:o.movement.branch},e.movement.fields.storage={value:o.movement.storage_id,label:o.movement.storage},e.getAvailableQtyEntry(e.movement.fields.storage.value,o.movement.details)})):2===n.movement.type_id?(e.movement.fields=n.movement,e.movement.fields.type_movement="SALIDA",e.color="negative",e.movement.fields.movement_id=n.movement.id,e.movement.fields.branch={value:n.movement.branch_id,label:n.movement.branch},e.movement.fields.storage={value:n.movement.storage_id,label:n.movement.storage},e.movement.fields.po={value:null,label:null},e.dataMD=n.movement.details,e.getAvailableQtyEntry(e.movement.fields.storage.value,n.movement.details)):3===n.movement.type_id?(e.movement.fields=n.movement,e.movement.fields.type_movement="INVENTARIO FÍSICO",e.movement.fields.movement_id=n.movement.id,e.movement.fields.branch={value:n.movement.branch_id,label:n.movement.branch},e.movement.fields.storage={value:n.movement.storage_id,label:n.movement.storage},e.movement.fields.po={value:null,label:null},e.dataMD=n.movement.details,e.color="light-blue"):5===n.movement.type_id||4===n.movement.type_id?(e.movement.fields.type_id=n.movement.type_id,e.dataMD=n.movement.details,console.log("entre:"),console.log(n.movement.details),r["a"].get("branch-transfers/".concat(t)).then((function(t){var o=t.data;e.movement_transfer.fields.originBranchOffice={label:o.branchTransfer.origin_branch_office_name,value:o.branchTransfer.origin_branch_office_id},e.movement_transfer.fields.originStorage={label:o.branchTransfer.origin_storage_name,value:o.branchTransfer.origin_storage_id},e.movement_transfer.fields.destinationBranchOffice={label:o.branchTransfer.destination_branch_office_name,value:o.branchTransfer.destination_branch_office_id},e.movement_transfer.fields.destinationStorage={label:o.branchTransfer.destination_storage_name,value:o.branchTransfer.destination_storage_id},e.movement_transfer.fields.folio_1=o.branchTransfer.origin_folio,e.movement_transfer.fields.folio_2=o.branchTransfer.destination_folio,e.movement_transfer.fields.statusStr=o.branchTransfer.status,e.movement_transfer.fields.date=o.branchTransfer.date,e.movement_transfer.fields.entry_id=o.branchTransfer.destination_movement_id,e.movement_transfer.fields.exit_id=o.branchTransfer.origin_movement_id,e.movement.fields.storage={label:o.branchTransfer.origin_storage_name,value:o.branchTransfer.origin_storage_id}}))):6===n.movement.type_id&&(e.movement.fields=n.movement,e.movement.fields.type_movement="MERMA",e.color="purple",e.movement.fields.movement_id=n.movement.id,e.movement.fields.branch={value:n.movement.branch_id,label:n.movement.branch},e.movement.fields.storage={value:n.movement.storage_id,label:n.movement.storage},e.movement.fields.po={value:null,label:null},e.dataMD=n.movement.details,e.getAvailableQtyEntry(e.movement.fields.storage.value,n.movement.details)):e.$q.notify({message:n.message.content,position:"top-right",color:n.result?"positive":"warning"}),e.$q.loading.hide()}))},getAvailableQty:function(e,t){var o=this,n=t;r["a"].post("/storages/".concat(e,"/raw-materials-data"),n).then((function(e){var t=e.data;o.rawMaterials=[],o.rawMaterialProducts=[],o.rawMaterialProductOptions=[];var n=0;t.products.forEach((function(e){var t=o.dataMD.filter((function(t){return Number(t.product_id)===Number(e.product_id)}));t.forEach((function(t){e.stock-=t.qty,n+=Number(t.qty)})),n+=Number(e.stock),t.forEach((function(e){e.stock=n,"SALIDA"===o.movement.fields.type_movement&&(e.balance=Number(e.stock)),5!==o.movement.fields.type_id&&4!==o.movement.fields.type_id||(e.balance=Number(e.stock)),n=e.balance,e.balance<0&&!1===o.balanceValidation&&(o.balanceValidation=!o.balanceValidation,o.productInvalid=e.product_name),o.rawMaterials.push(e)})),n=0,o.rawMaterialProducts.push(e),o.rawMaterialProductOptions.push({value:e.product_id,label:"".concat(e.category_code,"-").concat(e.line_code,"-").concat(e.product_name)})})),o.dataMD=o.rawMaterials,o.$q.loading.hide()}))},getBranchesList:function(){var e=this;r["a"].get("branch-offices/options").then((function(t){var o=t.data;e.branchesList=o.options,e.branchOfficeOptions=o.options,e.branchOfficeOptions2=o.options}))},getStoragesList:function(){var e=this;r["a"].get("storages/options").then((function(t){var o=t.data;e.storageList=o.options,e.storageOptions=o.options,e.storageOptions2=o.options}))},getProductsList:function(){var e=this;r["a"].get("products/options").then((function(t){var o=t.data;e.productsList=o.options}))},getCategories:function(){var e=this;r["a"].get("/categories/options").then((function(t){var o=t.data;e.categoryOptions=o.options}))},getNotes:function(){var e=this,t=this.$route.params.id;r["a"].get("/notes/".concat(t)).then((function(t){var o=t.data;e.dataNotes=o.notes}))},getAllProducts:function(){var e=this;r["a"].get("/products/category2").then((function(t){var o=t.data;e.ProductsOptionsbyLines=o.products}))},getLinesByCategories:function(){var e=this;this.ProductsOptionsbyLines=[],this.ProductsOptionsbyLines.unshift({value:null,label:"NINGUNO"}),r["a"].get("/products/category1/".concat(this.movement_details.fields.family)).then((function(t){var o=t.data;o.products.length>0&&o.products.forEach((function(t){e.ProductsOptionsbyLines.push({label:t.label,value:t.id})}))}))},filterCategory:function(e,t,o){var n=this;t((function(){var t=e.toLowerCase();n.options1=n.categoryOptions.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},filterProduct:function(e,t,o){var n=this,a=[];this.ProductsOptionsbyLines.forEach((function(e){a.push({label:e.label,value:e.id})})),console.log(this.ProductsOptionsbyLines),t((function(){var t=e.toLowerCase();n.options2=a.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},deleteSelectedNote:function(e){var t=this;this.$q.dialog({title:"Confirmación",message:"¿Desea eliminar esta Nota?",persistent:!0,ok:{label:"Aceptar",color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk((function(){r["a"].delete("/notes/".concat(e)).then((function(e){var o=e.data;t.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning",icon:o.result?"thumb_up":"close"}),o.result?(t.$q.loading.hide(),t.getNotes()):t.$q.loading.hide()}))})).onCancel((function(){}))},createNote:function(){var e=this;if(this.$v.note.fields.$reset(),this.$v.note.fields.$touch(),this.$v.note.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;this.$q.loading.show();var t=s()({},this.note.fields),o=new Date;t.time=o.getHours()+":"+o.getMinutes()+":"+o.getSeconds(),t.date="".concat((new Date).getFullYear(),"/").concat(((new Date).getMonth()+1).toString().padStart(2,"0"),"/").concat((new Date).getDate().toString().padStart(2,"0")),this.$q.loading.hide(),r["a"].post("/notes",t).then((function(t){var o=t.data;e.$q.notify({message:o.message.content,position:"top",color:o.result?"positive":"warning"}),o.result?(e.$q.loading.hide(),e.note.fields.note=null,e.getNotes()):e.$q.loading.hide()}))},decimales:function(e){var t=e+"",o=/(\d*.\d{0,4})/;return t.match(o)[0]},getAvailableQtyEntry:function(e,t){var o=this,n=t;r["a"].post("/storages/".concat(e,"/raw-materials-data"),n).then((function(e){var n=e.data;o.dataMD=t;for(var a=0;a<n.products.length;a++)for(var i=0;i<o.dataMD.length;i++){if(n.products[a].product_id===o.dataMD[i].product_id&&"NUEVO"===o.movement.fields.status){var s=n.products[a].stock,r=n.products[a].stock+Number(o.dataMD[i].qty);o.dataMD[i].stock=s,o.dataMD[i].balance=r}if(n.products[a].product_id===o.dataMD[i].product_id&&"EJECUTADO"===o.movement.fields.status){var l=o.dataMD[i].stock-o.dataMD[i].qty,d=l+Number(o.dataMD[i].qty);o.dataMD[i].stock=l,o.dataMD[i].balance=d}}}))},getLayoutCsv:function(){var e="https://api_alpez.wasp.mx/movement-details/csv";window.open(e,"_blank")},openUploadFileModal:function(){this.documentFileModal=!0},uploadDocumentFile:function(){this.$refs.fileDocumentRef.upload()},fileDocumentUrl:function(){var e=this.$route.params.id;return"".concat("https://api_alpez.wasp.mx/","movement-details/file/").concat(e)},afterUploadDocumentFile:function(e){console.log(e);var t=JSON.parse(e.xhr.response);this.$q.notify({message:t.message.content,position:"top",color:t.result?"positive":"warning"}),t.result?(this.fetchFromServer(),this.documentFileModal=!1):this.documentFileModal=!1}}},u=m,f=o("2877"),v=o("9989"),p=o("ead5"),_=o("079e"),b=o("9c40"),g=o("05c0"),h=o("ddd8"),y=o("0016"),q=o("7cbe"),x=o("52ee"),C=o("27f9"),w=o("f09f"),k=o("429b"),$=o("7460"),S=o("adad"),O=o("823b"),M=o("66e5"),N=o("4074"),D=o("eaac"),E=o("bd08"),P=o("db86"),A=o("24e8"),T=o("a370"),L=o("ee89"),F=o("4b7e"),U=o("7f67"),R=o("eebe"),Q=o.n(R),B=Object(f["a"])(u,n,a,!1,null,null,null);t["default"]=B.exports;Q()(B,"components",{QPage:v["a"],QBreadcrumbs:p["a"],QBreadcrumbsEl:_["a"],QBtn:b["a"],QTooltip:g["a"],QSelect:h["a"],QIcon:y["a"],QPopupProxy:q["a"],QDate:x["a"],QInput:C["a"],QCard:w["a"],QTabs:k["a"],QTab:$["a"],QTabPanels:S["a"],QTabPanel:O["a"],QItem:M["a"],QItemSection:N["a"],QTable:D["a"],QTr:E["a"],QTd:P["a"],QDialog:A["a"],QCardSection:T["a"],QUploader:L["a"],QCardActions:F["a"]}),Q()(B,"directives",{ClosePopup:U["a"]})}}]);