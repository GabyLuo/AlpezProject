(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{f0de:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"bg-grey-3"},[i("div",{staticClass:"q-pa-sm panel-header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-8 row"},[i("div",{staticClass:"q-pa-md q-gutter-sm"},[i("q-breadcrumbs",{staticStyle:{"font-size":"20px"},attrs:{align:"right"}},[i("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),i("q-breadcrumbs-el",{attrs:{label:"1"===this.$route.params.type?"Ordenes de compra":"Recepciones",to:"1"===this.$route.params.type?"/purchase-orders/"+e.shipment.fields.order_id:"/raw-material-shipments"}}),i("q-breadcrumbs-el",{attrs:{label:"Recepción "+e.shipment.fields.serial}})],1)],1)]),"NUEVO"==e.shipment.fields.status?i("div",{staticClass:"col-xs-12 col-sm-4 pull-right q-pa-sm q-gutter-sm"},[i("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.canExecute,expression:"canExecute"}],attrs:{color:"positive",icon:"arrow_right_alt",label:"Entrada"},on:{click:function(t){return e.saveStorageEntry()}}})],1):e._e(),"RECIBIDO"==e.shipment.fields.status?i("div",{staticClass:"col-xs-12 col-sm-4 pull-right q-pa-sm q-gutter-sm"},[i("q-btn",{attrs:{color:"primary",icon:"mail",label:"Enviar a proveedor",loading:e.loadingSendingMailBtn},on:{click:function(t){return e.sendShipmentPdfToSupplier()}},scopedSlots:e._u([{key:"loading",fn:function(){return[i("q-spinner",{staticClass:"on-left"}),e._v("\n                Enviando correo...\n              ")]},proxy:!0}],null,!1,576762722)})],1):e._e()])]),i("div",{staticClass:"q-pa-md bg-grey-3"},[i("div",{staticClass:"row bg-white border-panel"},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-col-gutter-xs"},[i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-select",{ref:"shipmentFieldsReceiveDateSelectRef",attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha de recepción",rules:e.shipmentReceiveDateRules,disable:"NUEVO"!=e.shipment.fields.status},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.shipment.fields.receive_date,callback:function(t){e.$set(e.shipment.fields,"receive_date",t)},expression:"shipment.fields.receive_date"}},[i("q-popup-proxy",{ref:"shipmentFieldsReceiveDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("div",{staticClass:"col-sm-12"},[i("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY","today-btn":""},on:{input:function(){return e.$refs.shipmentFieldsReceiveDateRef.hide()}},model:{value:e.shipment.fields.receive_date,callback:function(t){e.$set(e.shipment.fields,"receive_date",t)},expression:"shipment.fields.receive_date"}})],1)])],1)],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-select",{ref:"shipmentFieldsReceiveTimeSelectRef",attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"time",label:"Hora de recepción",rules:e.shipmentReceiveTimeRules,disable:"NUEVO"!=e.shipment.fields.status},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"access_time"}})]},proxy:!0}]),model:{value:e.shipment.fields.receive_time,callback:function(t){e.$set(e.shipment.fields,"receive_time",t)},expression:"shipment.fields.receive_time"}},[i("q-popup-proxy",{ref:"shipmentFieldsReceiveTimeRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("div",{staticClass:"col-sm-12"},[i("q-time",{attrs:{"now-btn":""},on:{input:function(){return e.$refs.shipmentFieldsReceiveTimeRef.hide()}},model:{value:e.shipment.fields.receive_time,callback:function(t){e.$set(e.shipment.fields,"receive_time",t)},expression:"shipment.fields.receive_time"}})],1)])],1)],1),i("div",{staticClass:"col-xs-12 col-sm-3"},[i("q-input",{attrs:{color:"dark","bg-color":"blue",filled:"",disable:"",error:e.$v.shipment.fields.status.$error,label:"Estatus",rules:e.shipmentStatusRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"dvr"}})]},proxy:!0}]),model:{value:e.shipment.fields.status,callback:function(t){e.$set(e.shipment.fields,"status",t)},expression:"shipment.fields.status"}})],1)]),i("div",{staticClass:"col-xs-12 col-sm-2 offset-sm-10 pull-right"},[i("q-btn",{staticStyle:{"margin-right":"2%"},attrs:{color:"positive",icon:"save",label:"Actualizar"},on:{click:function(t){return e.updateShipment()}}})],1)])]),i("br"),i("div",{staticClass:"bg-white border-panel"},[i("div",{staticStyle:{"font-weight":"normal"}},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-col-gutter-xs",staticStyle:{padding:"2%"}},[i("div",{staticClass:"col-xs-12 col-sm-6"},[i("q-select",{attrs:{readonly:"NUEVO"!==e.shipment.fields.status,color:"dark","bg-color":"secondary",filled:"",options:e.productShipmentDetailOptions,label:"Producto",rules:e.detailProductRules},on:{input:function(t){return e.onSelectProduct()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"settings"}})]},proxy:!0}]),model:{value:e.detail.fields.product,callback:function(t){e.$set(e.detail.fields,"product",t)},expression:"detail.fields.product"}})],1),i("div",{staticClass:"col-xs-12 col-sm-2 text-center"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",readonly:null===e.detail.fields.qty,error:e.$v.detail.fields.qty.$error,label:"Cantidad",rules:e.detailQtyRules},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"scatter_plot"}})]},proxy:!0}]),model:{value:e.detail.fields.qty,callback:function(t){e.$set(e.detail.fields,"qty",t)},expression:"detail.fields.qty"}})],1),i("div",{staticClass:"col-xs-12 col-sm-4 text-center"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Observaciones"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"fas fa-eye"}})]},proxy:!0}]),model:{value:e.detail.fields.observation,callback:function(t){e.$set(e.detail.fields,"observation",t)},expression:"detail.fields.observation"}})],1),i("div",{staticClass:"col-xs-12 col-sm-12 pull-right"},["NUEVO"==e.shipment.fields.status?i("q-btn",{staticStyle:{"margin-right":"5px"},attrs:{color:"blue",icon:"add",label:"Agregar todo"},on:{click:function(t){return e.addDetailAll()}}}):e._e(),"NUEVO"==e.shipment.fields.status?i("q-btn",{staticStyle:{"margin-right":"5px"},attrs:{color:"positive",icon:"add",label:"Agregar"},on:{click:function(t){return e.addDetail()}}}):e._e()],1)]),i("div",{staticClass:"q-col-gutter-xs",staticStyle:{padding:"2%"}},[i("q-table",{attrs:{flat:"",bordered:"",data:e.details,columns:e.detailsColumns,"row-key":"name",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-td",{key:"code",staticStyle:{"text-align":"center",width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.code)+" ")]),i("q-td",{key:"product",staticStyle:{"text-align":"left",width:"25%"},attrs:{props:t}},[e._v(e._s(t.row.product))]),i("q-td",{key:"qty",staticStyle:{"text-align":"center",width:"10%"},attrs:{props:t}},[e._v(e._s(e.$formatNumberThree(t.row.product_shipment_number)))]),i("q-td",{key:"receive_date",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.receive_date))]),i("q-td",{key:"receive_time",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.receive_time))]),i("q-td",{key:"observation",staticStyle:{"text-align":"left",width:"50%"},attrs:{props:t}},[e._v(e._s(t.row.observation))]),i("q-td",{key:"actions",staticStyle:{width:"10%"},attrs:{props:t}},["NUEVO"==e.shipment.fields.status?i("q-btn",{attrs:{color:"negative",icon:"fas fa-trash-alt",flat:"",size:"10px"},nativeOn:{click:function(i){return e.removeDetail(t.row.id)}}},[i("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Eliminar")])],1):e._e()],1)],1)]}}])})],1)])])])]),i("q-dialog",{model:{value:e.shipmentDetailsModal,callback:function(t){e.shipmentDetailsModal=t},expression:"shipmentDetailsModal"}},[i("q-card",[i("q-card-section",[i("q-toolbar",[i("q-toolbar-title",[e._v("Saco "+e._s(e.detailToEdit.fields.id))]),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),i("q-card-section",[i("div",{staticClass:"row bg-white border-panel"},[i("div",{staticClass:"col q-pa-md"},[i("div",{staticClass:"row q-col-gutter-xs"},[i("div",{staticClass:"col-sm-6"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Producto",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"emoji_objects"}})]},proxy:!0}]),model:{value:e.detailToEdit.fields.product,callback:function(t){e.$set(e.detailToEdit.fields,"product",t)},expression:"detailToEdit.fields.product"}})],1),i("div",{staticClass:"col-sm-6"},[i("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.detailToEdit.fields.qty.$error,label:"Peso",suffix:"Kg.",rules:e.detailToEditQtyRules,disable:"ANALIZADO"!==e.shipment.fields.status},on:{input:function(t){e.detailToEdit.fields.qty=t.replace(/[^0-9\\.]/g,"")}},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"fas fa-weight-hanging"}})]},proxy:!0}]),model:{value:e.detailToEdit.fields.qty,callback:function(t){e.$set(e.detailToEdit.fields,"qty",t)},expression:"detailToEdit.fields.qty"}})],1)])])])]),"ANALIZADO"===e.shipment.fields.status?i("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar"}}),i("q-btn",{attrs:{flat:"",label:"Registrar peso"},on:{click:function(t){return e.updateDetail()}}})],1):e._e()],1)],1)],1)},a=[],l=i("ded3"),n=i.n(l),o=(i("ac1f"),i("1276"),i("a9e3"),i("caad"),i("2532"),i("4de4"),i("d3b7"),i("5319"),i("b680"),i("25f0"),i("a15b"),i("99af"),i("aabb")),r=i("b5ae"),d=r.required,c=r.decimal,u=r.maxLength,p=r.minValue,m={name:"EditShipment",validations:{shipment:{fields:{status:{required:d,maxLength:u(10)},receive_date:{required:d},receive_time:{required:d}}},detail:{fields:{product:{required:d},qty:{required:d}}},detailToEdit:{fields:{product:{required:d},qty:{required:d,decimal:c,minValue:p(1)}}},sampling:{fields:{status:{required:d,maxLength:u(10)},product:{required:d},humidity:{decimal:c},dirty:{decimal:c},metals:{decimal:c},recicled:{decimal:c},pvc:{decimal:c},sifting:{decimal:c}}}},data:function(){return{prueba:null,myLocale:{days:"Domingo_Lunes_Martes_Miércoles_Jueves_Viernes_Sábado".split("_"),daysShort:"Dom_Lun_Mar_Mié_Jue_Vie_Sáb".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1},formatter:new Intl.NumberFormat("en-US"),currentTab:null,shipment:{fields:{id:null,status:null,receive_date:null,receive_time:null,order_id:null,serial:null}},detail:{fields:{product:null,qty:null}},detailToEdit:{fields:{id:null,product:null,qty:null}},sampling:{fields:{status:"NUEVO",product:{value:null,label:"Seleccione el producto"},humidity:null,dirty:null,metals:null,recicled:null,pvc:null,recommendations:null,sifting:null}},pagination:{descending:!1,rowsPerPage:25},detailsColumns:[{name:"code",align:"center",label:"CÓDIGO",field:"code",style:"width: 10%",sortable:!0},{name:"product",align:"left",label:"PRODUCTO",field:"product",style:"width: 25%",sortable:!0},{name:"qty",align:"center",label:"CANTIDAD",field:"qty",style:"width: 10%",sortable:!0},{name:"receive_date",align:"left",label:"FECHA",field:"receive_date",style:"width: 10%",sortable:!0},{name:"receive_time",align:"left",label:"HORA",field:"receive_time",style:"width: 10%",sortable:!0},{name:"observation",align:"center",label:"OBSERVACIONES",field:"observation",style:"width: 25%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 10%",sortable:!1}],samplingsColumns:[{name:"product",align:"center",label:"PRODUCTO",field:"product",style:"width: 20%",sortable:!0},{name:"humidity",align:"center",label:"Humedad (%)",field:"humidity",style:"width: 10%",sortable:!0},{name:"metals",align:"center",label:"Metales (PPM)",field:"metals",style:"width: 10%",sortable:!0},{name:"recicled",align:"center",label:"Degradado (PPM)",field:"recicled",style:"width: 10%",sortable:!0},{name:"pvc",align:"center",label:"PVC (PPM)",field:"pvc",style:"width: 10%",sortable:!0},{name:"dirty",align:"center",label:"Otros (PPM)",field:"dirty",style:"width: 10%",sortable:!0},{name:"sifting",align:"center",label:"Tamizado (%)",field:"sifting",style:"width: 10%",sortable:!0},{name:"status",align:"center",label:"Estatus",field:"status",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"Acciones",field:"actions",style:"width: 10%",sortable:!1}],details:[],samplings:[],productShipmentDetailOptions:[],unitOptions:[{value:1,label:"KILOGRAMO"}],productSamplingOptions:[],detailIdToEdit:null,samplingIdToEdit:null,shipmentDetailsModal:!1,loadingSendingMailBtn:!1,totalQty:0}},computed:{canExecute:function(){return this.details.length>0&&"NUEVO"===this.shipment.fields.status},shipmentReceiveDateRules:function(e){var t=this;return[function(e){return t.$v.shipment.fields.receive_date.required||"El campo Fecha de recepción es requerido."}]},shipmentReceiveTimeRules:function(e){var t=this;return[function(e){return t.$v.shipment.fields.receive_time.required||"El campo Hora de recepción es requerido."}]},shipmentStatusRules:function(e){var t=this;return[function(e){return t.$v.shipment.fields.status.required||"El campo Estatus es requerido."},function(e){return t.$v.shipment.fields.status.maxLength||"El campo Estatus no debe exceder los 10 dígitos."}]},detailProductRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.product.required||"El campo Producto es requerido."}]},detailQtyRules:function(e){var t=this;return[function(e){return t.$v.detail.fields.qty.required||"El campo Cantidad es requerido."}]},detailToEditQtyRules:function(e){var t=this;return[function(e){return t.$v.detailToEdit.fields.qty.required||"El campo Peso es requerido."},function(e){return t.$v.detailToEdit.fields.qty.decimal||"El campo Peso debe ser numérico."},function(e){return t.$v.detailToEdit.fields.qty.minValue||"El campo Peso debe ser positivo."}]},samplingProductRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.product.required||"El campo Producto es requerido."}]},samplingHumidityRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.humidity.decimal||"El campo Humedad debe ser numérico."}]},samplingMetalsRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.metals.decimal||"El campo Metales debe ser numérico."}]},samplingRecicledRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.recicled.decimal||"El campo Degradado debe ser numérico."}]},samplingPvcRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.pvc.decimal||"El campo PVC debe ser numérico."}]},samplingDirtyRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.dirty.decimal||"El campo Otros debe ser numérico."}]},samplingSiftingRules:function(e){var t=this;return[function(e){return t.$v.sampling.fields.sifting.decimal||"El campo Tamizado debe ser numérico."}]},currentWeight:function(){for(var e=0,t=0;t<this.details.length;t++)Number(this.details[t].id)===Number(this.detailToEdit.fields.id)?e+=Number(this.detailToEdit.fields.qty):e+=Number(this.details[t].qty);return e}},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(7)||this.$store.getters["users/roles"].includes(2)||22!==!this.$store.getters["users/rol"]||this.$router.push("/")},mounted:function(){this.fetchFromServer()},methods:{getDetails:function(){var e=this,t=this.$route.params.id;o["a"].get("/shipment-details/shipment/".concat(t)).then((function(t){var i=t.data;console.log("Entre"),console.log(i),e.details=i.shipmentDetails,console.log("No pude entrar"),e.currentTab="jumbos",e.$q.loading.hide()}))},getProducts:function(){var e=this;o["a"].get("/products/options/purchase-order/".concat(this.$route.params.id)).then((function(t){var i=t.data;if(console.log("Mis products"),console.log(i),e.productShipmentDetailOptions=i.options,e.$route.params.detailId){var s=e.details.filter((function(t){return Number(t.id)===Number(e.$route.params.detailId)}));s.length>0&&e.editDetail(s[0])}}))},formatPrice:function(e){var t=(e/1).toFixed(1).replace(".",",");return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},fetchFromServer:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;console.log(this.$route.params),o["a"].get("/shipments/".concat(t)).then((function(t){var i=t.data;i.shipment?("ANALIZADO"===i.shipment.status||e.$store.getters["users/roles"].includes(1)||e.$store.getters["users/roles"].includes(3)||e.$store.getters["users/roles"].includes(7)||e.$store.getters["users/roles"].includes(2)||22!==!e.$store.getters["users/rol"]||e.$router.push("/"),e.shipment.fields=i.shipment,o["a"].get("/products/options/purchase-order/".concat(e.shipment.fields.order_id)).then((function(t){var i=t.data;if(e.productSamplingOptions=e.productShipmentDetailOptions=i.options,e.$route.params.detailId){var s=e.details.filter((function(t){return Number(t.id)===Number(e.$route.params.detailId)}));s.length>0&&e.editDetail(s[0])}o["a"].get("/shipment-details/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.details=i.shipmentDetails,e.currentTab="jumbos",e.$q.loading.hide()}))}))):e.$router.push("/purchase-orders")}))},updateShipment:function(){var e=this;if(this.$v.shipment.fields.$reset(),this.$v.shipment.fields.$touch(),this.$v.shipment.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.shipment.fields.receive_date)return this.$q.dialog({title:"Error",message:"Por favor, seleccione la fecha de recepción.",persistent:!0}),!1;this.$q.loading.show();var t=n()({},this.shipment.fields);t.receive_date=this.invertDate(this.shipment.fields.receive_date),o["a"].put("/shipments/".concat(t.id),t).then((function(t){var i=t.data;if(e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result){var s=e.$route.params.id;o["a"].get("/shipments/".concat(s)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.$q.loading.hide()}))}else e.$q.loading.hide()}))},invertDate:function(e){if(null!==e)var t=e.split("/").reverse().join("-");return t},sendShipmentPdfToSupplier:function(){var e=this;this.loadingSendingMailBtn=!0,o["a"].get("/shipments/".concat(this.$route.params.id,"/send-mail")).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),e.loadingSendingMailBtn=!1}))},updateDetail:function(){var e=this;if(this.$v.detailToEdit.fields.$reset(),this.$v.detailToEdit.fields.$touch(),this.$v.detailToEdit.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.detailToEdit.fields.qty||isNaN(this.detailToEdit.fields.qty)||this.detailToEdit.fields.qty<1)return this.$q.dialog({title:"Error",message:"Por favor, ingrese un peso válido.",persistent:!0}),!1;this.$q.loading.show();var t=[];t.qty=Number(this.detailToEdit.fields.qty),o["a"].put("/shipment-details/".concat(this.detailToEdit.fields.id),t).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?o["a"].get("/shipment-details/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.details=i.shipmentDetails,o["a"].get("/products/options/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.productSamplingOptions=i.options,e.shipmentDetailsModal=!1,e.$q.loading.hide()}))})):e.$q.loading.hide()}))},addDetailAll:function(){var e=this;console.log(this.productSamplingOptions),this.$q.loading.show();var t=[];t.shipment_id=Number(this.shipment.fields.id),t.shipment=this.shipment.fields.order_id,console.log(t),o["a"].post("/shipment-details/addAll",t).then((function(t){var i=t.data;console.log(i),e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.detail.fields.product={value:null,label:"Seleccione el producto"},e.detail.fields.qty=null,e.detail.fields.observation=null,o["a"].get("/products/options/purchase-order/".concat(e.shipment.fields.order_id)).then((function(t){var i=t.data;if(e.productSamplingOptions=e.productShipmentDetailOptions=i.options,e.$route.params.detailId){var s=e.details.filter((function(t){return Number(t.id)===Number(e.$route.params.detailId)}));s.length>0&&e.editDetail(s[0])}o["a"].get("/shipment-details/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.details=i.shipmentDetails,o["a"].get("/products/options/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.productSamplingOptions=i.options,e.$q.loading.hide()}))}))}))):e.$q.loading.hide()}))},addDetail:function(){var e=this;if(this.$v.detail.fields.$reset(),this.$v.detail.fields.$touch(),this.$v.detail.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.detail.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione el producto.",persistent:!0}),!1;if(console.log(this.detail.fields.qty+" <= 0 || "+this.detail.fields.qty+" > "+this.totalQty),Number(this.detail.fields.qty)<=0||Number(this.detail.fields.qty)>Number(this.totalQty))return this.$q.dialog({title:"Error",message:"Por favor, ingrese una cantidad válida.",persistent:!0}),this.detail.fields.qty=this.totalQty,!1;if(null==this.detail.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione la unidad.",persistent:!0}),!1;this.$q.loading.show();var t=[];t.product_id=Number(n()({},this.detail.fields).product.value),t.shipment_id=Number(this.shipment.fields.id),t.qty=Number(n()({},this.detail.fields).qty),t.observation=n()({},this.detail.fields).observation,console.log(t),o["a"].post("/shipment-details",t).then((function(t){var i=t.data;console.log(i),e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.detail.fields.product={value:null,label:"Seleccione el producto"},e.detail.fields.qty=null,e.detail.fields.observation=null,o["a"].get("/products/options/purchase-order/".concat(e.shipment.fields.order_id)).then((function(t){var i=t.data;if(e.productSamplingOptions=e.productShipmentDetailOptions=i.options,e.$route.params.detailId){var s=e.details.filter((function(t){return Number(t.id)===Number(e.$route.params.detailId)}));s.length>0&&e.editDetail(s[0])}o["a"].get("/shipment-details/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.details=i.shipmentDetails,o["a"].get("/products/options/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.productSamplingOptions=i.options,e.$q.loading.hide()}))}))}))):e.$q.loading.hide()}))},editDetail:function(e){this.detailToEdit.fields.id=e.id,this.detailToEdit.fields.product=e.product,this.detailToEdit.fields.qty=e.qty,this.shipmentDetailsModal=!0},removeDetail:function(e){var t=this;this.$q.loading.show(),o["a"].delete("/shipment-details/".concat(e)).then((function(e){var i=e.data;t.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(t.detail.fields.product={value:null,label:"Seleccione el producto"},t.detail.fields.qty=null,t.detail.fields.observation=null,o["a"].get("/products/options/purchase-order/".concat(t.shipment.fields.order_id)).then((function(e){var i=e.data;if(t.productSamplingOptions=t.productShipmentDetailOptions=i.options,t.$route.params.detailId){var s=t.details.filter((function(e){return Number(e.id)===Number(t.$route.params.detailId)}));s.length>0&&t.editDetail(s[0])}o["a"].get("/shipment-details/shipment/".concat(t.shipment.fields.id)).then((function(e){var i=e.data;t.details=i.shipmentDetails,t.currentTab="jumbos",t.$q.loading.hide()}))}))):t.$q.loading.hide()}))},analyzed:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;o["a"].put("/shipments/analyzed/".concat(t)).then((function(t){var i=t.data;if(e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result){var s=e.$route.params.id;o["a"].get("/shipments/".concat(s)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.$q.loading.hide()}))}else e.$q.loading.hide()}))},reject:function(){var e=this;this.$q.loading.show();var t=this.$route.params.id;o["a"].put("/shipments/reject/".concat(t)).then((function(t){var i=t.data;if(e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result){var s=e.$route.params.id;o["a"].get("/shipments/".concat(s)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.$q.loading.hide()}))}else e.$q.loading.hide()}))},updateSampling:function(){var e=this;if(this.$v.sampling.fields.$reset(),this.$v.sampling.fields.$touch(),this.$v.sampling.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.sampling.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione el producto.",persistent:!0}),!1;this.$q.loading.show();var t="";if(Number(this.sampling.fields.humidity)>1&&(t+="Exceso de Humedad (Límite 1%)"),Number(this.sampling.fields.metals)>20&&(t+=t.length>0?", Exceso de Metales (Límite 20 PPM)":"Exceso de Metales (Límite 20 PPM)"),Number(this.sampling.fields.recicled)>5e3&&(t+=t.length>0?", Exceso de Degradado (Límite 5000 PPM)":"Exceso de Degradado (Límite 5000 PPM)"),Number(this.sampling.fields.pvc)>100&&(t+=t.length>0?", Exceso de PVC (Límite 100 PPM)":"Exceso de PVC (Límite 100 PPM)"),Number(this.sampling.fields.dirty)>200&&(t+=t.length>0?", Exceso de Otros (Límite 200 PPM)":"Exceso de Otros (Límite 200 PPM)"),Number(this.sampling.fields.sifting)>2&&(t+=t.length>0?", Exceso de Tamizado (Límite 2%)":"Exceso de Tamizado (Límite 2%)"),this.$q.loading.hide(),t.length>0)t+=".",this.$q.dialog({title:"Advertencia",message:t,cancel:!0,persistent:!0}).onOk((function(t){e.$q.loading.show();var i=n()({},e.sampling.fields);i.product_id=Number(i.product.value),i.shipment_id=Number(e.shipment.fields.id),o["a"].put("/samplings/".concat(e.samplingIdToEdit),i).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.cancelEditSampling(),o["a"].get("/samplings/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.samplings=i.samplings,e.$q.loading.hide()}))):e.$q.loading.hide()}))})).onCancel((function(){return!1}));else{this.$q.loading.show();var i=n()({},this.sampling.fields);i.product_id=Number(i.product.value),i.shipment_id=Number(this.shipment.fields.id),o["a"].put("/samplings/".concat(this.samplingIdToEdit),i).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?(e.cancelEditSampling(),o["a"].get("/samplings/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.samplings=i.samplings,e.$q.loading.hide()}))):e.$q.loading.hide()}))}},cancelEditSampling:function(){this.samplingIdToEdit=null,this.sampling.fields.status="NUEVO",this.sampling.fields.product={value:null,label:"Seleccione el producto"},this.sampling.fields.humidity=null,this.sampling.fields.dirty=null,this.sampling.fields.metals=null,this.sampling.fields.recicled=null,this.sampling.fields.pvc=null,this.sampling.fields.recommendations=null,this.sampling.fields.sifting=null},addSampling:function(){var e=this;if(this.$v.sampling.fields.$reset(),this.$v.sampling.fields.$touch(),this.$v.sampling.fields.$error)return this.$q.dialog({title:"Error",message:"Por favor, verifique las validaciones.",persistent:!0}),!1;if(null==this.sampling.fields.product.value)return this.$q.dialog({title:"Error",message:"Por favor, seleccione el producto.",persistent:!0}),!1;this.$q.loading.show();var t="";if(Number(this.sampling.fields.humidity)>1&&(t+="Exceso de Humedad (Límite 1%)"),Number(this.sampling.fields.metals)>20&&(t+=t.length>0?", Exceso de Metales (Límite 20 PPM)":"Exceso de Metales (Límite 20 PPM)"),Number(this.sampling.fields.recicled)>5e3&&(t+=t.length>0?", Exceso de Degradado (Límite 5000 PPM)":"Exceso de Degradado (Límite 5000 PPM)"),Number(this.sampling.fields.pvc)>100&&(t+=t.length>0?", Exceso de PVC (Límite 100 PPM)":"Exceso de PVC (Límite 100 PPM)"),Number(this.sampling.fields.dirty)>200&&(t+=t.length>0?", Exceso de Otros (Límite 200 PPM)":"Exceso de Otros (Límite 200 PPM)"),Number(this.sampling.fields.sifting)>2&&(t+=t.length>0?", Exceso de Tamizado (Límite 2%)":"Exceso de Tamizado (Límite 2%)"),this.$q.loading.hide(),t.length>0)t+=".",this.$q.dialog({title:"Advertencia",message:t,cancel:!0,persistent:!0}).onOk((function(t){e.$q.loading.show();var i=n()({},e.sampling.fields);i.product_id=Number(i.product.value),i.shipment_id=Number(e.shipment.fields.id),o["a"].post("/samplings",i).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?o["a"].get("/shipments/".concat(e.$route.params.id)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.sampling.fields.status="NUEVO",e.sampling.fields.product={value:null,label:"Seleccione el producto"},e.sampling.fields.humidity=null,e.sampling.fields.dirty=null,e.sampling.fields.metals=null,e.sampling.fields.recicled=null,e.sampling.fields.pvc=null,e.sampling.fields.recommendations=null,e.sampling.fields.sifting=null,o["a"].get("/samplings/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.samplings=i.samplings,e.$q.loading.hide()}))})):e.$q.loading.hide()}))})).onCancel((function(){return!1}));else{this.$q.loading.show();var i=n()({},this.sampling.fields);i.product_id=Number(i.product.value),i.shipment_id=Number(this.shipment.fields.id),o["a"].post("/samplings",i).then((function(t){var i=t.data;e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?o["a"].get("/shipments/".concat(e.$route.params.id)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.sampling.fields.status="NUEVO",e.sampling.fields.product={value:null,label:"Seleccione el producto"},e.sampling.fields.humidity=null,e.sampling.fields.dirty=null,e.sampling.fields.metals=null,e.sampling.fields.recicled=null,e.sampling.fields.pvc=null,e.sampling.fields.recommendations=null,e.sampling.fields.sifting=null,o["a"].get("/samplings/shipment/".concat(e.shipment.fields.id)).then((function(t){var i=t.data;e.samplings=i.samplings,e.$q.loading.hide()}))})):e.$q.loading.hide()}))}},validateHumity:function(){parseFloat(this.sampling.fields.humidity)<0&&(this.sampling.fields.humidity=null)},validateMetals:function(){parseFloat(this.sampling.fields.metals)<0&&(this.sampling.fields.metals=null)},validateRecicled:function(){parseFloat(this.sampling.fields.recicled)<0&&(this.sampling.fields.recicled=null)},validatePvc:function(){parseFloat(this.sampling.fields.pvc)<0&&(this.sampling.fields.pvc=null)},validateDirty:function(){parseFloat(this.sampling.fields.dirty)<0&&(this.sampling.fields.dirty=null)},validateSifting:function(){parseFloat(this.sampling.fields.sifting)<0&&(this.sampling.fields.sifting=null)},editSampling:function(e){this.samplingIdToEdit=e.id,this.sampling.fields.status=e.status,this.sampling.fields.product={value:e.product_id,label:e.product},this.sampling.fields.humidity=e.humidity,this.sampling.fields.dirty=e.dirty,this.sampling.fields.metals=e.metals,this.sampling.fields.recicled=e.recicled,this.sampling.fields.pvc=e.pvc,this.sampling.fields.recommendations=e.recommendations,this.sampling.fields.sifting=e.sifting},removeSampling:function(e){var t=this;this.$q.loading.show(),o["a"].delete("/samplings/".concat(e.id)).then((function(e){var i=e.data;t.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result?o["a"].get("/samplings/shipment/".concat(t.shipment.fields.id)).then((function(e){var i=e.data;t.samplings=i.samplings,t.$q.loading.hide()})):t.$q.loading.hide()}))},onSelectProduct:function(){var e=this;o["a"].get("/shipment-details/qtyProducts/".concat(this.shipment.fields.order_id,"/").concat(this.detail.fields.product.value)).then((function(t){var i=t.data;e.detail.fields.qty=(e.detail.fields.product.qty-(!1!==i.qty?i.qty.total:0)).toFixed(2),e.totalQty=e.detail.fields.qty}))},generateQRCode:function(){var e=Number(this.shipment.fields.id),t="https://api_alpez.wasp.mx/"+"shipments/pdf-qr/".concat(e);window.open(t,"_blank")},generateDetailQRCode:function(e){var t=Number(e.id),i="https://api_alpez.wasp.mx/"+"shipment-details/pdf-qr/".concat(t);window.open(i,"_blank")},saveStorageEntry:function(){var e=this;this.$q.loading.show(),o["a"].put("/shipments/".concat(this.$route.params.id,"/entry"),[]).then((function(t){var i=t.data;if(e.$q.notify({message:i.message.content,position:"top",color:i.result?"positive":"warning"}),i.result){var s=e.$route.params.id;o["a"].get("/shipments/".concat(s)).then((function(t){var i=t.data;e.shipment.fields=i.shipment,e.shipment.fields.receive_date=e.shipment.fields.receive_date.split("-").join("/"),e.$q.loading.hide()}))}else e.$q.loading.hide()}))},generateSamplingPdf:function(e){var t="https://api_alpez.wasp.mx/"+"samplings/pdf/".concat(e.id);window.open(t,"_blank")}}},h=m,f=i("2877"),g=i("9989"),v=i("ead5"),b=i("079e"),q=i("9c40"),y=i("0d59"),$=i("ddd8"),_=i("0016"),E=i("7cbe"),w=i("52ee"),S=i("ca78"),P=i("27f9"),x=i("eaac"),N=i("bd08"),D=i("db86"),T=i("05c0"),C=i("24e8"),O=i("f09f"),k=i("a370"),M=i("65c6"),R=i("6ac5"),L=i("4b7e"),Q=i("7f67"),A=i("eebe"),I=i.n(A),V=Object(f["a"])(h,s,a,!1,null,null,null);t["default"]=V.exports;I()(V,"components",{QPage:g["a"],QBreadcrumbs:v["a"],QBreadcrumbsEl:b["a"],QBtn:q["a"],QSpinner:y["a"],QSelect:$["a"],QIcon:_["a"],QPopupProxy:E["a"],QDate:w["a"],QTime:S["a"],QInput:P["a"],QTable:x["a"],QTr:N["a"],QTd:D["a"],QTooltip:T["a"],QDialog:C["a"],QCard:O["a"],QCardSection:k["a"],QToolbar:M["a"],QToolbarTitle:R["a"],QCardActions:L["a"]}),I()(V,"directives",{ClosePopup:Q["a"]})}}]);