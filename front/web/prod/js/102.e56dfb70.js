(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[102],{fdb7:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"bg-grey-3"},[r("div",{staticClass:"q-pa-sm panel-header"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-6",staticStyle:{"font-size":"20px"}},[r("div",{staticClass:"q-pa-md q-gutter-sm"},[r("q-breadcrumbs",{attrs:{align:"left"}},[r("q-breadcrumbs-el",{attrs:{label:"",icon:"home",to:"/"}}),r("q-breadcrumbs-el",{attrs:{label:"Ordenes de producción "}})],1)],1)]),r("div",{staticClass:"col-xs-6 col-md-6 pull-right"},[r("div",{staticClass:"q-pa-sm q-gutter-sm"},[r("q-btn",{staticClass:"bg-primary",staticStyle:{color:"white"},attrs:{icon:"add",label:"Nuevo"},nativeOn:{click:function(t){return e.$router.push("/production-orders/new")}}})],1)])])]),r("div",{staticClass:"q-pa-md bg-grey-3"},[r("div",{staticClass:"row bg-white border-panel"},[r("div",{staticClass:"col q-pa-md"},[r("div",{staticClass:"row q-mb-sm"}),r("q-table",{attrs:{flat:"",bordered:"",data:e.data,columns:e.columns,"row-key":"order_number",pagination:e.pagination,filter:e.filter},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[r("div",{staticStyle:{width:"100%"}},[r("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},on:{input:function(t){e.filter=t.toUpperCase()}},scopedSlots:e._u([{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[r("q-tr",{attrs:{props:t}},[r("q-td",{key:"order_number",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.order_number))]),r("q-td",{key:"created",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.created))]),r("q-td",{key:"production_date",staticStyle:{width:"10%"},attrs:{props:t}},[e._v(e._s(t.row.production_date))]),r("q-td",{key:"shipmentProgress",staticStyle:{width:"10%"},attrs:{props:t}},[r("q-linear-progress",{attrs:{stripe:"",size:"33px",value:Number(t.row.lot_completed/t.row.lot_all),color:"positive"}},[r("q-chip",{attrs:{dense:"",square:"",color:"primary","text-color":"white"}},[e._v("\n                    "+e._s(e.shipmentsProgressLabel(Number(t.row.lot_completed/t.row.lot_all)))+"\n                  ")])],1)],1),r("q-td",{key:"status",staticStyle:{width:"10%"},attrs:{props:t}},[r("q-btn",{attrs:{square:"",dense:"",color:"NUEVO"===t.row.status?"primary":"INICIADO"===t.row.status?"blue":"FINALIZADO"===t.row.status?"green":"CANCELADO"===t.row.status?"negative":"ASIGNADO"===t.row.status?"orange":e.negative,"text-color":"white",size:"10px"}},[e._v("\n                      "+e._s(t.row.status)+"\n                    ")])],1),r("q-td",{key:"actions",staticClass:"pull-left",staticStyle:{width:"8%"},attrs:{props:t}},[r("q-btn",{attrs:{color:"primary",icon:"fas fa-edit",flat:"",size:"10px"},nativeOn:{click:function(r){return e.editSelectedRow(t.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Editar")])],1),"FINALIZADO"==t.row.status?r("q-btn",{attrs:{color:"primary",icon:"fas fa-file-pdf",flat:"",size:"10px"},nativeOn:{click:function(r){return e.packingList(t.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Packing List")])],1):e._e(),"FINALIZADO"==t.row.status?r("q-btn",{attrs:{color:"positive",icon:"fas fa-file-pdf",flat:"",size:"10px"},nativeOn:{click:function(r){return e.handiWork(t.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Mano de Obra")])],1):e._e(),"FINALIZADO"==t.row.status?r("q-btn",{attrs:{color:"purple",icon:"fas fa-file-pdf",flat:"",size:"10px"},nativeOn:{click:function(r){return e.cost(t.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v("Costo Produción")])],1):e._e(),"NUEVO"==t.row.status?r("q-btn",{attrs:{color:"negative",icon:"fas fa-ban",flat:"",size:"10px"},nativeOn:{click:function(r){return e.cancelSelectedRow(t.row.id)}}},[r("q-tooltip",{attrs:{"content-class":"bg-red"}},[e._v("Cancelar")])],1):e._e()],1)],1)]}}])})],1)])]),r("q-dialog",{attrs:{persistent:""}},[r("q-card",[r("q-card-section",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-sm-10 text-h6"},[e._v("Orden de producción")]),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col-xs-12 col-sm-2 pull-right",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),r("q-card-section",[r("q-uploader",{attrs:{accept:".pdf",method:"POST","hide-upload-btn":""}})],1),r("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[r("q-btn",{attrs:{flat:"",label:"Subir documento"}})],1)],1)],1),r("q-dialog",{attrs:{persistent:""},model:{value:e.modalOrders,callback:function(t){e.modalOrders=t},expression:"modalOrders"}},[r("q-card",{staticStyle:{"min-width":"80%"}},[r("q-card-section",[r("div",{staticClass:"text-h6"},[e._v("Ordenes de producción")])]),r("q-card-section",[r("div",{staticClass:"row q-col-gutter-xs"},[r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha programada",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.ordera.fields.fecha_a,callback:function(t){e.$set(e.ordera.fields,"fecha_a",t)},expression:"ordera.fields.fecha_a"}},[r("q-popup-proxy",{ref:"orderFieldsCreationDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{"today-btn":""},on:{input:function(){return e.$refs.orderFieldsCreationDateRef.hide()}},model:{value:e.ordera.fields.fecha_a,callback:function(t){e.$set(e.ordera.fields,"fecha_a",t)},expression:"ordera.fields.fecha_a"}})],1)])],1)],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{filled:"",dark:"",color:"white","bg-color":"secondary",error:e.$v.ordera.fields.a.$error,label:"Producto",options:e.options2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},on:{input:function(t){return e.getUnit(e.ordera.fields.a,"a")},filter:e.filterProduct},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-grip-lines-vertical"}})]},proxy:!0},{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n                  No hay Resultados\n                ")])],1)]},proxy:!0}]),model:{value:e.ordera.fields.a,callback:function(t){e.$set(e.ordera.fields,"a",t)},expression:"ordera.fields.a"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Unidad",disable:""},model:{value:e.ordera.fields.unit,callback:function(t){e.$set(e.ordera.fields,"unit",t)},expression:"ordera.fields.unit"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.ordera.fields.ca.$error,label:"Cantidad"},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-hashtag"}})]},proxy:!0}]),model:{value:e.ordera.fields.ca,callback:function(t){e.$set(e.ordera.fields,"ca",t)},expression:"ordera.fields.ca"}})],1)]),r("div",{staticClass:"row q-col-gutter-xs"},[r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha programada",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.orderb.fields.fecha_b,callback:function(t){e.$set(e.orderb.fields,"fecha_b",t)},expression:"orderb.fields.fecha_b"}},[r("q-popup-proxy",{ref:"orderFieldsCreationDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{"today-btn":""},on:{input:function(){return e.$refs.orderFieldsCreationDateRef.hide()}},model:{value:e.orderb.fields.fecha_b,callback:function(t){e.$set(e.orderb.fields,"fecha_b",t)},expression:"orderb.fields.fecha_b"}})],1)])],1)],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{filled:"",dark:"",color:"white","bg-color":"secondary",error:e.$v.orderb.fields.b.$error,label:"Producto",options:e.options2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},on:{input:function(t){return e.getUnit(e.orderb.fields.b,"b")},filter:e.filterProduct},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-grip-lines-vertical"}})]},proxy:!0},{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n                  No hay Resultados\n                ")])],1)]},proxy:!0}]),model:{value:e.orderb.fields.b,callback:function(t){e.$set(e.orderb.fields,"b",t)},expression:"orderb.fields.b"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Unidad",disable:""},model:{value:e.orderb.fields.unit,callback:function(t){e.$set(e.orderb.fields,"unit",t)},expression:"orderb.fields.unit"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.orderb.fields.cb.$error,label:"Cantidad"},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-hashtag"}})]},proxy:!0}]),model:{value:e.orderb.fields.cb,callback:function(t){e.$set(e.orderb.fields,"cb",t)},expression:"orderb.fields.cb"}})],1)]),r("div",{staticClass:"row q-col-gutter-xs"},[r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",mask:"date",label:"Fecha programada",disable:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.orderc.fields.fecha_c,callback:function(t){e.$set(e.orderc.fields,"fecha_c",t)},expression:"orderc.fields.fecha_c"}},[r("q-popup-proxy",{ref:"orderFieldsCreationDateRef",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("div",{staticClass:"col-sm-12"},[r("q-date",{attrs:{"today-btn":""},on:{input:function(){return e.$refs.orderFieldsCreationDateRef.hide()}},model:{value:e.orderc.fields.fecha_c,callback:function(t){e.$set(e.orderc.fields,"fecha_c",t)},expression:"orderc.fields.fecha_c"}})],1)])],1)],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{filled:"",dark:"",color:"white","bg-color":"secondary",error:e.$v.orderc.fields.c.$error,label:"Producto",options:e.options2,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",hint:"Basic autocomplete","emit-value":"","map-options":""},on:{input:function(t){return e.getUnit(e.orderc.fields.c,"c")},filter:e.filterProduct},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-grip-lines-vertical"}})]},proxy:!0},{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n                  No hay Resultados\n                ")])],1)]},proxy:!0}]),model:{value:e.orderc.fields.c,callback:function(t){e.$set(e.orderc.fields,"c",t)},expression:"orderc.fields.c"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-select",{attrs:{color:"dark","bg-color":"secondary",filled:"",label:"Unidad",disable:""},model:{value:e.orderc.fields.unit,callback:function(t){e.$set(e.orderc.fields,"unit",t)},expression:"orderc.fields.unit"}})],1),r("div",{staticClass:"col-xs-12 col-sm-3"},[r("q-input",{attrs:{color:"dark","bg-color":"secondary",filled:"",error:e.$v.orderc.fields.cc.$error,label:"Cantidad"},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"fas fa-hashtag"}})]},proxy:!0}]),model:{value:e.orderc.fields.cc,callback:function(t){e.$set(e.orderc.fields,"cc",t)},expression:"orderc.fields.cc"}})],1)])]),r("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"red"},nativeOn:{click:function(t){return e.closeModal()}}}),r("q-btn",{attrs:{label:"Guardar",color:"green"},nativeOn:{click:function(t){return e.save()}}})],1)],1)],1)],1)},o=[],a=(r("caad"),r("2532"),r("ac1f"),r("5319"),r("b680"),r("d3b7"),r("25f0"),r("a9e3"),r("4de4"),r("aabb")),i=r("bd4c"),l={name:"IndexProductionOrders",validations:{ordera:{fields:{a:{},ca:{},fecha_a:{},unit:{}}},orderb:{fields:{b:{},cb:{},fecha_b:{},unit:{}}},orderc:{fields:{c:{},cc:{},fecha_c:{},unit:{}}}},data:function(){return{modalOrders:!1,options2:this.ProductsOptionsbyLines,formatter:new Intl.NumberFormat("en-US"),pagination:{sortBy:"order_number",descending:!0,rowsPerPage:25},filter:"",columns:[{name:"order_number",align:"center",label:"NÚMERO DE ORDEN",field:"order_number",style:"width: 10%",sortable:!0},{name:"created",align:"center",label:"FECHA DE CAPTURA",field:"created",style:"width: 10%",sortable:!0},{name:"production_date",align:"center",label:"FECHA PROGRAMADA",field:"production_date",style:"width: 10%",sortable:!0},{name:"shipmentProgress",align:"center",label:"AVANCE",field:"shipmentProgress",style:"width: 10%",sortable:!0},{name:"status",align:"center",label:"ESTATUS",field:"status",style:"width: 10%",sortable:!0},{name:"actions",align:"center",label:"ACCIONES",field:"actions",style:"width: 8%",sortable:!1}],data:[],ordera:{fields:{a:null,ca:null,fecha_a:null,unit:null}},orderb:{fields:{b:null,cb:null,fecha_b:null,unit:null}},orderc:{fields:{c:null,cc:null,fecha_c:null,unit:null}},ProductsOptionsbyLines:[]}},computed:{},beforeCreate:function(){this.$store.getters["users/roles"].includes(1)||this.$store.getters["users/roles"].includes(3)||this.$store.getters["users/roles"].includes(5)||this.$store.getters["users/roles"].includes(6)||this.$store.getters["users/roles"].includes(7)||this.$router.push("/")},mounted:function(){this.fetchFromServer(),this.getLinesByCategories();var e=Date.now();this.ordera.fields.fecha_a=i["b"].formatDate(e,"DD/MM/YYYY"),this.orderb.fields.fecha_b=i["b"].formatDate(e,"DD/MM/YYYY"),this.orderc.fields.fecha_c=i["b"].formatDate(e,"DD/MM/YYYY")},methods:{formatPrice:function(e){var t=(e/1).toFixed(1).replace(".",",");return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},fetchFromServer:function(){var e=this;this.$q.loading.show(),a["a"].get("/production-orders").then((function(t){var r=t.data;e.data=r.orders,e.$q.loading.hide()}))},editSelectedRow:function(e){this.$router.push("/production-orders/".concat(e))},cancelSelectedRow:function(e){var t=this;this.$q.loading.show(),a["a"].put("/production-orders/".concat(e,"/cancel")).then((function(e){var r=e.data;t.$q.notify({message:r.message.content,position:"top",color:r.result?"positive":"warning"}),r.result?(t.$q.loading.hide(),t.fetchFromServer()):t.$q.loading.hide()}))},shipmentsProgress:function(e){return console.log(e.lot_completed/e.lot_all),Number(e.lot_completed/e.lot_al)},shipmentsProgressLabel:function(e){return(100*e).toFixed(2)+"%"},getLinesByCategories:function(){var e=this;this.ProductsOptionsbyLines=[],a["a"].get("/products/getProductsBy").then((function(t){var r=t.data;e.ProductsOptionsbyLines=r.products,e.ProductsOptionsbyLines.unshift({value:null,label:"NINGUNO"})}))},filterProduct:function(e,t,r){var s=this;t((function(){var t=e.toLowerCase();s.options2=s.ProductsOptionsbyLines.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},save:function(){var e=this;this.$q.loading.show(),this.$v.ordera.fields.$reset(),this.$v.ordera.fields.$touch(),this.$v.orderb.fields.$reset(),this.$v.orderb.fields.$touch(),this.$v.orderc.fields.$reset(),this.$v.orderc.fields.$touch();var t=[],r=[];null!=this.ordera.fields.a&&this.ordera.fields.ca&&r.push({product:this.ordera.fields.a,cantidad:Number(this.ordera.fields.ca),fecha:this.ordera.fields.fecha_a,unit:this.ordera.fields.unit}),null!=this.orderb.fields.b&&this.orderb.fields.cb&&r.push({product:this.orderb.fields.b,cantidad:Number(this.orderb.fields.cb),fecha:this.orderb.fields.fecha_b,unit:this.orderb.fields.unit}),null!=this.orderc.fields.c&&this.orderc.fields.cc&&r.push({product:this.orderc.fields.c,cantidad:Number(this.orderc.fields.cc),fecha:this.orderc.fields.fecha_c,unit:this.orderc.fields.unit}),t.products=r,this.modalOrders=!1,a["a"].post("/production-orders/createorders",t).then((function(t){var r=t.data;r.result&&(e.$q.notify({message:"Ordenes de produccion creadas",position:"top",color:"positive"}),e.closeModal()),e.fetchFromServer(),e.$q.loading.hide()})),this.modalOrders=!1},getUnit:function(e,t){var r=this,s=e.id;a["a"].get("products/".concat(s)).then((function(e){var s=e.data;"a"===t&&(r.ordera.fields.unit={value:s.product.unit_id,label:s.product.unit}),"b"===t&&(r.orderb.fields.unit={value:s.product.unit_id,label:s.product.unit}),"c"===t&&(r.orderc.fields.unit={value:s.product.unit_id,label:s.product.unit})}))},closeModal:function(){this.ordera.fields.a=null,this.orderb.fields.b=null,this.orderc.fields.c=null,this.ordera.fields.ca=null,this.orderb.fields.cb=null,this.orderc.fields.cc=null,this.ordera.fields.unit=null,this.orderb.fields.unit=null,this.orderc.fields.unit=null},packingList:function(e){var t="https://api_alpez.wasp.mx/"+"production-orders/packing-list/pdf/".concat(e);window.open(t,"_blank")},handiWork:function(e){var t="https://api_alpez.wasp.mx/"+"production-orders/handi-work/pdf/".concat(e);window.open(t,"_blank")},cost:function(e){var t="https://api_alpez.wasp.mx/"+"production-orders/cost/pdf/".concat(e);window.open(t,"_blank")}}},n=l,c=r("2877"),d=r("9989"),u=r("ead5"),f=r("079e"),p=r("9c40"),b=r("eaac"),h=r("27f9"),m=r("0016"),v=r("bd08"),g=r("db86"),y=r("6b1d"),q=r("b047"),_=r("05c0"),w=r("24e8"),x=r("f09f"),k=r("a370"),C=r("ee89"),$=r("4b7e"),O=r("ddd8"),S=r("7cbe"),P=r("52ee"),D=r("66e5"),N=r("4074"),A=r("7f67"),F=r("eebe"),Q=r.n(F),L=Object(c["a"])(n,s,o,!1,null,null,null);t["default"]=L.exports;Q()(L,"components",{QPage:d["a"],QBreadcrumbs:u["a"],QBreadcrumbsEl:f["a"],QBtn:p["a"],QTable:b["a"],QInput:h["a"],QIcon:m["a"],QTr:v["a"],QTd:g["a"],QLinearProgress:y["a"],QChip:q["a"],QTooltip:_["a"],QDialog:w["a"],QCard:x["a"],QCardSection:k["a"],QUploader:C["a"],QCardActions:$["a"],QSelect:O["a"],QPopupProxy:S["a"],QDate:P["a"],QItem:D["a"],QItemSection:N["a"]}),Q()(L,"directives",{ClosePopup:A["a"]})}}]);